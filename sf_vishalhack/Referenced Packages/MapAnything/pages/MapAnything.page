<apex:page sidebar="{!sidebarEnabled}" controller="sma.MapAnything" title="MapAnything" action="{!StartUpAction}" extensions="sma.MARemoteFunctions">
    <!-- dif checking 7 -->

    <!-- dif checking 4 -->
    <script>
        var MARemoting = {
            phase_4 : '{!$RemoteAction.MARemoteFunctions.GetRecords}',
            getShapes : '{!$RemoteAction.MARemoteFunctions.GetShapeInfo}',
            placeSearch : '{!$RemoteAction.MARemoteFunctions.googleAPISearch}',
            geocodeRecord : '{!$RemoteAction.MARemoteFunctions.geoCodeRecord}',
            live_phase_4 : '{!$RemoteAction.MARemoteFunctions.GetDevicesCurrentLocation}',
            live_history: '{!$RemoteAction.MARemoteFunctions.GetLiveDeviceHistory}',
            getEsriToken : '{!$RemoteAction.MARemoteFunctions.getEsriToken}',
            getEsriRoute : '{!$RemoteAction.MARemoteFunctions.getEsriRoute}',
            getDriveProfile : '{!$RemoteAction.MARemoteFunctions.getCustomDriveProfile}',
            get_service_area: '{!$RemoteAction.MARemoteFunctions.getServiceArea}',
            processAJAXRequest : '{!$RemoteAction.MARemoteFunctions.processAJAXRequest}',
            processAJAXRequestReadOnly : '{!$RemoteAction.MARemoteFunctions.processAJAXRequestReadOnly}',
            MapAnythingIORequest : '{!$RemoteAction.MARemoteFunctions.MapAnythingIORequest}',
            searchMAObjectsForRecords : '{!$RemoteAction.MARemoteFunctions.searchMAObjectsForRecords}',
            validateMABaseObjectTooltips : '{!$RemoteAction.MARemoteFunctions.validateMABaseObjectTooltips}',
            MapAnythingIORequestPOST : '{!$RemoteAction.MARemoteFunctions.MapAnythingIORequestPOST}',
            getRoute: '{!$RemoteAction.MARemoteFunctions.getRoute}'
        }
    </script>
    <!-- jQuery-->
    <!--<script type='text/javascript' src="{!URLFOR($Resource.MAPhone, '/s1Mobile/js/vendor/jquery-2.2.1.min.js')}"></script>-->
    <script type='text/javascript' src="{!URLFOR($Resource.MapAnything, 'js/jquery-1.8.3.min.js')}"></script>


    <!--[if lt IE 9]>
        <script type='text/javascript'>window.location = '/apex/Oops?type=UnsupportedBrowser';</script>
    <![endif]-->
    <!--[if IE 9]>
        <script type='text/javascript' src="{!URLFOR($Resource.MapAnything, 'jquery/jquery.xdomainrequest.min.js')}"></script>
    <![endif]-->

    <!-- async -->
    <script type='text/javascript' src="{!URLFOR($Resource.MapAnything, 'async/async.min.js')}"></script>

    <!--<script type='text/javascript' src="{!$Resource.ArcGISOnlineJS}"></script>-->
    <script type='text/javascript' src="{!URLFOR($Resource.MapAnythingJS, 'ArcGISOnlineJS.js')}"></script>

    <!-- jsTree -->
    <script type='text/javascript' src="{!URLFOR($Resource.MapAnything, 'jstree/_lib/jquery.cookie.js')}"></script>
    <script type='text/javascript' src="{!URLFOR($Resource.MapAnything, 'jstree/jquery.jstree2.js')}"></script>
    <script type='text/javascript' src="{!URLFOR($Resource.MapAnythingJS, 'ArcGISOnlineJS.js')}"></script>
    <!-- toastr -->
    <script type="text/javascript" src="{!URLFOR($Resource.MapAnything, 'toastr/toastr.min.js')}"></script>
    <link rel="stylesheet" type="text/css" href="{!URLFOR($Resource.MapAnything, 'toastr/toastr.min.css')}"></link>

    <!-- <apex:stylesheet value="{!URLFOR($Resource.MapAnything, 'malayersv2/css/malayersv2.css')}" /> -->
    <apex:stylesheet value="{!staticResourceLocators['MapAnything'].path}/malayersv2/css/malayersv2.css" />


    <!-- minicolors -->
    <script type="text/javascript" src="{!URLFOR($Resource.MapAnything, 'jquery/minicolors/jquery.minicolors.min.js')}"></script>
    <link rel="stylesheet" type="text/css" href="{!URLFOR($Resource.MapAnything, 'jquery/minicolors/jquery.minicolors.css')}"></link>

    <!-- jsColor -->
    <script type='text/javascript' src="{!URLFOR($Resource.MapAnything, 'jscolor/jscolor.js')}"></script>

    <!-- Lightning Design System 2.3.0 -->
    <link type="text/css" rel="stylesheet" href="{!URLFOR($Resource.MapAnythingJS, 'styles/css/salesforce-lightning-design-system-vf-2.3.0.min.css')}" />

    <!-- MapAnything Legacy UI -->
    <apex:stylesheet value="{!URLFOR($Resource.sma__MapAnything, 'css/MapAnything.css')}"/>
    <!-- MapAnything 2.0 UI - uses SASS in static resource -->
    <link type="text/css" rel="stylesheet" href="{!URLFOR($Resource.MapAnythingJS, 'styles/css/ma-ui.css')}" />
    <link rel="stylesheet" type="text/css" href="{!URLFOR($Resource.MapAnythingJS, 'styles/styles.css')}" />

    <apex:outputPanel layout="none" rendered="{!TotangoEnabled == 'true'}">

        <script type='text/javascript'>
             var totango_options = {
                  service_id: "SP-8618-01",
                  username: '{!$User.Email}',
                  account:
                  {
                      id: '{!$Organization.Id}',
                      name: "{!JSENCODE($Organization.Name)}",
                      status: "Unknown"
                  }
            };

            (function() {
                var e = document.createElement('script'); e.type = 'text/javascript'; e.async = true;
                e.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 's3.amazonaws.com/totango-cdn/totango2.js';
                var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(e, s);
            })();
        </script>

    </apex:outputPanel>


    <!-- jQuery Notify -->
    <script type='text/javascript' src="{!URLFOR($Resource.MapAnything, 'notify/jquery.notify.js')}"></script>
    <apex:stylesheet value="{!URLFOR($Resource.sma__MapAnything, 'notify/ui.notify.css')}"/>

    <!-- jQuery UI -->
    <script type='text/javascript' src="{!URLFOR($Resource.MapAnything, 'jquery/jquery-ui.min.js')}"></script>
    <apex:stylesheet value="{!URLFOR($Resource.sma__MapAnything, 'jquery/jquery-ui.css')}"/>

    <!-- Select2 replacing combobox -->
    <script type='text/javascript' src="{!URLFOR($Resource.MapAnything, 'js/select2/select2.full.min.js')}"></script>
    <apex:stylesheet value="{!URLFOR($Resource.sma__MapAnything, 'js/select2/select2.min.css')}"></apex:stylesheet>

    <!-- jQuery event.drag -->
    <script type='text/javascript' src="{!URLFOR($Resource.MapAnything, 'js/jquery.event.drag-2.2.js')}"></script>

    <!-- CryptoJS (https://code.google.com/p/crypto-js/) -->
    <script type='text/javascript' src="{!URLFOR($Resource.MapAnything, 'js/google/cryptojs/core-min.js')}"></script>
    <script type='text/javascript' src="{!URLFOR($Resource.MapAnything, 'js/google/cryptojs/enc-utf16-min.js')}"></script>
    <script type='text/javascript' src="{!URLFOR($Resource.MapAnything, 'js/google/cryptojs/enc-base64-min.js')}"></script>

    <!-- Google Maps -->
    <script>
        //fix google maps touch events, forced
        navigator = navigator || {};
        if(('ontouchstart' in window) || (navigator.msMaxTouchPoints > 0)) {
            navigator.msPointerEnabled = true;
            navigator.msMaxTouchPoints = navigator.msMaxTouchPoints || 2;
        }

    </script>
    <script type='text/javascript' src='{!GoogleURL}/maps/api/js?v=3&client=gme-cloudbiltinc&libraries=places,visualization,drawing,geometry'></script>


    <!-- Google Maps - InfoBubble (http://google-maps-utility-library-v3.googlecode.com/svn/trunk/infobubble/examples/example.html) -->
    <script type='text/javascript' src="{!URLFOR($Resource.MapAnything, 'js/google/infobubble/infobubble.js')}"></script>
    <script type='text/javascript'>

        //InfoBubble does not support padding when panning to view.  Adding the padding that MA needs
        InfoBubble.prototype.panToView = function() {

            //make sure projection and bubble are available
            var projection = this.getProjection();
            if (!projection || !this.bubble_) { return; }

            //this is the magic var

            var MAPaddingTop = 65;

            var anchorHeight = this.getAnchorHeight_();
            var height = this.bubble_.offsetHeight + anchorHeight + MAPaddingTop;
            var map = this.get('map');

            var mapDiv = map.getDiv();
            var mapHeight = mapDiv.offsetHeight;

            var latLng = this.getPosition();
            var centerPos = projection.fromLatLngToContainerPixel(map.getCenter());
            var pos = projection.fromLatLngToContainerPixel(latLng);

            // Find out how much space at the top is free
            var spaceTop = centerPos.y - height;

            // Fine out how much space at the bottom is free
            var spaceBottom = mapHeight - centerPos.y;

            var needsTop = spaceTop < 0;
            var deltaY = 0;

            if (needsTop) {
                spaceTop *= -1;
                deltaY = (spaceTop + spaceBottom) / 2;
            }

            pos.y -= deltaY;
            latLng = projection.fromContainerPixelToLatLng(pos);

            if (map.getCenter() != latLng) { map.panTo(latLng);
            }
        };
        InfoBubble.prototype['panToView'] = InfoBubble.prototype.panToView;
    </script>

    <!-- Google Maps - RichMarker (https://googlemaps.github.io/js-rich-marker/examples/richmarker.html) -->
    <script type='text/javascript' src="{!URLFOR($Resource.MapAnything, 'js/google/richmarker/richmarker.js')}"></script>
    <script type='text/javascript'>

        //richmarker doesn't support a rightclick event.  adding it
        RichMarker.prototype.onAdd = function() {
            if (!this.markerWrapper_) {
                this.markerWrapper_ = document.createElement('DIV');
                this.markerWrapper_.style['position'] = 'absolute';
            }

            if (this.getZIndex()) {
                this.markerWrapper_.style['zIndex'] = this.getZIndex();
            }

            this.markerWrapper_.style['display'] = this.getVisible() ? '' : 'none';

            if (!this.markerContent_) {
                this.markerContent_ = document.createElement('DIV');
                this.markerWrapper_.appendChild(this.markerContent_);

                var that = this;
                google.maps.event.addDomListener(this.markerContent_, 'click', function(e) {
                    google.maps.event.trigger(that, 'click');
                    e.stopPropagation();
                    e.preventDefault();
                });
                google.maps.event.addDomListener(this.markerContent_, 'mouseover', function(e) {
                    google.maps.event.trigger(that, 'mouseover');
                });
                google.maps.event.addDomListener(this.markerContent_, 'mouseout', function(e) {
                    google.maps.event.trigger(that, 'mouseout');
                });

                //adding rightclick event - DK 11/26/14
                google.maps.event.addDomListener(this.markerContent_, 'contextmenu', function (e) {
                    google.maps.event.trigger(that, 'rightclick');
                    e.stopPropagation();
                    e.preventDefault();
                });
            }

            this.ready_ = true;
            this.content_changed();
            this.flat_changed();
            this.draggable_changed();

            var panes = this.getPanes();
            if (panes) {
                panes.overlayMouseTarget.appendChild(this.markerWrapper_);
            }

            google.maps.event.trigger(this, 'ready');
        };
        RichMarker.prototype['onAdd'] = RichMarker.prototype.onAdd;

    </script>

    <!-- Google Maps - Marker Cluster Plus (http://google-maps-utility-library-v3.googlecode.com/svn/trunk/markerclustererplus/examples/advanced_example.html) custom modification on grabbing images from static resource in js file check before updating -->
    <script>var clusterPrefix = '{!sitePrefix}';</script>
    <!--<script type='text/javascript' src="{!URLFOR($Resource.MapAnything, 'js/google/markerclustererplus/markerclusterer.js')}"></script>-->
    <script type='text/javascript'>
        function ClusterIcon(cluster,styles){cluster.getMarkerClusterer().extend(ClusterIcon,google.maps.OverlayView),this.cluster_=cluster,this.className_=cluster.getMarkerClusterer().getClusterClass(),this.styles_=styles,this.center_=null,this.div_=null,this.sums_=null,this.visible_=!1,this.setMap(cluster.getMap())}function Cluster(mc){this.markerClusterer_=mc,this.map_=mc.getMap(),this.gridSize_=mc.getGridSize(),this.minClusterSize_=mc.getMinimumClusterSize(),this.averageCenter_=mc.getAverageCenter(),this.hideLabel_=mc.getHideLabel(),this.markers_=[],this.center_=null,this.bounds_=null,this.clusterIcon_=new ClusterIcon(this,mc.getStyles())}function MarkerClusterer(map,opt_markers,opt_options){this.extend(MarkerClusterer,google.maps.OverlayView),opt_markers=opt_markers||[],opt_options=opt_options||{},this.markers_=[],this.clusters_=[],this.listeners_=[],this.activeMap_=null,this.ready_=!1,this.gridSize_=opt_options.gridSize||60,this.minClusterSize_=opt_options.minimumClusterSize||2,this.maxZoom_=opt_options.maxZoom||null,this.styles_=opt_options.styles||[],this.title_=opt_options.title||"",this.zoomOnClick_=!0,void 0!==opt_options.zoomOnClick&&(this.zoomOnClick_=opt_options.zoomOnClick),this.averageCenter_=!1,void 0!==opt_options.averageCenter&&(this.averageCenter_=opt_options.averageCenter),this.ignoreHidden_=!1,void 0!==opt_options.ignoreHidden&&(this.ignoreHidden_=opt_options.ignoreHidden),this.enableRetinaIcons_=!1,void 0!==opt_options.enableRetinaIcons&&(this.enableRetinaIcons_=opt_options.enableRetinaIcons),this.hideLabel_=!1,void 0!==opt_options.hideLabel&&(this.hideLabel_=opt_options.hideLabel),this.imagePath_=opt_options.imagePath||MarkerClusterer.IMAGE_PATH,this.imageExtension_=opt_options.imageExtension||MarkerClusterer.IMAGE_EXTENSION,this.imageSizes_=opt_options.imageSizes||MarkerClusterer.IMAGE_SIZES,this.calculator_=opt_options.calculator||MarkerClusterer.CALCULATOR,this.batchSize_=opt_options.batchSize||MarkerClusterer.BATCH_SIZE,this.batchSizeIE_=opt_options.batchSizeIE||MarkerClusterer.BATCH_SIZE_IE,this.clusterClass_=opt_options.clusterClass||"cluster",-1!==navigator.userAgent.toLowerCase().indexOf("msie")&&(this.batchSize_=this.batchSizeIE_),this.setupStyles_(),this.addMarkers(opt_markers,!0),this.setMap(map)}ClusterIcon.prototype.onAdd=function(){var cMouseDownInCluster,cDraggingMapByCluster,cClusterIcon=this;this.div_=document.createElement("div"),this.div_.className=this.className_,this.visible_&&this.show(),this.getPanes().overlayMouseTarget.appendChild(this.div_),this.boundsChangedListener_=google.maps.event.addListener(this.getMap(),"bounds_changed",function(){cDraggingMapByCluster=cMouseDownInCluster}),google.maps.event.addDomListener(this.div_,"mousedown",function(){cMouseDownInCluster=!0,cDraggingMapByCluster=!1}),google.maps.event.addDomListener(this.div_,"click",function(e){if(cMouseDownInCluster=!1,!cDraggingMapByCluster){var theBounds,mz,mc=cClusterIcon.cluster_.getMarkerClusterer();google.maps.event.trigger(mc,"click",cClusterIcon.cluster_),google.maps.event.trigger(mc,"clusterclick",cClusterIcon.cluster_),mc.getZoomOnClick()&&(mz=mc.getMaxZoom(),theBounds=cClusterIcon.cluster_.getBounds(),mc.getMap().fitBounds(theBounds),setTimeout(function(){mc.getMap().fitBounds(theBounds),null!==mz&&mc.getMap().getZoom()>mz&&mc.getMap().setZoom(mz+1)},100)),e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation()}}),google.maps.event.addDomListener(this.div_,"mouseover",function(){var mc=cClusterIcon.cluster_.getMarkerClusterer();google.maps.event.trigger(mc,"mouseover",cClusterIcon.cluster_)}),google.maps.event.addDomListener(this.div_,"mouseout",function(){var mc=cClusterIcon.cluster_.getMarkerClusterer();google.maps.event.trigger(mc,"mouseout",cClusterIcon.cluster_)})},ClusterIcon.prototype.onRemove=function(){this.div_&&this.div_.parentNode&&(this.hide(),google.maps.event.removeListener(this.boundsChangedListener_),google.maps.event.clearInstanceListeners(this.div_),this.div_.parentNode.removeChild(this.div_),this.div_=null)},ClusterIcon.prototype.draw=function(){if(this.visible_){var pos=this.getPosFromLatLng_(this.center_);this.div_.style.top=pos.y+"px",this.div_.style.left=pos.x+"px"}},ClusterIcon.prototype.hide=function(){this.div_&&(this.div_.style.display="none"),this.visible_=!1},ClusterIcon.prototype.show=function(){if(this.div_){var img="",bp=this.backgroundPosition_.split(" "),spriteH=parseInt(bp[0].trim(),10),spriteV=parseInt(bp[1].trim(),10),pos=this.getPosFromLatLng_(this.center_);this.div_.style.cssText=this.createCss(pos),img="<img src='"+this.url_+"' style='position: absolute; top: "+spriteV+"px; left: "+spriteH+"px; ",img+=this.cluster_.getMarkerClusterer().enableRetinaIcons_?"width: "+this.width_+"px;height: "+this.height_+"px;":"clip: rect("+-1*spriteV+"px, "+(-1*spriteH+this.width_)+"px, "+(-1*spriteV+this.height_)+"px, "+-1*spriteH+"px);",img+="'>",this.div_.innerHTML=img+"<div style='position: absolute;top: "+this.anchorText_[0]+"px;left: "+this.anchorText_[1]+"px;color: "+this.textColor_+";font-size: "+this.textSize_+"px;font-family: "+this.fontFamily_+";font-weight: "+this.fontWeight_+";font-style: "+this.fontStyle_+";text-decoration: "+this.textDecoration_+";text-align: center;width: "+this.width_+"px;line-height:"+this.height_+"px;'>"+(this.cluster_.hideLabel_?" ":this.sums_.text)+"</div>",this.div_.title="undefined"==typeof this.sums_.title||""===this.sums_.title?this.cluster_.getMarkerClusterer().getTitle():this.sums_.title,this.div_.style.display=""}this.visible_=!0},ClusterIcon.prototype.useStyle=function(sums){this.sums_=sums;var index=Math.max(0,sums.index-1);index=Math.min(this.styles_.length-1,index);var style=this.styles_[index];this.url_=style.url,this.height_=style.height,this.width_=style.width,this.anchorText_=style.anchorText||[0,0],this.anchorIcon_=style.anchorIcon||[parseInt(this.height_/2,10),parseInt(this.width_/2,10)],this.textColor_=style.textColor||"black",this.textSize_=style.textSize||11,this.textDecoration_=style.textDecoration||"none",this.fontWeight_=style.fontWeight||"bold",this.fontStyle_=style.fontStyle||"normal",this.fontFamily_=style.fontFamily||"Arial,sans-serif",this.backgroundPosition_=style.backgroundPosition||"0 0"},ClusterIcon.prototype.setCenter=function(center){this.center_=center},ClusterIcon.prototype.createCss=function(pos){var style=[];return style.push("cursor: pointer;"),style.push("position: absolute; top: "+pos.y+"px; left: "+pos.x+"px;"),style.push("width: "+this.width_+"px; height: "+this.height_+"px;"),style.join("")},ClusterIcon.prototype.getPosFromLatLng_=function(latlng){var pos=this.getProjection().fromLatLngToDivPixel(latlng);return pos.x-=this.anchorIcon_[1],pos.y-=this.anchorIcon_[0],pos.x=parseInt(pos.x,10),pos.y=parseInt(pos.y,10),pos},Cluster.prototype.getSize=function(){return this.markers_.length},Cluster.prototype.getMarkers=function(){return this.markers_},Cluster.prototype.getCenter=function(){return this.center_},Cluster.prototype.getMap=function(){return this.map_},Cluster.prototype.getMarkerClusterer=function(){return this.markerClusterer_},Cluster.prototype.getBounds=function(){var i,bounds=new google.maps.LatLngBounds(this.center_,this.center_),markers=this.getMarkers();for(i=0;i<markers.length;i++)bounds.extend(markers[i].getPosition());return bounds},Cluster.prototype.remove=function(){this.clusterIcon_.setMap(null),this.markers_=[],delete this.markers_},Cluster.prototype.addMarker=function(marker){var i,mCount,mz;if(this.isMarkerAlreadyAdded_(marker))return!1;if(this.center_){if(this.averageCenter_){var l=this.markers_.length+1,lat=(this.center_.lat()*(l-1)+marker.getPosition().lat())/l,lng=(this.center_.lng()*(l-1)+marker.getPosition().lng())/l;this.center_=new google.maps.LatLng(lat,lng),this.calculateBounds_()}}else this.center_=marker.getPosition(),this.calculateBounds_();if(marker.isAdded=!0,this.markers_.push(marker),mCount=this.markers_.length,mz=this.markerClusterer_.getMaxZoom(),null!==mz&&this.map_.getZoom()>mz)marker.getMap()!==this.map_&&marker.setMap(this.map_);else if(mCount<this.minClusterSize_)marker.getMap()!==this.map_&&marker.setMap(this.map_);else if(mCount===this.minClusterSize_)for(i=0;mCount>i;i++)this.markers_[i].setMap(null);else marker.setMap(null);return!0},Cluster.prototype.isMarkerInClusterBounds=function(marker){return this.bounds_.contains(marker.getPosition())},Cluster.prototype.calculateBounds_=function(){var bounds=new google.maps.LatLngBounds(this.center_,this.center_);this.bounds_=this.markerClusterer_.getExtendedBounds(bounds)},Cluster.prototype.updateIcon_=function(){var mCount=this.markers_.length,mz=this.markerClusterer_.getMaxZoom();if(null!==mz&&this.map_.getZoom()>mz)return void this.clusterIcon_.hide();if(mCount<this.minClusterSize_)return void this.clusterIcon_.hide();var numStyles=this.markerClusterer_.getStyles().length,sums=this.markerClusterer_.getCalculator()(this.markers_,numStyles);this.clusterIcon_.setCenter(this.center_),this.clusterIcon_.useStyle(sums),this.clusterIcon_.show()},Cluster.prototype.isMarkerAlreadyAdded_=function(marker){for(var i=0,n=this.markers_.length;n>i;i++)if(marker===this.markers_[i])return!0;return!1},MarkerClusterer.prototype.onAdd=function(){var cMarkerClusterer=this;this.activeMap_=this.getMap(),this.ready_=!0,this.repaint(),this.listeners_=[google.maps.event.addListener(this.getMap(),"zoom_changed",function(){cMarkerClusterer.resetViewport_(!1),(this.getZoom()===(this.get("minZoom")||0)||this.getZoom()===this.get("maxZoom"))&&google.maps.event.trigger(this,"idle")}),google.maps.event.addListener(this.getMap(),"idle",function(){cMarkerClusterer.redraw_()})]},MarkerClusterer.prototype.onRemove=function(){var i;for(i=0;i<this.markers_.length;i++)this.markers_[i].getMap()!==this.activeMap_&&this.markers_[i].setMap(this.activeMap_);for(i=0;i<this.clusters_.length;i++)this.clusters_[i].remove();for(this.clusters_=[],i=0;i<this.listeners_.length;i++)google.maps.event.removeListener(this.listeners_[i]);this.listeners_=[],this.activeMap_=null,this.ready_=!1},MarkerClusterer.prototype.draw=function(){},MarkerClusterer.prototype.setupStyles_=function(){var i,size;if(!(this.styles_.length>0))for(i=0;i<this.imageSizes_.length;i++)size=this.imageSizes_[i],this.styles_.push({url:this.imagePath_+(i+1)+"."+this.imageExtension_,height:size,width:size})},MarkerClusterer.prototype.fitMapToMarkers=function(){var i,markers=this.getMarkers(),bounds=new google.maps.LatLngBounds;for(i=0;i<markers.length;i++)bounds.extend(markers[i].getPosition());this.getMap().fitBounds(bounds)},MarkerClusterer.prototype.getGridSize=function(){return this.gridSize_},MarkerClusterer.prototype.setGridSize=function(gridSize){this.gridSize_=gridSize},MarkerClusterer.prototype.getMinimumClusterSize=function(){return this.minClusterSize_},MarkerClusterer.prototype.setMinimumClusterSize=function(minimumClusterSize){this.minClusterSize_=minimumClusterSize},MarkerClusterer.prototype.getMaxZoom=function(){return this.maxZoom_},MarkerClusterer.prototype.setMaxZoom=function(maxZoom){this.maxZoom_=maxZoom},MarkerClusterer.prototype.getStyles=function(){return this.styles_},MarkerClusterer.prototype.setStyles=function(styles){this.styles_=styles},MarkerClusterer.prototype.getTitle=function(){return this.title_},MarkerClusterer.prototype.setTitle=function(title){this.title_=title},MarkerClusterer.prototype.getZoomOnClick=function(){return this.zoomOnClick_},MarkerClusterer.prototype.setZoomOnClick=function(zoomOnClick){this.zoomOnClick_=zoomOnClick},MarkerClusterer.prototype.getAverageCenter=function(){return this.averageCenter_},MarkerClusterer.prototype.setAverageCenter=function(averageCenter){this.averageCenter_=averageCenter},MarkerClusterer.prototype.getIgnoreHidden=function(){return this.ignoreHidden_},MarkerClusterer.prototype.setIgnoreHidden=function(ignoreHidden){this.ignoreHidden_=ignoreHidden},MarkerClusterer.prototype.getEnableRetinaIcons=function(){return this.enableRetinaIcons_},MarkerClusterer.prototype.setEnableRetinaIcons=function(enableRetinaIcons){this.enableRetinaIcons_=enableRetinaIcons},MarkerClusterer.prototype.getImageExtension=function(){return this.imageExtension_},MarkerClusterer.prototype.setImageExtension=function(imageExtension){this.imageExtension_=imageExtension},MarkerClusterer.prototype.getImagePath=function(){return this.imagePath_},MarkerClusterer.prototype.setImagePath=function(imagePath){this.imagePath_=imagePath},MarkerClusterer.prototype.getImageSizes=function(){return this.imageSizes_},MarkerClusterer.prototype.setImageSizes=function(imageSizes){this.imageSizes_=imageSizes},MarkerClusterer.prototype.getCalculator=function(){return this.calculator_},MarkerClusterer.prototype.setCalculator=function(calculator){this.calculator_=calculator},MarkerClusterer.prototype.setHideLabel=function(hideLabel){this.hideLabel_=hideLabel},MarkerClusterer.prototype.getHideLabel=function(){return this.hideLabel_},MarkerClusterer.prototype.getBatchSizeIE=function(){return this.batchSizeIE_},MarkerClusterer.prototype.setBatchSizeIE=function(batchSizeIE){this.batchSizeIE_=batchSizeIE},MarkerClusterer.prototype.getClusterClass=function(){return this.clusterClass_},MarkerClusterer.prototype.setClusterClass=function(clusterClass){this.clusterClass_=clusterClass},MarkerClusterer.prototype.getMarkers=function(){return this.markers_},MarkerClusterer.prototype.getTotalMarkers=function(){return this.markers_.length},MarkerClusterer.prototype.getClusters=function(){return this.clusters_},MarkerClusterer.prototype.getTotalClusters=function(){return this.clusters_.length},MarkerClusterer.prototype.addMarker=function(marker,opt_nodraw){this.pushMarkerTo_(marker),opt_nodraw||this.redraw_()},MarkerClusterer.prototype.addMarkers=function(markers,opt_nodraw){var key;for(key in markers)markers.hasOwnProperty(key)&&this.pushMarkerTo_(markers[key]);opt_nodraw||this.redraw_()},MarkerClusterer.prototype.pushMarkerTo_=function(marker){if(marker.getDraggable()){var cMarkerClusterer=this;google.maps.event.addListener(marker,"dragend",function(){cMarkerClusterer.ready_&&(this.isAdded=!1,cMarkerClusterer.repaint())})}marker.isAdded=!1,this.markers_.push(marker)},MarkerClusterer.prototype.removeMarker=function(marker,opt_nodraw,opt_noMapRemove){var removeFromMap=!0&&!opt_noMapRemove,removed=this.removeMarker_(marker,removeFromMap);return!opt_nodraw&&removed&&this.repaint(),removed},MarkerClusterer.prototype.removeMarkers=function(markers,opt_nodraw,opt_noMapRemove){var i,r,removed=!1,removeFromMap=!0&&!opt_noMapRemove;for(i=0;i<markers.length;i++)r=this.removeMarker_(markers[i],removeFromMap),removed=removed||r;return!opt_nodraw&&removed&&this.repaint(),removed},MarkerClusterer.prototype.removeMarker_=function(marker,removeFromMap){var i,index=-1;if(this.markers_.indexOf)index=this.markers_.indexOf(marker);else for(i=0;i<this.markers_.length;i++)if(marker===this.markers_[i]){index=i;break}return-1===index?!1:(removeFromMap&&marker.setMap(null),this.markers_.splice(index,1),!0)},MarkerClusterer.prototype.clearMarkers=function(){this.resetViewport_(!0),this.markers_=[]},MarkerClusterer.prototype.repaint=function(){var oldClusters=this.clusters_.slice();this.clusters_=[],this.resetViewport_(!1),this.redraw_(),setTimeout(function(){var i;for(i=0;i<oldClusters.length;i++)oldClusters[i].remove()},0)},MarkerClusterer.prototype.getExtendedBounds=function(bounds){var projection=this.getProjection(),tr=new google.maps.LatLng(bounds.getNorthEast().lat(),bounds.getNorthEast().lng()),bl=new google.maps.LatLng(bounds.getSouthWest().lat(),bounds.getSouthWest().lng()),trPix=projection.fromLatLngToDivPixel(tr);trPix.x+=this.gridSize_,trPix.y-=this.gridSize_;var blPix=projection.fromLatLngToDivPixel(bl);blPix.x-=this.gridSize_,blPix.y+=this.gridSize_;var ne=projection.fromDivPixelToLatLng(trPix),sw=projection.fromDivPixelToLatLng(blPix);return bounds.extend(ne),bounds.extend(sw),bounds},MarkerClusterer.prototype.redraw_=function(){this.createClusters_(0)},MarkerClusterer.prototype.resetViewport_=function(opt_hide){var i,marker;for(i=0;i<this.clusters_.length;i++)this.clusters_[i].remove();for(this.clusters_=[],i=0;i<this.markers_.length;i++)marker=this.markers_[i],marker.isAdded=!1,opt_hide&&marker.setMap(null)},MarkerClusterer.prototype.distanceBetweenPoints_=function(p1,p2){var R=6371,dLat=(p2.lat()-p1.lat())*Math.PI/180,dLon=(p2.lng()-p1.lng())*Math.PI/180,a=Math.sin(dLat/2)*Math.sin(dLat/2)+Math.cos(p1.lat()*Math.PI/180)*Math.cos(p2.lat()*Math.PI/180)*Math.sin(dLon/2)*Math.sin(dLon/2),c=2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a)),d=R*c;return d},MarkerClusterer.prototype.isMarkerInBounds_=function(marker,bounds){return bounds.contains(marker.getPosition())},MarkerClusterer.prototype.addToClosestCluster_=function(marker){var i,d,cluster,center,distance=4e4,clusterToAddTo=null;for(i=0;i<this.clusters_.length;i++)cluster=this.clusters_[i],center=cluster.getCenter(),center&&(d=this.distanceBetweenPoints_(center,marker.getPosition()),distance>d&&(distance=d,clusterToAddTo=cluster));clusterToAddTo&&clusterToAddTo.isMarkerInClusterBounds(marker)?clusterToAddTo.addMarker(marker):(cluster=new Cluster(this),cluster.addMarker(marker),this.clusters_.push(cluster))},MarkerClusterer.prototype.createClusters_=function(iFirst){var i,marker,mapBounds,cMarkerClusterer=this;if(this.ready_){0===iFirst&&(google.maps.event.trigger(this,"clusteringbegin",this),"undefined"!=typeof this.timerRefStatic&&(clearTimeout(this.timerRefStatic),delete this.timerRefStatic)),mapBounds=this.getMap().getZoom()>3?new google.maps.LatLngBounds(this.getMap().getBounds().getSouthWest(),this.getMap().getBounds().getNorthEast()):new google.maps.LatLngBounds(new google.maps.LatLng(85.02070771743472,-178.48388434375),new google.maps.LatLng(-85.08136444384544,178.00048865625));var bounds=this.getExtendedBounds(mapBounds),iLast=Math.min(iFirst+this.batchSize_,this.markers_.length);for(i=iFirst;iLast>i;i++)marker=this.markers_[i],!marker.isAdded&&this.isMarkerInBounds_(marker,bounds)&&(!this.ignoreHidden_||this.ignoreHidden_&&marker.getVisible())&&this.addToClosestCluster_(marker);if(iLast<this.markers_.length)this.timerRefStatic=setTimeout(function(){cMarkerClusterer.createClusters_(iLast)},0);else for(delete this.timerRefStatic,google.maps.event.trigger(this,"clusteringend",this),i=0;i<this.clusters_.length;i++)this.clusters_[i].updateIcon_()}},MarkerClusterer.prototype.extend=function(obj1,obj2){return function(object){var property;for(property in object.prototype)this.prototype[property]=object.prototype[property];return this}.apply(obj1,[obj2])},MarkerClusterer.CALCULATOR=function(markers,numStyles){for(var index=0,title="",count=markers.length.toString(),dv=count;0!==dv;)dv=parseInt(dv/10,10),index++;return index=Math.min(index,numStyles),{text:count,index:index,title:title}},MarkerClusterer.BATCH_SIZE=2e3,MarkerClusterer.BATCH_SIZE_IE=500,MarkerClusterer.IMAGE_PATH="//cdn.rawgit.com/mahnunchik/markerclustererplus/master/images/m",MarkerClusterer.IMAGE_EXTENSION="png",MarkerClusterer.IMAGE_SIZES=[53,56,66,78,90],"function"!=typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")});

    </script>
    <script type='text/javascript'>
        //markerclusterer doesn't support a rightclick event on clusters.  adding it
        ClusterIcon.prototype.onAdd = function () {
            var cClusterIcon = this;
            var cMouseDownInCluster;
            var cDraggingMapByCluster;
            this.div_ = document.createElement("div");
            this.div_.className = this.className_;
            if (this.visible_) {
                this.show();
            }

            this.getPanes().overlayMouseTarget.appendChild(this.div_);

            // Fix for Issue 157
            this.boundsChangedListener_ = google.maps.event.addListener(this.getMap(), "bounds_changed", function () {
                cDraggingMapByCluster = cMouseDownInCluster;
            });

            google.maps.event.addDomListener(this.div_, "mousedown", function () {
                cMouseDownInCluster = true;
                cDraggingMapByCluster = false;
            });

            google.maps.event.addDomListener(this.div_, "click", function (e) {
                cMouseDownInCluster = false;
                if (!cDraggingMapByCluster) {
                    var theBounds;
                    var mz;
                    var mc = cClusterIcon.cluster_.getMarkerClusterer();
                    /**
                    * This event is fired when a cluster marker is clicked.
                    * @name MarkerClusterer#click
                    * @param {Cluster} c The cluster that was clicked.
                    * @event
                    */
                    google.maps.event.trigger(mc, "click", cClusterIcon.cluster_);
                    google.maps.event.trigger(mc, "clusterclick", cClusterIcon.cluster_); // deprecated name

                    // The default click handler follows. Disable it by setting
                    // the zoomOnClick property to false.
                    if (mc.getZoomOnClick()) {
                        // Zoom into the cluster.
                        mz = mc.getMaxZoom();
                        theBounds = cClusterIcon.cluster_.getBounds();
                        mc.getMap().fitBounds(theBounds);
                        // There is a fix for Issue 170 here:
                        setTimeout(function () {
                            mc.getMap().fitBounds(theBounds);
                            // Don't zoom beyond the max zoom level
                            if (mz !== null && (mc.getMap().getZoom() > mz)) {
                                mc.getMap().setZoom(mz + 1);
                            }
                        }, 100);
                    }

                    // Prevent event propagation to the map:
                    e.cancelBubble = true;
                    if (e.stopPropagation) {
                        e.stopPropagation();
                    }
                }
            });

            //adding rightclick event handling - DK 11/25/14
            google.maps.event.addDomListener(this.div_, "contextmenu", function (e)
            {
                //trigger rightclick event
                google.maps.event.trigger(cClusterIcon.cluster_.getMarkerClusterer(), "rightclick", cClusterIcon.cluster_);

                // Prevent event propagation to the map:
                e.cancelBubble = true;
                if (e.stopPropagation) { e.stopPropagation(); }
                if (e.preventDefault) { e.preventDefault(); }
            });

            google.maps.event.addDomListener(this.div_, "mouseover", function () {
                var mc = cClusterIcon.cluster_.getMarkerClusterer();
                /**
                * This event is fired when the mouse moves over a cluster marker.
                * @name MarkerClusterer#mouseover
                * @param {Cluster} c The cluster that the mouse moved over.
                * @event
                */
                google.maps.event.trigger(mc, "mouseover", cClusterIcon.cluster_);
            });

            google.maps.event.addDomListener(this.div_, "mouseout", function () {
                var mc = cClusterIcon.cluster_.getMarkerClusterer();
                /**
                * This event is fired when the mouse moves out of a cluster marker.
                * @name MarkerClusterer#mouseout
                * @param {Cluster} c The cluster that the mouse moved out of.
                * @event
                */
                google.maps.event.trigger(mc, "mouseout", cClusterIcon.cluster_);
            });
        };

    </script>

    <!-- Google Maps - KeyDragZoom -->
    <script type='text/javascript' src="{!URLFOR($Resource.MapAnything, 'js/google/keydragzoom/keydragzoom_packed.js')}"></script>

    <!-- Google Maps - geoxml3 (https://code.google.com/p/geoxml3/) -->
    <script type='text/javascript' src="{!URLFOR($Resource.MapAnything, 'js/google/geoxml3/geoxml3.js')}"></script>

    <!-- Google Maps - Spiderfy (https://github.com/jawj/OverlappingMarkerSpiderfier) -->
    <script type='text/javascript' src="{!URLFOR($Resource.MapAnything, 'js/google/overlappingmarkerspiderfier/oms.min.js')}"></script>

    <!-- Scrolling -->
    <script type='text/javascript' src="{!URLFOR($Resource.MapAnything, 'niceScroll/jquery.slimscroll.js')}"></script>

    <!-- Context Menu (http://medialize.github.io/jQuery-contextMenu/) -->
    <script type='text/javascript' src="{!URLFOR($Resource.MapAnything, 'contextMenu/jquery.contextmenu.js')}"></script>

    <!-- Colorbox (overlay) -->
    <script type="text/javascript" src="{!URLFOR($Resource.MapAnything, 'colorbox/jquery.colorbox-min.js')}"></script>
    <link type="text/css" rel="stylesheet" href="{!URLFOR($Resource.MapAnything, 'colorbox/css4/colorbox.css')}" />

    <!-- Date JS-->
    <script src="{!URLFOR($Resource.QueryEditor, 'js/date.js')}" type="text/javascript"></script>

    <!-- Moment (date parsing) -->
    <script src="{!URLFOR($Resource.MapAnything, 'js/moment.js')}" type="text/javascript"></script>
    <script src="{!URLFOR($Resource.MapAnything, 'js/moment_tz.js')}" type="text/javascript"></script>

    <!-- jQuery Multiselect (depends on jQuery UI) -->
    <script src="{!URLFOR($Resource.QueryEditor, 'js/multiselect/jquery.multiselect.min.js')}" type="text/javascript"></script>
    <script src="{!URLFOR($Resource.QueryEditor, 'js/multiselect/jquery.multiselect.filter.js')}" type="text/javascript"></script>
    <link rel="stylesheet" type="text/css" href="{!URLFOR($Resource.QueryEditor, 'js/multiselect/jquery.multiselect.css')}" />
    <link rel="stylesheet" type="text/css" href="{!URLFOR($Resource.QueryEditor, 'js/multiselect/jquery.multiselect.filter.css')}" />

    <!-- Combobox -->
    <script src="{!URLFOR($Resource.QueryEditor, 'js/combobox/jquery.combobox.js')}" type="text/javascript"></script>

    <!-- bxSlider (http://bxslider.com/) -->
    <script type='text/javascript' src="{!URLFOR($Resource.MapAnything, 'jquery/jquery.bxslider.min.js')}"></script>

    <!-- Removed due to not supporting new jquery -->
    <!--<script type='text/javascript' src="{!URLFOR($Resource.MapAnything, 'js/jquery.hotkeys.js')}"></script>-->

    <!-- CSS -->
    <c:CSSEditQuery />
    <c:CSSHelperBlue />
    <!-- c:CSSMapAnything -->

    <!-- moving style off page... -->
    <link rel="stylesheet" type="text/css" href="{!URLFOR($Resource.MapAnythingJS, 'styles/oldOnPageStyle.css')}" />

	<style>
		div#DrawRectangleButton {
		  background-image: url('{!URLFOR($Resource.MapAnything, "/images/drawingtools/gt_rectangle.png")}');
		  background-size: 21px 22px;
		  background-repeat: no-repeat;
		  background-position: 7px 7px;
		}

		div#DrawRectangleButton.activeDrawingTool {
		  background-color: #237bc5;
		  background-image: url('{!URLFOR($Resource.MapAnything, "/images/drawingtools/gt_rectangle_active.png")}');
		  background-size: 21px 22px;
		  background-repeat: no-repeat;
		  background-position: 7px 7px;
		  box-shadow: inset 0 0 2px rgba(0, 0, 0, 0.2);
		}

		div#DrawCircleButton {
		  background-image: url('{!URLFOR($Resource.MapAnything, "images/drawingtools/gt_circle.png")}');
		  background-size: 18px 22px;
		  background-repeat: no-repeat;
		  background-position: 9px 7px;
		}

		div#DrawCircleButton.activeDrawingTool {
		  background-color: #237bc5;
		  background-image: url('{!URLFOR($Resource.MapAnything, "images/drawingtools/gt_circle_active.png")}');
		  background-size: 18px 22px;
		  background-repeat: no-repeat;
		  background-position: 9px 7px;
		  box-shadow: inset 0 0 2px rgba(0, 0, 0, 0.2);
		}

		div#DrawPolygonButton {
		  background-image: url('{!URLFOR($Resource.MapAnything, "images/drawingtools/gt_polygon.png")}');
		  background-size: 21px 20px;
		  background-repeat: no-repeat;
		  background-position: 8px 8px;
		}

		div#DrawPolygonButton.activeDrawingTool {
		  background-color: #237bc5;
		  background-image: url('{!URLFOR($Resource.MapAnything, "images/drawingtools/gt_polygon_active.png")}');
		  background-size: 21px 20px;
		  background-repeat: no-repeat;
		  background-position: 8px 8px;
		  box-shadow: inset 0 0 2px rgba(0, 0, 0, 0.2);
		}

		div#StopDrawingButton {
		  background-image: url('{!URLFOR($Resource.MapAnything, "images/drawingtools/gt_hand.png")}');
		  background-size: 19px 20px;
		  background-repeat: no-repeat;
		  background-position: 8px 8px;
		}

		#StopDrawingButton.activeDrawingTool {
		  background-color: #237bc5;
		  background-image: url('{!URLFOR($Resource.MapAnything, "images/drawingtools/gt_hand_active.png")}');
		  background-size: 19px 20px;
		  background-repeat: no-repeat;
		  background-position: 8px 8px;
		  box-shadow: inset 0 0 2px rgba(0, 0, 0, 0.2);
		}


		/*Map View*/

		td[data-basemaptype="roadmap"] {
		  background-image:url('{!URLFOR($Resource.MapAnything, '/images/MapView/roadmap.png')}');
		  height: 100px;
		  width: 100px;
		  vertical-align: bottom;
		}

		td[data-basemaptype="satellite"] {
		  background-image:url('{!URLFOR($Resource.MapAnything, '/images/MapView/Satellite.png')}');
		  height: 100px;
		  width: 100px;
		  vertical-align: bottom;
		}

		td[data-basemaptype="hybrid"] {
		  background-image:url('{!URLFOR($Resource.MapAnything, '/images/MapView/hybrid.png')}');
		  height: 100px;
		  width: 100px;
		  vertical-align: bottom;
		}

		td[data-basemaptype="terrain"] {
		  background-image:url('{!URLFOR($Resource.MapAnything, '/images/MapView/terrain.png')}');
		  height: 100px;
		  width: 100px;
		  vertical-align: bottom;
		}

		#listview th.listview-col-sortable>span {
		  background-image: url('{!URLFOR($Resource.MapAnything, '/images/white_arrows.png')}');
		  background-repeat: no-repeat;
		  background-position: 0 0;
		  width: 10px;
		  position: absolute;
		  top: 5px;
		  right: 3px;
		  height: 15px;
		  opacity: 0.7;
		}

		#listview th.listview-col-sortable.listview-col-sort-asc>span {
		  background-image: url('{!URLFOR($Resource.MapAnything, '/images/white_arrows.png')}');
		  background-repeat: no-repeat;
		  background-position: 0px -26px;
		  width: 10px;
		  position: absolute;
		  top: 9px;
		  right: 3px;
		  height: 10px;
		  opacity: 1;
		}

		#listview th.listview-col-sortable.listview-col-sort-desc>span {
		  background-image: url('{!URLFOR($Resource.MapAnything, '/images/white_arrows.png')}');
		  background-repeat: no-repeat;
		  background-position: 0px -16px;
		  width: 10px;
		  position: absolute;
		  top: 8px;
		  right: 3px;
		  height: 10px;
		  opacity: 1;
		}

		#listview th.listview-col-sortable>span {
		  background-image: url('{!URLFOR($Resource.MapAnything, '/images/white_arrows.png')}');
		  background-repeat: no-repeat;
		  background-position: 0 0;
		  width: 10px;
		  position: absolute;
		  top: 5px;
		  right: 3px;
		  height: 15px;
		  opacity: 0.7;
		}

		#listview th.listview-col-sortable.listview-col-sort-asc>span {
		  background-image: url('{!URLFOR($Resource.MapAnything, '/images/white_arrows.png')}');
		  background-repeat: no-repeat;
		  background-position: 0px -26px;
		  width: 10px;
		  position: absolute;
		  top: 9px;
		  right: 3px;
		  height: 10px;
		  opacity: 1;
		}

		#listview th.listview-col-sortable.listview-col-sort-desc>span {
		  background-image: url('{!URLFOR($Resource.MapAnything, '/images/white_arrows.png')}');
		  background-repeat: no-repeat;
		  background-position: 0px -16px;
		  width: 10px;
		  position: absolute;
		  top: 8px;
		  right: 3px;
		  height: 10px;
		  opacity: 1;
		}

		#sidebar-content [aria-selected=true]>#tabs-nav-queries {
		  background: transparent url('{!URLFOR($Resource.MapAnything, 'images/ui-icons/Tree_Icons_Small.png')}') no-repeat;
		  background-position: -81px -41px;
		}

		#sidebar-content [aria-selected=true]>#tabs-nav-plotted {
		  background: transparent url('{!URLFOR($Resource.MapAnything, 'images/ui-icons/Tree_Icons_Small.png')}') no-repeat;
		  background-position: -81px 8px;
		}

		#sidebar-content [aria-selected=true]>#tabs-nav-routes {
		  background: transparent url('{!URLFOR($Resource.MapAnything, 'images/ui-icons/Tree_Icons_Small.png')}') no-repeat;
		  background-position: -82px -148px;
		}

		#sidebar-content [aria-selected=true]>#tabs-nav-poi {
		  background: transparent url('{!URLFOR($Resource.MapAnything, 'images/ui-icons/Tree_Icons_Small.png')}') no-repeat;
		  background-position: -86px -99px;
		}

		#sidebar-content [aria-selected=false]>#tabs-nav-queries {
		  background: transparent url('{!URLFOR($Resource.MapAnything, 'images/ui-icons/Tree_Icons_Small.png')}') no-repeat;
		  background-position: 25px -41px;
		}

		#sidebar-content [aria-selected=false]>#tabs-nav-plotted {
		  background: transparent url('{!URLFOR($Resource.MapAnything, 'images/ui-icons/Tree_Icons_Small.png')}') no-repeat;
		  background-position: 25px 8px;
		}

		#sidebar-content [aria-selected=false]>#tabs-nav-routes {
		  background: transparent url('{!URLFOR($Resource.MapAnything, 'images/ui-icons/Tree_Icons_Small.png')}') no-repeat;
		  background-position: 32px -149px;
		}

		#sidebar-content [aria-selected=false]>#tabs-nav-poi {
		  background: transparent url('{!URLFOR($Resource.MapAnything, 'images/ui-icons/Tree_Icons_Small.png')}') no-repeat;
		  background-position: 31px -99px;
		}

		#SQTree .jstree-star {
		  padding-right: 20px !important;
		  background:url('{!URLFOR($Resource.MapAnything, 'images/star_full.png')}') right top no-repeat !important;
		}

		#tooltip-content .tabs>div.loading, .infobubble .tabs>div.loading {
		  background: transparent url('{!URLFOR($Resource.MapAnything, 'images/chatterstatus-loader.gif')}') no-repeat center;
		}

		a.btn.white .btn-dropdown-arrow-blue {
		  background: url("{!URLFOR($Resource.MapAnything, 'images/dropdown_arrow_blue2.png')}") no-repeat scroll 1px 3px transparent;
		  border-radius: 3px 3px 3px 3px;
		  display: block;
		  height: 5px;
		  margin: 0 0 0 5px;
		  padding: 3px 1px;
		  position: absolute;
		  top: 5px;
		  right: 5px;
		  width: 9px;
		}

		#createrecord-loadmask, #createrecordDataLayer-loadmask {
		  position: absolute;
		  top: 0;
		  left: 0;
		  width: 100%;
		  height: 100%;
		  z-index: 99999999;
		  background: rgba(0, 0, 0, 0.04) url('{!URLFOR($Resource.MapAnything, 'images/chatterstatus-loader.gif')}') center no-repeat;
		}

		#cboxLoadingOverlay {
		  background: white url('{!URLFOR($Resource.MapAnything, "MapLoadingGif.gif")}') no-repeat center;
		}

		#queryeditor-modal .query-editor-modal-loader {
		  background: white url('{!URLFOR($Resource.MapAnything, "MapLoadingGif.gif")}') no-repeat;
		  padding-left: 132px;
		  height: 118px;
		  line-height: 118px;
		  font-size: 18px;
		  font-weight: bold;
		}

		#Favorites-Tree .jstree li[rel="leaf"]>a>.jstree-icon {
		  background-image: url("{!URLFOR($Resource.MapAnything, '/images/ui-icons/favorites.png')}");
		  background-size: 16px;
		}

		#PlottedQueriesContainer .PlottedRowUnit .plottinginfo-wrapper .info-icon, #PlottedQueriesContainer .PlottedShapeLayer .info-icon {
		  position: absolute;
		  margin-top: 10px;
		  padding: 0;
		  left: 10px;
		  top: 5px;
		  height: 17px;
		  width: 17px;
		  background: transparent url("{!URLFOR($Resource.MapAnything, '/images/ui-icons/ui-info.png')}") center no-repeat;
		  background-size: 16px;
		}

		#PlottedQueriesContainer .PlottedRowUnit .icon .color-box.dynamic {
		  height: 20px;
		  width: 30px;
		  background: url("{!URLFOR($Resource.MapAnything, 'images/ui-icons/dymanic-legend.png')}") center no-repeat;
		}

		.PlottedRowUnit .plotted-visibile-icon .select-icon.Markers {
		  background: url("{!URLFOR($Resource.MapAnything, 'images/ui-icons/icon_pin17.png')}") center no-repeat;
		}

		.PlottedRowUnit .plotted-visibile-icon .select-icon.Cluster {
		  background: url("{!URLFOR($Resource.MapAnything, 'images/ui-icons/icon_cluster17.png')}") center no-repeat;
		}

		.PlottedRowUnit .plotted-visibile-icon .select-icon.Heatmap {
		  background: url("{!URLFOR($Resource.MapAnything, 'images/ui-icons/icon_heatmap17.png')}") center no-repeat;
		}

		.PlottedRowUnit .plotted-visibile-icon .select-icon.Scatter {
		  background: url("{!URLFOR($Resource.MapAnything, 'images/ui-icons/icon_scatter17.png')}") center no-repeat;
		}


		/* Saved Query Icons */

		.jstree li[rel="SavedQuery"]>a>.jstree-icon {
		  background: url("{!URLFOR($Resource.MapAnything, 'images/ui-icons/static-legend2.png')}") !important;
		}

		.jstree li[rel="SavedQuery"][querytype="Standard-Dynamic"]>a>.jstree-icon {
		  background: url("{!URLFOR($Resource.MapAnything, 'images/ui-icons/static-dynamic.png')}") !important;
		}

		.jstree li[rel="LegendSavedQuery"]>a>.jstree-icon {
		  background: url("{!URLFOR($Resource.MapAnything, 'images/ui-icons/dymanic-legend.png')}") !important;
		}

		.jstree li[rel="LegendSavedQuery"][querytype="Legend-Dynamic"]>a>.jstree-icon {
		  background: url("{!URLFOR($Resource.MapAnything, 'images/ui-icons/dynamic-dynamic.png')}") !important;
		}

		.jstree li[rel="SavedDataLayer"]>a>.jstree-icon {
		  background: url("{!URLFOR($Resource.MapAnything, 'malayersv2/img/data_icon.svg')}") !important;
		}

		#demographic-alert-image {
		  background-image: url("{!URLFOR($Resource.MapAnything, 'malayersv2/img/data_icon.svg')}");
		  background-repeat: no-repeat;
		  background-position: center;
		  height: 40px;
		  width: 40px;
		  background-size: 40px 40px;
		}

		#PlottedQueriesContainer .DataLayer .icon .color-box {
		  background-image: url("{!URLFOR($Resource.MapAnything, 'malayersv2/img/data_icon.svg')}") !important;
		  background-repeat: no-repeat;
		  background-position: center;
		  height: 20px;
		}


		/* Root Folder Icons */

		#SQTree li[nodetype="PersonalRoot"]>a>.jstree-icon, #SQTree li[nodetype="RoleRoot"]>a>.jstree-icon, #SQTree li[nodetype="CorporateRoot"]>a>.jstree-icon, #Favorites-Tree li[rel="Root"]>a>.jstree-icon {
		  background: url("{!URLFOR($Resource.MapAnything, 'images/ui-icons/root-folder-closed.png')}") !important;
		}

		#SQTree li[nodetype="PersonalRoot"].jstree-open>a>.jstree-icon, #SQTree li[nodetype="RoleRoot"].jstree-open>a>.jstree-icon, #SQTree li[nodetype="CorporateRoot"].jstree-open>a>.jstree-icon, #Favorites-Tree li[rel="Root"].jstree-open>a>.jstree-icon {
		  background: url("{!URLFOR($Resource.MapAnything, 'images/ui-icons/root-folder.png')}") !important;
		}


		/* Folder Icons */

		#SQTree li[nodetype="PersonalFolder"]>a>.jstree-icon, #SQTree li[nodetype="CorporateFolder"]>a>.jstree-icon, #SQTree li[nodetype="RoleNameFolder"]>a>.jstree-icon, #SQTree li[nodetype="RoleUserFolder"]>a>.jstree-icon, #Favorites-Tree li[rel="Folder"]>a>.jstree-icon {
		  background: url("{!URLFOR($Resource.MapAnything, 'images/ui-icons/child-folder-closed.png')}") !important;
		}

		#SQTree li[nodetype="PersonalFolder"].jstree-open>a>.jstree-icon, #SQTree li[nodetype="CorporateFolder"].jstree-open>a>.jstree-icon, #SQTree li[nodetype="RoleNameFolder"].jstree-open>a>.jstree-icon, #SQTree li[nodetype="RoleUserFolder"].jstree-open>a>.jstree-icon, #Favorites-Tree li[rel="Folder"].jstree-open>a>.jstree-icon {
		  background: url("{!URLFOR($Resource.MapAnything, 'images/ui-icons/child-folder.png')}") !important;
		}


		/* Loading Icons */

		#SQTree li[nodetype="PersonalRoot"]>a.jstree-loading>.jstree-icon, #SQTree li[nodetype="RoleRoot"]>a.jstree-loading>.jstree-icon, #SQTree li[nodetype="CorporateRoot"]>a.jstree-loading>.jstree-icon, #Favorites-Tree li[rel="Root"]>a.jstree-loading>.jstree-icon, #SQTree li[nodetype="PersonalFolder"]>a.jstree-loading>.jstree-icon, #SQTree li[nodetype="CorporateFolder"]>a.jstree-loading>.jstree-icon, #SQTree li[nodetype="RoleNameFolder"]>a.jstree-loading>.jstree-icon, #SQTree li[nodetype="RoleUserFolder"]>a.jstree-loading>.jstree-icon, #Favorites-Tree li[rel="Folder"]>a.jstree-loading>.jstree-icon {
		  background: url("{!URLFOR($Resource.MapAnything, 'images/ui-icons/tree-loader.gif')}") no-repeat !important;
		}

		#SQTree li[nodetype="PersonalLocation"]>a>.jstree-icon {
		  background: url("{!URLFOR($Resource.MapAnything, 'images/ui-icons/favorite_tree_icon.png')}") !important;
		}


		/* Copied from style.css */

		.jstree-default li, .jstree-default ins {
		  background-image:url("{!URLFOR($Resource.MapAnything, 'jstree/themes/default/d.png')}");
		  background-repeat: no-repeat;
		  background-color: transparent;
		}

		#jstree-marker.jstree-default {
		  background:url("{!URLFOR($Resource.MapAnything, 'jstree/themes/default/d.png')}") -55px -65px no-repeat !important;
		  text-indent: -100px;
		  z-index: 15;
		  width: 19px;
		  height: 19px;
		}

		#vakata-contextmenu li a span {
		  background: url('{!URLFOR($Resource.MapAnything, '/contextMenu/images/contextmenu-arrow.png')}') no-repeat;
		  position: relative;
		  top: 5px;
		  width: 10px;
		  height: 10px;
		  color: transparent;
		}

		#vakata-dragged.jstree-default .jstree-ok {
		  width: 19px;
		  height: 19px;
		  -moz-border-radius: 0;
		  -webkit-border-radius: 0;
		  border-radius: 0;
		  background:url("{!URLFOR($Resource.MapAnything, 'jstree/themes/default/d.png')}") -2px -62px no-repeat !important;
		}

		#vakata-dragged.jstree-default .jstree-invalid {
		  width: 19px;
		  height: 19px;
		  -moz-border-radius: 0;
		  -webkit-border-radius: 0;
		  border-radius: 0;
		  background:url("{!URLFOR($Resource.MapAnything, 'jstree/themes/default/d.png')}") -26px -62px no-repeat !important;
		}

		.pac-container:after {
		  content: "";
		  padding: 1px 1px 1px 0;
		  height: 16px;
		  text-align: right;
		  display: block;
		  background-image: url("{!URLFOR($Resource.MapAnything, 'js/google/images/powered-by-google-on-white2.png')}");
		  background-position: right;
		  background-repeat: no-repeat;
		  background-size: 104px 16px;
		}

		.pac-icon {
		  width: 15px;
		  height: 20px;
		  margin-right: 7px;
		  margin-top: 6px;
		  display: inline-block;
		  vertical-align: top;
		  background-image: url("{!URLFOR($Resource.MapAnything, 'js/google/images/autocomplete-icons.png')}");
		  background-size: 34px;
		}

		.tooltip-row.Color td.icon {
		  background: transparent url("{!URLFOR($Resource.MapAnything, 'images/SymbolPicker_Mini.png')}") no-repeat;
		  width: 20px;
		}

		.tooltipMapBG {
		  background-image: url('{!URLFOR($Resource.MapAnything, '/dataLayerBuilder/img/mapSample.png')}');
		  height: auto;
		  min-height: 200px;
		  width: 85% !important;
		  background-position: top left;
		  float: left;
		  padding: 50px;
		}

		.baseobject-row .data.checked div {
		  background: transparent url('{!URLFOR($Resource.MapAnything, 'images/checkbox-checked-32.png')}') no-repeat center;
		}

		.baseobject-row .data.unchecked div {
		  background: transparent url('{!URLFOR($Resource.MapAnything, 'images/checkbox-unchecked-32.png')}') no-repeat center;
		}

		.baseobject-row .data.loading div {
		  background: transparent url('{!URLFOR($Resource.MapAnything, 'images/chatter-loader.gif')}') no-repeat center;
		}

		#SQTree li[rel="SavedTerritory"]>a>.jstree-icon {
		  background: url("{!URLFOR($Resource.MapAnything, 'images/ui-icons/boundry_tree_icon.png')}") !important;
		}

		.boundary-cell:hover .checkbox, .boundary-cell.checked .checkbox {
		  background: #A6ADBB url('{!URLFOR($Resource.MapAnything, 'images/ui-icons/ui-ckeck-mark.png')}') no-repeat -11px 1px;
		  background-size: 22px;
		}

		.territory-row[data-state="loading"] .territory-row-toggle {
		  width: 8px;
		  height: 8px;
		  background: transparent url("{!URLFOR($Resource.MapAnything, 'images/chatterstatus-loader.gif')}") no-repeat center;
		}

		#toast-container .ma-toast-loading {
		  background-color: #16325c;
		  background-image: url('{!URLFOR($Resource.MAPhone, "/s1Mobile/images/spinners/slds_spinner_inverse.gif")}');
		  background-size: 30px 30px;
		}

		#toast-container .toast-warning {
		  background-color: #e3924a;
		}

		#toast-container .toast-error {
		  background-color: #d4504c;
		}

		#toast-container .toast-success {
		  background-color: #003c4c;
		}

		.ui-combobox a .ui-button-icon-primary {
		  background: transparent url("{!URLFOR($Resource.QueryEditor, 'images/icons/combobox-arrow-16.png')}") no-repeat center !important;
		}

		#PlottedQueriesContainer .styled-select {
		  width: 100px;
		  height: 20px;
		  overflow: hidden;
		  background: url("{!URLFOR($Resource.QueryEditor, '/images/icons/combobox-arrow-16.png')}") no-repeat right;
		  border: 1px solid #ccc;
		  border-radius: 3px;
		}

		#permissions-grid-wrapper .ui-combobox a .ui-button-icon-primary {
		  background: transparent url("{!URLFOR($Resource.QueryEditor, 'images/icons/combobox-arrow-16.png')}") no-repeat center;
		}

		.tracking-history-content input[id*="cor"]:checked+label:before {
		  content: '';
		  background-image: url(/resource/1472208638000/sma__MapAnything/images/check-22.png);
		  display: block;
		  position: absolute;
		  z-index: 99;
		  background-size: 14px 14px;
		  width: 14px;
		  height: 14px;
		  top: 1px;
		  left: 1px;
		  color: #000;
		}

		.colorIsChecked {
		  content: '';
		  background-image: url(/resource/1472208638000/sma__MapAnything/images/check-22.png);
		  display: block;
		  position: absolute;
		  z-index: 99;
		  background-size: 14px 14px;
		  width: 14px;
		  height: 14px;
		  top: 1px;
		  left: 1px;
		  color: #000;
		}
	</style>

    <c:MA />
 
	<!--<script src="{!resourceLocator.path}/MACheckIn.js"></script>-->
	<script type='text/javascript' src="{!URLFOR($Resource.MapAnythingJS, 'MALayers.js')}"></script>
    <script type='text/javascript' src="{!URLFOR($Resource.MapAnythingJS, 'MAKMLExportJS.js')}"></script>
    <script type='text/javascript' src="{!URLFOR($Resource.MapAnythingJS, 'MATutorial.js')}"></script>
    <script type='text/javascript' src="{!URLFOR($Resource.MapAnythingJS, 'MAContextMenu.js')}"></script>
    <!--<script type='text/javascript' src="{!URLFOR($Resource.MapAnythingJS, 'MATerritoryBuilder.js')}"></script>-->
	<script type='text/javascript' src="{!staticResourceLocators['MapAnythingJS'].path}/MATerritoryBuilder.js"></script>
    <script type='text/javascript' src="{!URLFOR($Resource.MapAnythingJS, 'MAFavoriteLocation.js')}"></script>
    <!-- <script type='text/javascript' src="{!URLFOR($Resource.MapAnythingJS, 'JSHelperFunctions.js')}"></script> -->
    <script type='text/javascript' src="{!staticResourceLocators['MapAnythingJS'].path}/JSHelperFunctions.js"></script>
    <script type='text/javascript' src="{!URLFOR($Resource.MapAnythingJS, 'mapanythingSearch.js')}"></script>
    <script type='text/javascript' src="{!URLFOR($Resource.MapAnythingJS, 'MADemographicLayer.js')}"></script>
    <script type='text/javascript' src="{!staticResourceLocators['MapAnythingJS'].path}/MAListView.js"></script>
    <!--<script type='text/javascript' src="{!URLFOR($Resource.MapAnythingJS, 'MAListView.js')}"></script>-->
    <script type='text/javascript' src="{!URLFOR($Resource.MapAnythingJS, 'MARecordProcessJS.js')}"></script>
    <script type='text/javascript' src="{!URLFOR($Resource.MapAnythingJS, 'MAShapeProcess.js')}"></script>
    <script type='text/javascript' src="{!URLFOR($Resource.MapAnythingJS, 'MAMarkerBuilder.js')}"></script>
    <script type='text/javascript' src="{!URLFOR($Resource.MapAnythingJS, 'JSActionFramework.js')}"></script>
    <script type='text/javascript' src="{!URLFOR($Resource.MapAnythingJS, 'MACheckIn.js')}"></script>
    <script type='text/javascript' src="{!URLFOR($Resource.MapAnythingJS, 'JSMapAnything.js')}"></script>
	<!--<script type='text/javascript' src="{!URLFOR($Resource.MapAnythingJS, 'MARoutes.js')}"></script>-->
	<script type='text/javascript' src="{!staticResourceLocators['MapAnythingJS'].path}/MARoutes.js"></script>

    <c:JSMapAnythingPlotting />
    <!-- <script type='text/javascript' src="{!URLFOR($Resource.MapAnythingJS, 'MapAnythingPlottingJS.js')}"></script> -->
    <script type='text/javascript' src="{!staticResourceLocators['MapAnythingJS'].path}/MapAnythingPlottingJS.js"></script>


    <apex:outputPanel layout="none" rendered="{!AllCheckin == 'true'}">
        <script>
            $(function () {
                //update our action framework to show buttons on tooltips
                var frameworkInt = setInterval(function () {
                    if(typeof(MAActionFramework) == 'object') {
                        clearInterval(frameworkInt);

                        try{
                            var actions = MAActionFramework.standardActions;
                            var checkInAction = actions['Check In'];
                            var checkOutAction = actions['Check Out'];

                            //update modes
                            var checkInActionModes = checkInAction.Modes || [];
                            checkInActionModes.push('Desktop');
                            var checkOutActionModes = checkOutAction.Modes || [];
                            checkOutActionModes.push('Desktop');
                        }
                        catch(e) {
                            MA.log('Unable to update check in/out settings',e);
                        }
                    }
                },500);
            });
        </script>

    </apex:outputPanel>


    <apex:outputPanel layout="none" rendered="{!CloudbiltAPIForceSFDCProxyEnabled == 'true'}">

        <script type='text/javascript'>
             $(function () {

                $.ajaxPrefilter(function( options, originalOptions, jqXHR ) {
                    // Modify options, control originalOptions, store jqXHR, etc
                    if (originalOptions.url.indexOf('https://product-api-prod.cloudbilt.com') > -1 && options.dataType != 'JSONP' && options.dataType != 'jsonp')
                    {
                        var type = options.type || '';
                        var originalURL = originalOptions.url;
                        if(type.toLowerCase() === 'get') {
                            //convert any data to a string for get...
                            var paramString = '';
                            if(originalOptions.data) {
                                paramString = $.param(originalOptions.data);
                            }

                            //check if orig url has params already...
                            if(originalURL.indexOf('?') > 0) {
                                if (paramString != '') {
                                    //append to end
                                    originalURL = originalURL + '&' + paramString;
                                }
                            }
                            else if(originalURL.indexOf('?') == -1) {
                                originalURL = originalURL + '?' + paramString;
                            }
                            //add data to options...
                        }

                        options.url = location.protocol + "//" + location.hostname + "/services/proxy";
                        options.timeout = 30000;

                        if ( !options.beforeSend)
                        {
                            options.beforeSend = function (xhr) {
                                jqXHR.setRequestHeader('SalesforceProxy-Endpoint', originalURL);
                                jqXHR.setRequestHeader('Authorization', 'OAuth ' + MA.SessionId);
                                jqXHR.setRequestHeader('X-User_Agent', 'salesforce-toolkit-rest-javascript/v31.0');
                            };
                        }
                    }
                    else if (originalOptions.url.indexOf('arcgis.com') > -1 && options.type != 'GET' && options.type != 'get')
                    {
                        options.url = location.protocol + "//" + location.hostname + "/services/proxy";
                        if ( !options.beforeSend)
                        {
                            options.beforeSend = function (xhr) {
                                jqXHR.setRequestHeader('SalesforceProxy-Endpoint', originalOptions.url);
                                jqXHR.setRequestHeader('Authorization', 'OAuth ' + MA.SessionId);
                                jqXHR.setRequestHeader('X-User_Agent', 'salesforce-toolkit-rest-javascript/v31.0');
                            };
                        }
                    }

                });

            });
        </script>

    </apex:outputPanel>


    <apex:outputPanel layout="none" rendered="{! $User.UIThemeDisplayed == 'Theme4d' }">
        <script type='text/javascript'>
            $.ajaxSetup({
                dataFilter: function (rawData,type)
                {
                    try
                    {

                        if (rawData != undefined  && rawData != '')
                        {
                            if (type === 'JSON' || type == 'JSONP' || type=='json' || type =='jsonp')
                            {
                                return rawData.replace(/<script.*?>.*?<\/script>/igm, '');
                            }
                        }
                    }
                    catch (ex)
                    {

                    }
                }
            });

            jQuery.ajaxSetup({
                dataFilter: function (rawData,type)
                {
                    try
                    {

                        if (rawData != undefined  && rawData != '')
                        {
                            if (type === 'JSON' || type == 'JSONP' || type=='json' || type =='jsonp')
                            {
                                return rawData.replace(/<script.*?>.*?<\/script>/igm, '');
                            }
                        }
                    }
                    catch (ex)
                    {

                    }
                }
            });

        </script>
    </apex:outputPanel>


    <script type='text/javascript'>


        var AJAXRequestDataType = '{!AJAXRequestDataType}';

        var pageSuffix = '{!pageSuffix}';
        var sitePrefix = '{!$Site.CurrentSiteUrl}'.substring(0, '{!$Site.CurrentSiteUrl}'.length - 1);
        var namespace = '{!namespace}';
        var LicenseType = '{!LicenseType}';
        var versionNumber = '{!versionNumber}';
        var currentState = '';
        var $currentStateGrowl;

        //grab salesforce user locale object
        var SFLocale = UserContext;
        var userLocale = SFLocale.locale;
        var dateFormat = SFLocale.dateFormat;
        var timeFormat = SFLocale.timeFormat;
        var dateTimeFormat = SFLocale.dateTimeFormat;

        //LinkedIn Vars
        var linkedInClusterer;
        var linkedInPeopleClusterer;
        var linkedInCompanyClusterer;
        //POI vars
        var poiMarkersArray = [];
        var isDesktopPage = true;

        //save variable
        var saveId = '';

        //display/delete variable
        var dontDisplay = false;



        $(function () {
            /******************************************
             *
             * SF is attempting to overwrite it's own
             * global var if user url hacks to a page
             *
             * resetting the var to undefined fixes this
             *
            *******************************************/
            try{
                Map = undefined;
            }
            catch(e){}

            $.support.cors = true;

            //prototype a 'isInCircle' method
            try{
                google.maps.Circle.prototype.contains = function(latLng) {
                  return this.getBounds().contains(latLng) && google.maps.geometry.spherical.computeDistanceBetween(this.getCenter(), latLng) <= this.getRadius();
                }
            }
            catch(e) {
                MA.log('could not create google circle prototype');
            }


            //beta testing for checking touch device google maps fix
            if(MASystem.User.isTouchDevice) {
                window.navigator.__defineGetter__('userAgent', function () {
                    return 'Mozilla/5.0 (iPad; CPU OS 9_1 like Mac OS X) AppleWebKit/601.1.46 (KHTML, like Gecko) Version/9.0 Mobile/13B143 Safari/601.1';
                });
            }

            MA.plottingRedo = true;

            //set interval for loading screen to check if everything has loaded
            var loadingInterval = setInterval(function () {
                //check spans for success class
                var spans = $('.MALoading span');
                for(var s = 0; s < spans.length; s++) {
                    var $span = $(spans[s]);
                    if(!$span.hasClass('success')) {
                        break;
                    }

                    clearInterval(loadingInterval);
                    $('.MALoading').fadeOut(1000);
                }
            }, 3000);

            //easter egg potential if time permits
            var timer = null;
            var easteregg = '';
            //$(document).keypress(function(e){
                 //  clearTimeout(timer);
                 //  easteregg = easteregg + e.keyCode;
                 //  timer = setTimeout(somethingAwesome, 500)
            //});

            /*function somethingAwesome() {
                if(easteregg == '1099711297110121116104105110103')//mapanything
                {
                    alert('mapanything');
                }
                else
                {
                    easteregg = '';
                }
            }*/

            //set up save date on change events
            $('#saveyear, #savemonth, #saveactiveusers').on('change', function() {
                var type = 'save';

                var routeFieldVal = $('#'+type+'activeusers-value').val();
                var routeFieldInfo = routeFieldVal.split(':');

                var lookupId = '';
                var lookupField = '';
                if(routeFieldInfo.length === 2) {
                    lookupId = routeFieldInfo[1];
                    lookupField = routeFieldInfo[0];
                }
                else {
                    //fallback to current user
                    lookupId = MASystem.User.Id;
                    lookupField = 'ownerid';
                }

                var processData = {
                    ajaxResource : 'MAWaypointAJAXResources',
                    action : 'getRoutes',
                    month       : $('#'+type+'month').val(),
                    year        : $('#'+type+'year').val(),
                    lookupId    : lookupId,
                    lookupField : lookupField
                };
                var $loadingRoutes = MAToastMessages.showLoading({message:MASystem.Labels.MA_Loading+'...',timeOut:0,extendedTimeOut:0});
                Visualforce.remoting.Manager.invokeAction(MARemoting.processAJAXRequest,
                    processData,
                    function(response, event){
                        MAToastMessages.hideMessage($loadingRoutes);
                        if(event.status) {
                            if(response.success) {
                                //build options
                                var options = {
                                    year    : $('#'+type+'year').val(),
                                    month   : $('#'+type+'month').val(),
                                    routes  : response.routes
                                };

                                //build Calendar
                                $('.calendar-wrapper').remove();
                                var calendarTemplate = createCalendar(options);
                                $(calendarTemplate).appendTo('.full-calendar');

                                //click textbox if available
                                $('.full-calendar-cell #newRoute').find('#savename').click();
                                setTimeout(function () {
                                    $('.full-calendar-cell #newRoute').find('#savename').focus().select();
                                }, 350);

                                //init slimScroll
                                $('.calendar-wrapper .full-calendar-cell').slimScroll({height:'65px', width:'107px', size: '2px'});

                                saveId = '';

                                //check if show or hide past routes
                                var hidePastRoutes = $('.js-show-past-routes').hasClass('active');
                                if(hidePastRoutes) {
                                    $('#routeCalendarTable .routes-row').each(function(){
                        				var dateString = $(this).attr('data-date');
                        				var inputTime = moment(dateString, 'YYYY-MM-DD');
                        				inputTime.set({ hour: 23, minute: 59 });
                        				var currentDate = moment();
                        				if( inputTime.isBefore(currentDate)){
                        					$(this).hide();
                        				}
                        			});
                                }
                                else {
                                    $('#routeCalendarTable .routes-row').each(function(){
                        				$(this).show();
    			                    });
                                }
                            }
                            else {
                                var errMsg = response.error || 'Unknown Error';
                                MAToastMessages.showError({message:'User Error',subMessage:errMsg,timeOut:0,extendedTimeOut:0,closeButton:true});
                            }
                        }
                        else
                        {
                            //there was a problem so just show an error message
                            var errMsg = event.message || 'Unknown Error';
                            MAToastMessages.showError({message:'User Error',subMessage:errMsg,timeOut:0,extendedTimeOut:0,closeButton:true});
                        }
                    },{buffer:false,escape:false}
                );
            });

            //grab saved routes and display on sidebar
            $('#routeyear, #routemonth, #routeactiveusers').on('change', function() {
                var type = 'route';
                var routeFieldVal = $('#routeactiveusers-value').val();
                var routeFieldInfo = routeFieldVal.split(':');
                var $loadingRoutes = MAToastMessages.showLoading({message:MASystem.Labels.MA_Loading+'...',timeOut:0,extendedTimeOut:0});
                var lookupId = '';
                var lookupField = '';
                if(routeFieldInfo.length === 2) {
                    lookupId = routeFieldInfo[1];
                    lookupField = routeFieldInfo[0];
                }
                else {
                    //fallback to owner
                    lookupId = MASystem.User.Id;
                    lookupField = 'ownerid';
                }

                var processData = {
                    ajaxResource : 'MAWaypointAJAXResources',
                    action : 'getRoutes',
                    month       : $('#routemonth').val(),
                    year        : $('#routeyear').val(),
                    lookupId    : lookupId,
                    lookupField : lookupField
                };

                Visualforce.remoting.Manager.invokeAction(MARemoting.processAJAXRequest,
                    processData,
                    function(response, event){
                        MAToastMessages.hideMessage($loadingRoutes);
                        if(event.status) {
                            if(response.success) {
                                var routes;
                                var days = daysInMonth($('#'+type+'month').val(), $('#'+type+'year').val());
                                $('#'+type+'CalendarTable').empty();

                                for(i = 1; i <= days; i++)
                                {
                                    routes = '';

                                    //START NEW
                                    if(response.routes[i]) {
                                        $.each(response.routes[i], function(index, route) {

                                            removeNamespace('{!namespace}', route.route);
                                            removeNamespace('{!namespace}', route.waypoints);

                                            var length = route.waypoints ? route.waypoints.length : 0;
                                            var startLocaction = route.waypoints.length > 0 ? route.waypoints[0].Name : '?';
                                            var endLocation = route.waypoints.length > 0 ? route.waypoints[length - 1].Name : '?';

                                            // MULTIDAY MODIFICATIONS - IF REQUIRED

                                            var $Row = $('#templates .routes-row').clone().removeClass('template');
                                            $Row.find('.routes-day').text(i);
                                            $Row.attr({'id': route.routeId, 'data-date' : route.route.Date__c});
                                            $Row.find('.routes-name').text(route.route.Name);
                                            $Row.find('.routes-start').text('From ' + htmlDecode(startLocaction) + ' to ' + htmlDecode(endLocation));
                                            $Row.find('.routes-total').text(length + ' stops');
                                            $Row.attr('onclick', 'if(dontDisplay) { dontDisplay = false; } else { MARoutes.displayRoute(this); return false; }');
                                            routes += '<div id="'+route.route.Id+'" data-name="'+route.route.Name+'" class="route'+(type == 'route' ? ' clickable removeable" onclick="if(dontDisplay) { dontDisplay = false; } else { MARoutes.displayRoute(this); return false; }"' : '"')+'>'+route.route.Name+(type == 'route' ? '<div class="deleteDiv" onclick="dontDisplay = true; deleteRouteConfirm(this); return false;"/>' : '')+'</div>';
                                            $('#routeCalendarTable').append($Row);


                                        });
                                    }
                                    //END NEW
                                }

                                var hidePastRoutes = $('.js-show-past-routes').hasClass('active');
                                if(hidePastRoutes) {
                                    $('#routeCalendarTable .routes-row').each(function(){
                        				var dateString = $(this).attr('data-date');
                        				var inputTime = moment(dateString, 'YYYY-MM-DD');
                        				inputTime.set({ hour: 23, minute: 59 });
                        				var currentDate = moment();
                        				if( inputTime.isBefore(currentDate)){
                        					$(this).hide();
                        				}
                        			});
                                }
                                else {
                                    $('#routeCalendarTable .routes-row').each(function(){
                        				$(this).show();
    			                    });
                                }

                            }
                            else {
                                var errMsg = response.error || 'Unknown Error';
                                MAToastMessages.showError({message:'User Error',subMessage:errMsg,timeOut:0,extendedTimeOut:0,closeButton:true});
                            }
                        }
                        else
                        {
                            //there was a problem so just show an error message
                            var errMsg = event.message || 'Unknown Error';
                            MAToastMessages.showError({message:'User Error',subMessage:errMsg,timeOut:0,extendedTimeOut:0,closeButton:true});
                        }

                        //resize to make sure dimensions are correct
                        $(window).resize();
                    },{buffer:false,escape:false}
                );
            });

            //set year options
            var today = new Date();
            var year = today.getFullYear();
            for(i = year + 2; i >= year - 5; i--)
            {
                $('#saveyear, #routeyear').append('<option value="'+i+'">'+i+'</option>');
            }

            //set the current date and user
            $('#savemonth, #routemonth').val(today.getMonth() + 1);
            $('#saveyear, #routeyear').val(year);
            $('#saveactiveusers-value, #routeactiveusers-value').val('sma__User__c:'+'{!userId}');
            $('#saveactiveusers, #routeactiveusers').val('User:' + $('input[type="hidden"][id$=":userName"]').val());

            //send a request to run quick queries on each base object in order to cache the tables
            var processData = {
                ajaxResource : 'MASavedQueryAJAXResources',
                action: 'runCacheQueries',
            };

            Visualforce.remoting.Manager.invokeAction(MARemoting.processAJAXRequest,
                processData,
                function(response, event){
                    //Debug('Cache queries completed');

                    //check on loading screen
                    $('.MALoading .saved-queries-loading').addClass('success');

                },{buffer:false,escape:false}
            );

            //put the current version number as the default entry in the settings menu and grab browser information
            $('#MASettings .setting-mapanything-version').html('<span class="glyphicon glyphicon-info-sign" aria-hidden="true"></span>' + '{!$Label.MA_Version}: ' + '{!versionNumber}');



            /********************************
            *   SideBar Formating and Setup
            ********************************/
            //Init slimScroll on sidebar
            $('#SQTree').slimScroll({size: '8px', distance: '0px'}).css({ 'overflow-x': 'auto' });
            $('#tabs-nav #routesCalendar').slimScroll({height:'auto',size: '8px', distance: '0px'}).css({ 'overflow-x': 'auto' });
            // the line below is getting called somewhere else. Need to modify as it's causing the new folder ui plotted tab to go off screen
            $('#PlottedQueriesTable').slimScroll({width:'350px', size: '8px', distance: '0px'}).css({ 'overflow-x': 'auto' });
            $('#Routing-Table').slimScroll({height:'auto', width:'350px', size: '8px', distance: '0px'}).css({'height': 'auto', 'overflow-x': 'auto'});
            $('#poiResults').slimScroll({height:'auto', size: '8px', distance: '0px'}).css({ 'overflow-x': 'auto' });
            //buildToggleDriveProfiles();
            /************************************
            *   Plotted Query Handlers
            ************************************/
            //handle clicking to group heatmaps
            $('#PlottedQueriesOptions-GroupHeatmaps').on('change', function () {

                //if there is a query loading or unloading, we can't do this
                if ($('.PlottedRowUnit.loading, .PlottedRowUnit.unloading').length > 0) {
                    $(this).attr('checked', !$(this).is(':checked'));
                    return false;
                }

                //show loading
                showLoading($('#PlottedQueriesWrapper'), 'Updating...');

                setTimeout(function () {

                    //rerender all heatmaps
                    var queryCount = 0;
                    $('#PlottedQueriesContainer .PlottedRowUnit').each(function () {
                        var $plottedQuery = $(this);
                        if ($plottedQuery.find('.renderButtons-button.heatmap').is('.on')) {
                            $plottedQuery.addClass('unloading');
                            //show loading icon
                            $plottedQuery.find('.queryIcon').hide();
                            $plottedQuery.find('.loading-icon').show();
                            queryCount++;
                            unrenderQuery($plottedQuery, 'Heatmap', function () {
                                $plottedQuery.removeClass('unloading').addClass('loading');
                                renderQuery($plottedQuery, 'Heatmap', function () {
                                    $plottedQuery.removeClass('loading');
                                    //show loading icon
                                    $plottedQuery.find('.queryIcon').show();
                                    $plottedQuery.find('.loading-icon').hide();
                                    queryCount--;
                                });
                            });
                        }
                    });

                    //set interval to check for completion
                    var interval = setInterval(function () {
                        if (queryCount == 0) {
                            clearInterval(interval);
                            hideMessage($('#PlottedQueriesWrapper'));
                        }
                    }, 100);
                });
            });

            //handle clicking to group clusters
            $('#PlottedQueriesOptions-GroupClusters').on('change', function (e) {

                //if there is a query loading or unloading, we can't do this
                if ($('.PlottedRowUnit.loading, .PlottedRowUnit.unloading').length > 0) {
                    $(this).attr('checked', !$(this).is(':checked'));
                    return false;
                }

                //show loading
                showLoading($('#PlottedQueriesWrapper'), 'Updating...');

                setTimeout(function () {

                    //rerender all clusters
                    var queryCount = 0;
                    $('#PlottedQueriesContainer .PlottedRowUnit').each(function () {
                        var $plottedQuery = $(this);
                        if ($plottedQuery.find('.renderButtons-button.cluster').is('.on')) {
                            $plottedQuery.addClass('unloading');
                            //show loading icon
                            $plottedQuery.find('.queryIcon').hide();
                            $plottedQuery.find('.loading-icon').show();
                            queryCount++;
                            unrenderQuery($plottedQuery, 'Cluster', function () {
                                $plottedQuery.removeClass('unloading').addClass('loading');
                                renderQuery($plottedQuery, 'Cluster', function () {
                                    $plottedQuery.removeClass('loading');
                                    //show loading icon
                                    $plottedQuery.find('.queryIcon').show();
                                    $plottedQuery.find('.loading-icon').hide();
                                    queryCount--;
                                });
                            });
                        }
                    });

                    //set interval to check for completion
                    var interval = setInterval(function () {
                        if (queryCount == 0) {
                            clearInterval(interval);
                            hideMessage($('#PlottedQueriesWrapper'));

                            //reload any popups that this may have affected
                            refreshPopups();
                        }
                    }, 100);

                });
            });

            //handle clicking on plotted query advanced options buttons
            $('#PlottedQueriesContainer').on('click', '.PlottedRowUnit .renderButtons-advanced', function (e) {

                //keep track of the plotted query for use when clicking advanced options
                var $plottedQuery = $(this).closest('.PlottedRowUnit');

                //render tooltip bubble
                var offset = $(this).offset();
                var offsetTop = (offset.top + $(this).outerWidth()) + 'px';
                var offsetLeft = offset.left + 'px';
                var $bubble = $('<div class="bubble top" />').html(
                    ($plottedQuery.data('markerMetadata').ColorAssignmentType == 'Dynamic-Order' ? '<div class="bubble-item">Animate Path</div>' : '') +
                    '<div class="bubble-item">Zoom to Query</div>' +
                    ($plottedQuery.data('savedQueryId') && $plottedQuery.data('permissions').Modify__c ? '<div class="bubble-item">Edit Query</div>' : '') +
                    ($plottedQuery.data('savedQueryId') ? '<div class="bubble-item">{!$Label.MA_Refresh_Query}</div>' : '')
                ).css({ top: offsetTop, left: offsetLeft }).appendTo('body');

                //handle clicking on advanced options
                $bubble.on('click', '.bubble-item:not(.disabled)', function () {

                    switch($(this).text())
                    {
                        case 'Animate Path':

                            function travel(coords)
                            {
                                //remove the current animation point
                                try {
                                    $plottedQuery.data('animationMarker').setMap(null);
                                }
                                catch (err) { }

                                //add the next animation point
                                if (coords.length > 0)
                                {
                                    var nextCoord = coords.splice(0, 1)[0];

                                    var iconSVG = '<svg width="12" height="12" xmlns="http://www.w3.org/2000/svg">' +
                                        '<circle opacity="0.8" fill="#006eff" cx="3" cy="3" r="6" id="svg_3" stroke="#ffffff" stroke-width="2"/>' +
                                        '</svg>';

                                    //create and return the marker
                                    var markerIcon = L.divIcon({
                                        className: 'animatepath-marker',
                                        iconSize: L.point(12, 12),
                                        iconAnchor: L.point(3, 3),
                                        html: iconSVG
                                    });
                                    var nextMarker = L.marker(nextCoord, { icon: markerIcon }).addTo(leafletMap);
                                    $plottedQuery.data('animationMarker', nextMarker);

                                    animate(nextMarker, function () {
                                        setTimeout(function () {
                                            travel(coords)
                                        }, 500);
                                    });
                                }
                            }
                            function animate(marker, callback)
                            {
                                callback();
                            }
                            travel($plottedQuery.data('orderedPolylineCoordinates').slice(0));

                        break;
                        case 'Zoom to Query':

                            ZoomToFit({ queries: [$plottedQuery] });

                        break;
                        case 'Edit Query':

                            launchQueryEditor(MA.resources.QueryBuilder+pageSuffix+'?q='+$plottedQuery.data('savedQueryId')+'&qi='+$plottedQuery.index());

                        break;
                        case 'Refresh Query':

                            refreshQuery($plottedQuery);

                        break;
                        default:

                        break;
                    }

                });

                e.stopPropagation();
            });

            //handle clearing bubbles when clicking anywhere (this should probably go somewhere else)
            $('body').on('click', function () {
                $('.bubble').remove();

            });

            //handle clicking query close buttons
            $('#PlottedQueriesContainer').on('click', '.PlottedRowUnit .btn-remove', function () {
                //remove the tab in the listview
                var $layer = $(this).closest('.PlottedRowUnit');
                if(!$layer.hasClass('DataLayer')) {
                    MAListView.RemoveTab($layer.attr('qid'));
                    MAPlotting.removeQuery($layer.addClass('unloading'));
                }
            });

            //hande clicking refresh visible area button
            $('#visibleAreaRefeshMap.ready').on('click',function() {
                //remove ready class until finished and update text
                $('#visibleAreaRefeshMap').removeClass('ready update button-dark').text('Refresh in this area').addClass('refreshing button-blue ion-android-refresh');
                $('#visibleAreaRefeshMap').text('Refreshing...');
                $('#PlottedQueriesContainer .visibleOnly').addClass('visibleLoading');

                //batch the visiblOnly queries
                var q = async.queue(function (options, callback) {
                    if(options.isDataLayer) {
                        var dlOptions = {};
                        MADemographicLayer.refreshDataLayer(options.pq,dlOptions,function(res) {
                            options.pq.removeClass('visibleLoading');
                            callback({success:true,data:options});
                        });
                    }
                    else {
                        MAPlotting.refreshQuery(options.pq).then(function(res) {
                            options.pq.removeClass('visibleLoading');
                            callback({success:true,data:options});
                        });
                    }
                });

                //loop over the visibleOnly queries and add to que
                $('.PlottedRowUnit.visibleOnly').each(function(i,row) {
                    var opt = {
                        pq : $(row),
                        isDataLayer : $(row).hasClass('DataLayer')
                    }
                    q.push(opt,function(res){});
                });

                q.drain = function(){
                    if($('#visibleAreaRefeshMap').hasClass('update')) {
                        $('#visibleAreaRefeshMap').removeClass('refreshing update').addClass('ready').text('Refresh in this area');
                    }
                    else {
                        //map has not moved show finished
                        $('#visibleAreaRefeshMap').removeClass('refreshing button-blue ion-android-refresh').addClass('button-dark finished').text('Done');

                        //wait 3 seconds then hide button
                        setTimeout(function() {
                            //if map has moved since we started this process just show the normal button
                            if($('#visibleAreaRefeshMap').hasClass('finished')) {
                                $('#visibleAreaRefeshMap').removeClass('visible update finished').addClass('ready');
                            }
                        },3000);
                    }
                }
            });

            //handle clicking a bad address link
            $('#PlottedQueriesContainer').on('click', '.PlottedRowUnit .plottinginfo-wrapper .link.geocode', function () {

                if(MA.plottingRedo) {
                    return;
                }

                //hide all missing addresses except for this query
                var savedQueryId = $(this).closest('.PlottedRowUnit').data('id');
                $('#MissingAddressesContent .missingaddresses-wrapper').each(function () {
                    if ($(this).attr('data-id') == savedQueryId) {
                        if ($(this).find('.toggle').text() == "{!$Label.MA_Show}") {
                            $(this).find('.toggle').click();
                        }
                    }
                    else if ($(this).find('.toggle').text() == "{!$Label.MA_Hide}") {
                        $(this).find('.toggle').click();
                    }
                });

                //show the missing address popup
                ShowAddressNotFoundPopup();
            });

            //handle clicking to show/hide the legend or empty legend rows
            $('#PlottedQueriesContainer').on('click', '.legend-showhide', function () {
                var $button = $(this);
                var $plottedQuery = $button.closest('.PlottedRowUnit');
                if ($button.find('.options-text').text() == "{!$Label.MA_Hide_Legend}") {
                    $button.find('.options-text').text("{!$Label.MA_Show_Legend}");
                    $button.find('.glyphicon').removeClass('glyphicon-triangle-top').addClass('glyphicon-triangle-bottom');
                    $plottedQuery.find('.legend, .legend-moreless').hide();
                }
                else {
                    $button.find('.options-text').text("{!$Label.MA_Hide_Legend}");
                    $button.find('.glyphicon').removeClass('glyphicon-triangle-bottom').addClass('glyphicon-triangle-top');
                    $plottedQuery.find('.legend').show();
                    if ($plottedQuery.find('.legend-row.empty').length > 0) {
                        $plottedQuery.find('.legend-moreless').show();
                    }
                }
            });
            $('#PlottedQueriesContainer').on('click', '.legend-moreless-text', function () {
                var $button = $(this);
                var $plottedQuery = $button.closest('.PlottedRowUnit');
                var queryData = $plottedQuery.data() || {};
                if(queryData.markerAssignmentType === 'Dynamic-multiField') {
                    handleDynamicMultifieldClick($plottedQuery,$button);
                    return;
                }
                if ($button.find('.moreless-text').text() == "{!$Label.MA_Show_All}") {
                    $button.find('.moreless-text').text("{!$Label.MA_Show_Less}");
                    $button.find('.MAIcon').removeClass('glyphicon-collapse-down').addClass('glyphicon-collapse-up');
                    $plottedQuery.find('.legend-row').show();
                    $plottedQuery.find('.legend-row-header').show();
                    $plottedQuery.find('.legend-row-header').addClass('sectionOpen').removeClass('sectionClosed');
                    $plottedQuery.find('.legend-row-header .rowDropIcon').addClass('ion-android-arrow-dropdown').removeClass('ion-android-arrow-dropup');
                }
                else {
                    $button.find('.moreless-text').text("{!$Label.MA_Show_All}");
                    $button.find('.MAIcon').removeClass('glyphicon-collapse-up').addClass('glyphicon-collapse-down');
                    $plottedQuery.find('.legend-row.empty').hide();
                    $plottedQuery.find('.legend-row-header.empty').hide();
                    $plottedQuery.find('.legend-row-header.empty').removeClass('sectionOpen').addClass('sectionClosed');
                    $plottedQuery.find('.legend-row-header.empty .rowDropIcon').removeClass('ion-android-arrow-dropdown').addClass('ion-android-arrow-dropup');
                }
            });

            $('#PlottedQueriesContainer').on('click', '.legend-moreless-checkbox', function () {
                var $button = $(this);
                var $plottedQuery = $button.closest('.PlottedRowUnit');
                var uncheckAll = $button.find('.iconWrapper').hasClass('checked');

                if(MA.plottingRedo) {
                    if($plottedQuery.hasClass('loading')) {
                        return;
                    }
                    //loop over rows to get all legendids
                    var isChecked = !uncheckAll;
                    var legendRows = $plottedQuery.find('.legend-row').not('.empty');
                    $button.find('.iconWrapper').removeClass('checked').addClass(' intermediate');
                    var qid = $plottedQuery.attr('qid');
                    //keep track of the rows being toggled
                    MAPlotting.legendRowSelections[qid] = MAPlotting.legendRowSelections[qid] || {};

                    for(var l = 0, len = legendRows.length; l < len; l++) {
                        var legendId = legendRows[l].getAttribute('data-id');
                        MAPlotting.legendRowSelections[qid][legendId] = isChecked

                    }
                    if(uncheckAll) {
                        //remove checkbox
                       $plottedQuery.find('.legend-row .legend-checkbox').prop('checked',false);
                       $plottedQuery.find('.legend-header-checkbox').removeClass('ion-minus-round ion-checkmark-round');
                    }
                    else {
                        //add checkbox
                       $plottedQuery.find('.legend-row .legend-checkbox').prop('checked',true);
                       $plottedQuery.find('.legend-header-checkbox').removeClass('ion-minus-round').addClass('ion-checkmark-round');
                    }
                    MAPlotting.toggleLegendRow({plottedQuery:$plottedQuery,rows: MAPlotting.legendRowSelections[qid]}, function () {
                        MAPlotting.updateQueryInfo($plottedQuery,function() {
                            //remove loading
                            $plottedQuery.removeClass('loading');
                            $plottedQuery.find('.queryIcon').show();
                            $plottedQuery.find('.queryLoader').hide();
                            delete MAPlotting.legendRowSelections[qid];
                            if(uncheckAll) {
                                $button.find('.iconWrapper').removeClass('checked intermediate');
                            }
                            else {
                                $button.find('.iconWrapper').removeClass('intermediate').addClass('checked');
                            }
                        });

                        MAListView.DrawTab({ layerId: $plottedQuery.attr('qid'), isSelectedTab: false, isExport: false });
                    });
                    return;
                }

                //show loading
                $plottedQuery.addClass('loading');
                $plottedQuery.find('.queryIcon').hide();
                $plottedQuery.find('.loading-icon').show();

                //get the legend
                var legendRows = $plottedQuery.find('.legend-row');

                if(legendRows.length == 0) {
                    //just update the checkbox to save time
                    //update the global checkbox
                    if(uncheckAll) {
                        $button.find('.iconWrapper').removeClass('checked intermediate');
                    }
                    else {
                        $button.find('.iconWrapper').removeClass('intermediate').addClass('checked');
                    }

                    $plottedQuery.removeClass('loading');
                    $plottedQuery.find('.queryIcon').show();
                    $plottedQuery.find('.loading-icon').hide();
                    return;
                }

                //let's batch the checkboxes 1 at a time (unrendering large amounts is browser intensive)
                var q = async.queue(function (processData, callback) {
                    //update checkbox for processing
                    if(processData.row.hasClass('empty')) {
                        callback();
                    }
                    else {
                        var $checkBox = processData.row.find('.legend-checkbox');
                        var options = {};
                        showHideMarkerRow($checkBox,options,function(){
                            callback();
                        });
                    }
                });

                //loop over records
                for(var i = 0; i < legendRows.length; i++){
                    var $row = $(legendRows[i]);

                    if(uncheckAll) {
                        $row.find('.legend-checkbox').removeAttr('checked');
                    }
                    else {
                        $row.find('.legend-checkbox').attr('checked','checked');
                    }
                    var processData = {
                        row : $row
                    }
                    q.push(processData,function(res){});
                }

                q.drain = function(){
                    //update the global checkbox
                    if(uncheckAll) {
                        $button.find('.iconWrapper').removeClass('checked intermediate');
                    }
                    else {
                        $button.find('.iconWrapper').removeClass('intermediate').addClass('checked');
                    }

                    $plottedQuery.removeClass('loading');
                    $plottedQuery.find('.queryIcon').show();
                    $plottedQuery.find('.loading-icon').hide();
                };
            });

            $('#PlottedQueriesContainer').on('click', '.legend-row', function () {
                var $row = $(this);
                var $checkbox = $row.find('.legend-checkbox');
                $checkbox.prop('checked',!$checkbox.prop('checked'));
                $checkbox.change();
            });

            //handle clicking on plotted query legend items
            $('#PlottedQueriesContainer').on('change', '.legend-checkbox', function () {
                var $legendCheckbox = $(this);
                var $legendRow = $legendCheckbox.closest('.legend-row');
                var $plottedQuery = $(this).closest('.PlottedRowUnit');

                //grab some basic info about this legend item
                var markerMetadata = $plottedQuery.data('markerMetadata');
                var invertProximity = $('#InvertProximityCheckbox').is(':checked');
                var queryProximityEnabled = ($plottedQuery.data('proximityOptions') && $plottedQuery.data('proximityOptions').enabled);
                var queryProximityHideMarkers = queryProximityEnabled && $plottedQuery.data('proximityOptions').hideMarkers;

                //update the global check box
                var legendRows = $plottedQuery.find('.legend-row');
                var activeRows = $plottedQuery.find('.legend-row .legend-checkbox:checked');
                var isChecked = $legendCheckbox.prop('checked');
                if($plottedQuery.hasClass('loading')) {
                    $legendRow.find('.legend-checkbox').prop('checked',!isChecked);
                    return;
                }
                if(activeRows.length == legendRows.length) {
                    $plottedQuery.find('.iconWrapper').removeClass('intermediate').addClass('checked');
                }
                else if(activeRows.length == 0) {
                    $plottedQuery.find('.iconWrapper').removeClass('intermediate checked');
                }
                else {
                    $plottedQuery.find('.iconWrapper').removeClass('checked').addClass('intermediate');
                }

                //check for a section and update that checkbox
                var sectionId = $legendRow.attr('data-sectionid') || '';
                var $sectionHeaderRow = $plottedQuery.find('.legend-row-header[data-sectionid="'+sectionId+'"]');
                var sectionRows = $plottedQuery.find('.legend-row[data-sectionid="'+sectionId+'"]');
                var activeSectionRows = $plottedQuery.find('.legend-row[data-sectionid="'+sectionId+'"] .legend-checkbox:checked');
                if(activeSectionRows.length === sectionRows.length) {
                    //checked
                    $sectionHeaderRow.find('.legend-header-checkbox').removeClass('ion-minus-round').addClass('ion-checkmark-round');
                }
                else if (activeSectionRows.length === 0) {
                    //unchecked
                    $sectionHeaderRow.find('.legend-header-checkbox').removeClass('ion-minus-round ion-checkmark-round');
                }
                else {
                    //intermediate
                    $sectionHeaderRow.find('.legend-header-checkbox').addClass('ion-minus-round').removeClass('ion-checkmark-round');
                }


                if(MA.plottingRedo) {
                    var legendId = $legendRow.attr('data-id');
                    var qid = $plottedQuery.attr('qid');
                    //keep track of the rows being toggled
                    MAPlotting.legendRowSelections[qid] = MAPlotting.legendRowSelections[qid] || {}
                    MAPlotting.legendRowSelections[qid][legendId] = isChecked

                    //check if we are waiting for a timeout
                    clearTimeout(MAPlotting.legendRowTimeout);
                    MAPlotting.legendRowTimeout = setTimeout(function() {
                        var options = {
                            plottedQuery : $plottedQuery,
                            rows : MAPlotting.legendRowSelections[qid]
                        }
                        MAPlotting.legendRowTimeout = null;
                        MAPlotting.toggleLegendRow(options, function () {
                            MAPlotting.updateQueryInfo($plottedQuery, function() {
                                //remove loading
                                $plottedQuery.removeClass('loading');
                                $plottedQuery.find('.queryIcon').show();
                                $plottedQuery.find('.queryLoader').hide();
                                delete MAPlotting.legendRowSelections[qid];
                            });

                            MAListView.DrawTab({ layerId: $plottedQuery.attr('qid'), isSelectedTab: false, isExport: false });
                        });
                    },500);
                    //
                    return;
                }

                //show loading
                $plottedQuery.addClass('loading');
                $plottedQuery.find('.queryIcon').hide();
                $plottedQuery.find('.loading-icon').show();

                //loop through all markers and build a list of those that need to be modified
                var clusterMarkers = [];
                var needToUpdateVisibility = false;
                $.each($plottedQuery.data('records'), function (index, record)
                {
                    //determine if our picklist value matches
                    var picklistValueMatches = record.legendRow && record.legendRow[0] == $legendRow[0];

                    //check this marker against all of our criteria to see if it should be added to the list
                    if ($legendCheckbox.is(':checked'))
                    {
                        //this record must have a marker (or prox circle), be hidden, match, and not violate any prox layers
                        if ((((record.marker && !record.isVisible) || (queryProximityEnabled && MA.Util.g(record, 'marker.maData.proximityCircle') && MA.Util.g(record, 'marker.maData.proximityCircle').getMap() == null)) || (record.clusterMarker && !record.isClustered) || (record.scatterMarker && !record.isScattered)) && picklistValueMatches)
                        {
                            //check for proximity if needed, otherwise just add this marker to the list
                            if (MA.Map.hitTestShapeMgr.hasShapes())
                            {
                                //loop through all prox objects to see if this marker falls inside or outside
                                var isInsideProxObject = MA.Map.hitTestShapeMgr.containsLatLng(record.marker.getPosition());
                                var hitTestGood = (!invertProximity && isInsideProxObject) || (invertProximity && !isInsideProxObject);

                                //add it to the list if needed
                                if ($plottedQuery.find('.renderButtons-button.markers').is('.on') && (hitTestGood || queryProximityEnabled)) {
                                    if (record.marker && !record.isVisible && !queryProximityHideMarkers) {
                                        record.isVisible = true;
                                        record.marker.setMap(MA.map);
                                    }
                                    if (queryProximityEnabled && MA.Util.g(record, 'marker.maData.proximityCircle') && MA.Util.g(record, 'marker.maData.proximityCircle').getMap() == null) {
                                        record.marker.maData.proximityCircle.setMap(MA.map);
                                        needToUpdateVisibility = true;
                                    }
                                }
                                if ($plottedQuery.find('.renderButtons-button.cluster').is('.on') && record.clusterMarker && !record.isClustered && hitTestGood) {
                                    record.isClustered = true;
                                    clusterMarkers.push(record.clusterMarker);
                                }
                                if ($plottedQuery.find('.renderButtons-button.scatter').is('.on') && record.scatterMarker && !record.isScattered && hitTestGood) {
                                    record.isScattered = true;
                                    record.scatterMarker.setMap(MA.map);
                                }
                            }
                            else
                            {
                                //add it to the list
                                if ($plottedQuery.find('.renderButtons-button.markers').is('.on')) {
                                    if (record.marker && !record.isVisible && !queryProximityHideMarkers) {
                                        record.isVisible = true;
                                        record.marker.setMap(MA.map);
                                    }
                                    if (queryProximityEnabled && MA.Util.g(record, 'marker.maData.proximityCircle') && MA.Util.g(record, 'marker.maData.proximityCircle').getMap() == null) {
                                        record.marker.maData.proximityCircle.setMap(MA.map);
                                        needToUpdateVisibility = true;
                                    }
                                }
                                if ($plottedQuery.find('.renderButtons-button.cluster').is('.on') && record.clusterMarker && !record.isClustered) {
                                    record.isClustered = true;
                                    clusterMarkers.push(record.clusterMarker);
                                }
                                if ($plottedQuery.find('.renderButtons-button.scatter').is('.on') && record.scatterMarker && !record.isScattered) {
                                    record.isScattered = true;
                                    record.scatterMarker.setMap(MA.map);
                                }
                            }
                        }
                    }
                    else
                    {
                        //this record must have a marker, be visible, and match
                        if ($plottedQuery.find('.renderButtons-button.markers').is('.on') && picklistValueMatches) {
                            if (record.marker && record.isVisible) {
                                record.isVisible = false;
                                record.marker.setMap(null);
                            }
                            if (queryProximityEnabled && MA.Util.g(record, 'marker.maData.proximityCircle') && MA.Util.g(record, 'marker.maData.proximityCircle').getMap() != null) {
                                record.marker.maData.proximityCircle.setMap(null);
                                needToUpdateVisibility = true;
                            }
                        }
                        if ($plottedQuery.find('.renderButtons-button.cluster').is('.on') && record.clusterMarker && record.isClustered && picklistValueMatches) {
                            record.isClustered = false;
                            clusterMarkers.push(record.clusterMarker);
                        }
                        if ($plottedQuery.find('.renderButtons-button.scatter').is('.on') && record.scatterMarker && record.isScattered && picklistValueMatches) {
                            record.isScattered = false;
                            record.scatterMarker.setMap(null);
                        }
                    }

                });

                //show/hide our cluster markers (this is done separately because the clusterer supports mass add/remove)
                if ($legendCheckbox.is(':checked') && $plottedQuery.find('.renderButtons-button.cluster').is('.on')) {
                    $plottedQuery.data('clusterGroup').addMarkers(clusterMarkers);
                }
                else if ($plottedQuery.find('.renderButtons-button.cluster').is('.on')) {
                    $plottedQuery.data('clusterGroup').removeMarkers(clusterMarkers);
                }

                //reload any popups that this may have affected
                refreshPopups({ removeOnly: true });

                //refresh listview
                MAListView.DrawTab({ layerId: $plottedQuery.data('qid'), isSelectedTab: false, isExport: false });

                //update legend info
                updateQueryInfo($plottedQuery);

                //hide loading
                $plottedQuery.removeClass('loading');
                $plottedQuery.find('.queryIcon').show();
                $plottedQuery.find('.loading-icon').hide();

                //update marker visibility if needed
                if (needToUpdateVisibility) {
                    ChangeVisibilityWhenCircleIsAdded();
                }
            });

            /*****************
             *  Prox Layer Handlers
             ******************/
            //handle saving a prox layer
            $('#PlottedQueriesTable').on('click', '.proximity.layer .js-saveKML', function () {
                //grab the id
                var $proxLayer = $(this).closest('.proximity.layer');
                var kmlId = $proxLayer.find('.options-kml-document').val();

                if(kmlId == undefined || kmlId == '') {
                    MAToastMessages.showWarning({message:'Save Error',subMessage:'Please select a kml before saving.',timeOut:5000});
                    return;
                }
                //show save shape popup
                MACustomShapes.openPopupSidebar({isKML:true,id:kmlId});
            });


            //handle toggling prox layer options
            $('#PlottedQueriesTable').on('click', '.proximity.layer .link.showoptions', function () {
                var $button = $(this);
                var $proxLayer = $button.closest('.proximity.layer');
                var proxType = $proxLayer.find('.proximitytype').val();
                if ($button.find('.options-text').text() == "{!$Label.MA_Show_Options}") {
                    $proxLayer.find('.js-hideOptions').removeClass('hidden');
                    $button.addClass('hideStyle').removeClass('showStyle');
                    //$button.find('.glyphicon').removeClass('glyphicon-triangle-bottom').addClass('glyphicon-triangle-top');
                    $button.find('.options-text').text("{!$Label.MA_Hide_Options}");
                }
                else {
                    $proxLayer.find('.js-hideOptions').addClass('hidden');
                    $button.addClass('showStyle').removeClass('hideStyle');
                    //$button.find('.glyphicon').removeClass('glyphicon-triangle-top').addClass('glyphicon-triangle-bottom');*/
                    $button.find('.options-text').text("{!$Label.MA_Show_Options}");
                }

                if(proxType != 'travelTime') {
                    $proxLayer.find('.plotted-boundary-traffic-table').addClass('hidden');
                }
            });

            $('#PlottedQueriesTable').on('change', '.js-address-input', function() {
                $(this).data('lat', null);
                $(this).data('lng', null);
                $(this).data('address', null);
            });

            // handle clicking/selecting of proximity mode - bike/walk/car
            $('#PlottedQueriesTable').on('click', '.proximity-mode > div', function() {
                $(this).siblings().removeClass('selected');
                $(this).addClass('selected');
            });

            //handle selecting a different isoline unit type
            $('#PlottedQueriesTable').on('change', '.proximity.layer .options-isoline-unit-type', function () {
                if ($(this).val() == 'Distance') {
                    $(this).closest('.proximity.layer').find('.options-isoline-unit').html('').append("<option value='MILES'>Miles</option><option value='KM'>Km</option><option value='METERS'>Meters</option><option value='YARDS'>Yards</option><option value='FEET'>Feet</option>");
                }
                else {
                    $(this).closest('.proximity.layer').find('.options-isoline-unit').html('').append("<option value='MINUTES'>Minutes</option><option value='HOURS'>Hours</option>");
                }
            });

            //handle updating the prox options
            $('#PlottedQueriesTable').on('click', '.proximity.layer .js-updateShape', function () {
                renderProximityLayer($(this).closest('.proximity.layer'));
            });

            //handle removing a prox layer
            $('#PlottedQueriesTable').on('click', '.proximity.layer .btn-remove', function () {
                //removes the tab
                MAListView.RemoveTab($(this).closest('.proximity.layer').attr('qid'));

                removeProximityLayer($(this).closest('.proximity.layer'));
            });


            /********************************
             *  LinkedIn Event Handlers
             ***********************************/

            //if ('{!socialIntegrationEnabled}' == 'true')
            if (false) //removing linkedin integration due to api restrictions.
            {
                $('#LinkedInButton').show();
                if (MA.SitePrefix != '') {
                    $('.bottomworkspace-pane[data-pane="LinkedIn"]').html("<div>LinkedIn integration is not currently supported in custom domains (includes communities)</div>");
                }
                else {
                    $('.menubutton.social').on('change', '.linkedin-myconnections', function () {
                        if ($(this).is(':checked')) {
                            $('.linkedin-myconnections').hide();
                            $('.linkedin-myconnections-loader').show();
                            LinkedIn_ShowMyConnections();
                        }
                        else {
                            try { linkedInClusterer.clearMarkers(); linkedInClusterer.setMap(null); } catch (err) { }
                        }
                    });

                    $('.menubutton.social').on('change', '.linkedin-search', function () {
                        if ($(this).is(':checked')) {
                            $('.linkedin-filters-wrapper').show();
                        }
                        else {
                            $('.linkedin-filters-wrapper').hide();
                            try { linkedInPeopleClusterer.clearMarkers(); linkedInPeopleClusterer.setMap(null); } catch (err) { }
                        }
                    });

                    $('.menubutton.social').on('change', '.linkedin-companysearch', function () {
                        if ($(this).is(':checked')) {
                            $('.linkedin-companyfilters-wrapper').show();
                        }
                        else {
                            $('.linkedin-companyfilters-wrapper').hide();
                            try { linkedInCompanyClusterer.clearMarkers(); linkedInCompanyClusterer.setMap(null); } catch (err) { }
                        }
                    });

                    $('.menubutton.social').on('click', '.linkedin-filters-wrapper .addfilter', function () {
                        $('#templates .linkedin-filter').clone().appendTo($('.linkedin-filters'));
                    });
                }
            }



	        /*************************
	        * Side Bar Functionality
	        *************************/

	        //Show-Hide tabs on click
	        $('#tabs-nav > ul > li').on('click', 'a', function()
			{
				var tabClass = $(this).attr('tab-toggle').toString();
				if($(this).hasClass('tab-open'))
				{//derek
					$('#tabs-nav').find('div[tab-toggle]').slideUp(200);
					$(this).removeClass('tab-open');
					$('#sidebar').css('padding', 0);
				}
				else
				{
					$('#tabs-nav').find('div[tab-toggle="'+tabClass+'"]').slideDown(200);
					$('#tabs-nav > ul > li a').not($(this)).removeClass('tab-open');
					$(this).addClass('tab-open');
					$('#sidebar').css('padding', '0 0 15px 0');

					if(tabClass === 'plotted-tab') {
						var activeTab = $('#layer-tab-nav li.ui-state-active').attr('aria-controls');
						$('#'+activeTab+'').show();
					}
				}
			});

	        //POI tab results click
	        $('#searchPlacesQueryOutputBody').on('click', '.poi-row', function() {
	        	MA.map.panTo($(this).data('marker').getPosition());
	        	google.maps.event.trigger($(this).data('marker'), 'click');
	        });

	        //handle mousing over MapView overlay images
			$('td[data-label]').mouseover(function() {
				$(this).find('div').addClass('Hover');
			});
			$('td[data-label]').mouseout(function() {
				$(this).find('div').removeClass('Hover');
			});

			//handle mousing over Default View
			$('.DefaultViewOverlayTable .mapview-row').mouseover(function() {
				$(this).find('div').addClass('Hover');
			});
			$('.DefaultViewOverlayTable .mapview-row').mouseout(function() {
				$(this).find('div').removeClass('Hover');
			});

	        //IE9 fix for jscolor
	        jscolor.init();
	        
			MALayers.init();
			//handle favorites icon selection
			$('#FavoriteCreateLocation').on('click', '.location-markertype-selector img', function ()
			{
				var $icon = $(this);
				if ($icon.hasClass('location-markertype-selector-color'))
				{
					$('#FavoriteCreateLocation .location-markertype-color').show();
					$('#FavoriteCreateLocation .location-markertype-image').hide();
				}
				else
				{
					$('#FavoriteCreateLocation .location-markertype-color').hide();
					$('#FavoriteCreateLocation .location-markertype-image').show();
				}
			});
			
			$(document).on('click', '#baseObjectSelection tr', function ()
			{
				$(this).find('input[name="baseObject"]').prop('checked', true);
			});
			
			$('#PlottedQueriesTable').on('mouseenter', '.PlottedRowUnit.savedQuery', function (e)
			{
				MALayers.calcPlottedLayerInfo(this);
			});
			
			$('#PlottedQueriesTable').on('mouseenter', '.PlottedRowUnit.DataLayer', function (e)
			{
				MALayers.calcPlottedLayerInfo(this);
			});
			
			$('#PlottedQueriesTable').on('mouseenter', '.FavoriteRowUnit', function (e)
			{
				MALayers.calcPlottedLayerInfo(this);
			});
			
			$('#PlottedQueriesTable').on('mouseenter', '.PlottedShapeLayer', function (e)
			{
				MALayers.calcPlottedLayerInfo(this);
			});
			
			// Set folder item tooltip hover position
			$('#sidebar-content').on('mouseenter', '.ftu-unit-left', function (e)
			{
				//handle tooltip
				var folderitemTooltip = $(this).children('.ftu-tooltip');
				var folderitemTooltipOffsetTop = $(this).offset().top;
				var folderitemTooltipOffsetLeft = $(this).offset().left;
				var folderitemTooltipHeight = folderitemTooltip.height();
				var mapHeight = $('#mapdiv').height();
				var mapOffset = $('#mapdiv').offset().top;
				// sum dropdown height and offset
				var ftuTotal = folderitemTooltipOffsetTop + folderitemTooltipHeight - mapOffset;
				// get difference between dropdown/offset sum and mapheight
				var ftuDifference = ftuTotal - mapHeight;
			
			
				//if is offscreen
				if (ftuDifference > 0)
				{
					folderitemTooltip.css(
					{
						'top': folderitemTooltipOffsetTop - ftuDifference - 12 + 'px',
						'left': folderitemTooltipOffsetLeft + 365 + 'px'
					});
				}
				// if doesn't go offscreen
				else
				{
					folderitemTooltip.css(
					{
						'top': folderitemTooltipOffsetTop - 55 + 'px',
						'left': folderitemTooltipOffsetLeft + 365 + 'px'
					});
				}
			
				//handle arrow
				var folderitemTooltipArrowOffset = $(this).offset();
			
				$(this).children('.ftu-tooltip-arrow').css(
				{
					'top': folderitemTooltipArrowOffset.top + 6 + 'px',
					'left': folderitemTooltipArrowOffset.left + 355 + 'px'
				});
			});
			
			
			// set initial height of folder contents for overflow
			var basemapHeight = $('#mapdiv').height();
			var breadcrumbHeight = $('#folder-breadcrumb').height();
			var folderHeightCalc = basemapHeight - breadcrumbHeight - 205 + 'px';
			$('#folder-contents').css('max-height', folderHeightCalc);
			
			
			
			//can the user export things? if not, get rid of the KML export button
			$('#layer-tab-nav-plotted').on('click', function ()
			{
				//requires page refresh anyway, so no issue here
				if (userSettings.maxExportSize <= 0)
				{
					$('#kml-export-action').remove();
				}
			});

        }); //end onready



        function drawStates(states, options)
        {
            options = $.extend({
                complete: function () {}
            }, options || {});

            var allBoundaries = $.map(states, function (state, index) { return 'USA-'+state; });
            var boundaryRequest = 0;
            while(allBoundaries.length > 0)
            {
                boundaryRequest++;
                var boundariesBatch = allBoundaries.splice(0,5);

                //grab data using geoJSON
                GetDataFromServer({
                    url: 'https://product-api-prod.cloudbilt.com/geometry/pindexv2.php',
                    data: {
                        APIKey  : MA.APIKey,
                        country : 'USA',
                        ids     : boundariesBatch.join(',')
                    },
                    layer: options.proxLayer
                }).then(function(res) {
				    boundaryRequest--;
				});
            }

            //set an interval to wait for completion
            var interval = setInterval(function () {
                if(boundaryRequest == 0) {
                    options.complete({ success: true });
                    clearInterval(interval);
                }
            }, 100);
        }

        function drawCounties(stateFips, countiesToDraw, options)
        {
            options = $.extend({
                complete: function () {}
            }, options || {});

            var allBoundaries = $.map(countiesToDraw, function (countyFips, index) { return 'USA-2-'+stateFips+countyFips; });
            var boundaryRequest = 0;
            while(allBoundaries.length > 0)
            {
                boundaryRequest++;
                var boundariesBatch = allBoundaries.splice(0,5);

                //grab data using geoJSON
                GetDataFromServer({
                    url: 'https://product-api-prod.cloudbilt.com/geometry/pindexv2.php',
                    data: {
                        APIKey  : MA.APIKey,
                        country : 'USA',
                        ids     : boundariesBatch.join(',')
                    },
                    layer: options.proxLayer
                }).then(function(res) {
				    boundaryRequest--;
				});
            }

            //set an interval to wait for completion
            var interval = setInterval(function () {
                if(boundaryRequest == 0) {
                    options.complete({ success: true });
                    clearInterval(interval);
                }
            }, 100);
        }

        function drawZips(zipsToDraw, options)
        {
            options = $.extend({
                complete: function () {}
            }, options || {});

            var allBoundaries = $.map(zipsToDraw, function (zip, index) { return 'USA-'+zip; });
            var boundaryRequest = 0;
            while(allBoundaries.length > 0)
            {
                boundaryRequest++;
                var boundariesBatch = allBoundaries.splice(0,5);

                //grab data using geoJSON
                GetDataFromServer({
                    url: 'https://product-api-prod.cloudbilt.com/geometry/pindexv2.php',
                    data: {
                        APIKey  : MA.APIKey,
                        country : 'USA',
                        ids     : boundariesBatch.join(',')
                    },
                    layer: options.proxLayer
                }).then(function(res) {
				    boundaryRequest--;
				});
            }

            //set an interval to wait for completion
            var interval = setInterval(function () {
                if(boundaryRequest == 0) {
                    options.complete({ success: true });
                    clearInterval(interval);
                }
            }, 100);
        }

        function RemovePlotFavLocation()
        {
            $('#PlottedQueriesTable .FavoriteRowUnit').each(function (i,row){
                $(row).find('.btn-remove').click();
            });
        }

        //handle clicking a favorite location marker
        function favLocation_Click()
        {
            var marker = this;
            //build the tooltip content for this location
            var $tooltipContent = $(
                '<div class="favlocation-tooltip-content" style="overflow: hidden;">' +
                    '<table>' +
                        '<tr>' +
                            // '<td>Name:</td>' +
                            '<td class="name info"></td>' +
                        '</tr>' +
                        '<tr>' +
                            // '<td>Address:</td>' +
                            '<td class="address info">' +
                                '<span class="ma-icon ma-icon-checkin slds-icon slds-icon--x-small"></span>' +
                            '</td>' +
                        '</tr>' +
                        '<tr>' +
                            // '<td>Description:</td>' +
                            '<td class="description info"></td>' +
                        '</tr>' +
                    '</table>' +
                    '<div class="layout-tooltip">' +
                        '<div class="buttonset-section-columns">' +
                            '<div class="buttoncolumn">' +
                                '<div class="actionbutton" data-action="Add to Trip">'+MASystem.Labels.MAActionFramework_Add_to_Trip+'</div>' +
                                '<div class="actionbutton" data-action="Set Proximity Center">'+MASystem.Labels.MAActionFramework_Set_Proximity_Center+'</div>' +
                            '</div>' +
                            '<div class="buttoncolumn">' +
                                '<div class="actionbutton" data-action="Remove Marker">'+MASystem.Labels.MAContext_Remove_Marker+'</div>' +
                                '<div class="actionbutton" data-action="Set Verified Location">'+MASystem.Labels.MAActionFramework_Set_Verified_Location+'</div>' +
                            '</div>' +
                            '<div class="buttoncolumn">' +
                                '<div class="actionbutton" data-type="Standard Action" data-action="Set Reference Point">Set Reference Point</div>' +
                            '</div>' +
                        '</div>' +
                    '</div>' +
                '</div>'
            );
            $tooltipContent.find('.name').text(marker.title);
            $tooltipContent.find('.address').text(marker.record.markerAddress);
            $tooltipContent.find('.description').text(marker.description);

            //create popup
            MA.Map.InfoBubble.show({
                position: marker.getPosition(),
                anchor: marker,
                minWidth: 260,
                content: $tooltipContent.get(0)
            });

            //handle clicking action buttons
            $tooltipContent.find('.actionbutton').click(function () {
                var data_action = $(this).attr('data-action');
                console.log(data_action);
                switch (data_action)
                {
                    case 'Add to Trip':
                        AddMarkerToTrip(marker);
                        ShowDirectionsTab();
                        MA.Map.InfoBubble.hide();
                        break;
                    case 'Set Proximity Center':
                        var proximityType = getProperty(userSettings || {}, 'defaultProximitySettings.DefaultProximityType', false) || 'Circle';
                        addProximityLayer({ proximityType: proximityType, latitude: marker.getPosition().lat(), longitude: marker.getPosition().lng() });
                        break;
                    case 'Set Verified Location':
                        var newOptions = {
                            favorites: [marker]
                        };
                        MAActionFramework.standardActions['Set Verified Location'].ActionValue(newOptions);
                        break;
                    case 'Remove Marker':
                        marker.setMap(null);
                        var favorites = [];
                        var removeIndex = marker.removeIndex;
                        $('#PlottedQueriesTable .FavoriteRowUnit').each(function (i,row){
                            if($(row).attr('data-id') == removeIndex) {
                                $(row).find('.btn-remove').click();
                            }
                        });
                        break;
                    case 'Set Reference Point':
                        var newOptions = {
                            records: [],
                            favorites: [],
                            customMarkers: []
                        };

                        newOptions.records.push({ formattedMarkerAddress: marker.record.markerAddress, latLng: marker.position });

                        MAActionFramework.standardActions['Set Reference Point'].ActionValue(newOptions);
                        break;
                }
                MA.Map.InfoBubble.hide();

                //stop the click from getting to the map
                //e.stopPropagation();
            });
        }

        /********************************
        *   Workspaces
        ********************************/

        function BottomWorkspace_Show(options)
        {
            //default options
            options = $.extend({
                title: '',
                pane: ''
            }, options);

            //set the width to the width of the map div minus some padding on the sides
            $('#bottomworkspace').width($('#mapdiv').outerWidth() - 16);

            //show the workspace
            if(options.title == 'Exports')
            {
                 $('#bottomworkspace .header').text('{!$Label.MA_EXPORTS}');
            }
            else
            {
                $('#bottomworkspace .header').text(options.title);
            }

            $('#bottomworkspace').addClass('loading').animate({bottom: '0px'}, 350, function () {
                try { options.success(); } catch (err) { }
            });

            //load the workspace content
            $('#bottomworkspace .bottomworkspace-pane').hide().filter('[data-pane="'+options.pane+'"]').show();
        }
        function BottomWorkspace_Hide(options)
        {
            $('#bottomworkspace').animate({bottom: '-'+($('#bottomworkspace').outerHeight() + 5)+'px'}, 350, function () {
                try { options.success(); } catch (err) { }
            });
        }

        /***********************************
        *   Search Box Functions
        **********************************/

        /***************
        * POI Search
        ***************/
        //store variable for paging purposes if map is moved
        var searchText;
        var distance;
        var lat;
        var lng;

        function removePOI ()
        {
            //remove previous markers and table info
            try
            {
                $.each(MA.Map.Search.markers || [], function (i, marker) {
                    marker.setMap(null);
                });
                MA.Map.Search.markers = [];
                MA.Map.InfoBubble.hide();
                $('#searchPlacesQueryOutputBody .poi-row').remove();
                removeGlobalSearchQueryResults();
            }
            catch (e)
            {
                //do nothing
            }
        }

        function poi_CreateRow(options)
        {
            options = $.extend({
                place: {}
            }, options);

            var $row = $('#templates .poi-row').removeClass('template').clone();
            $row.find('.poi-name').text(htmlDecode(options.place.name));
            $row.find('.poi-address').text(options.place.formatted_address || '');
            $row.find('.poi-phone').text(options.place.formatted_phone_number || '');
            $row.find('.poi-image').attr('src', options.place.icon);
            $row.data('marker', options.marker);
            return $row;
        }

        /*********************************
        * Legacy (for custom components)
        *********************************/
        function HideBubbles() { MA.Map.InfoBubble.hide(); }

    </script>
    <!--<c:MAListView />-->

    <!--<c:JSMapAnythingPlotting />-->

    <!-- MA Plugins -->
    <!-- c:MATraffic -->
    <!-- JS -->

    <!-- Controller Communication -->
    <apex:form >
        <apex:inputHidden id="serializedDefaultQueries" value="{!serializedDefaultQueries}" />
        <apex:inputHidden id="serializedOptions" value="{!serializedOptions}" />
        <apex:inputHidden id="userName" value="{!userName}" />

        <apex:actionFunction name="PopulateMAExportsAF" reRender="MAExportsRepeat,ExportPageMessages" action="{!PopulateMAExports}"/>
        <apex:actionFunction name="DeleteExportsAF" reRender="MAExportsRepeat,ExportPageMessages" action="{!DeleteExports}"/>
    </apex:form>

    <!-- Notifications - Top Banner -->
    <div id='notifications-topbanner'>
		<div id='notifications-topbanner-description'></div>
		<a id='notifications-topbanner-blogurl' href='#' target='_blank'>Learn More</a>
		<div id='notifications-topbanner-close' onclick="$('#notifications-topbanner').slideUp();">x</div>
	</div>

    <!-- Map Container -->
    <div id='mapcontainer'>

        <div class="toast-top-center" id="message-top-center-container">
			<div aria-live="polite" class="toast toast-info" style="display: block;">
				<div class="ma-icon ma-icon-info" style="float: left;font-size: 24px;line-height: 40px;margin-right: 15px;"></div>
				<div class="toast-title" style="margin-left: 40px;">Create a record from the map</div>
				<div class="toast-message" style="margin-left: 40px;">Drag the marker to the intended location and tap 'Create Record'</div>
				<div style="padding-top: 10px;width: 100%;text-align: center;">
					<button class="MAbutton button-silver" onclick="c2c.cancelMapC2C();" style="width: 40%;">{!$Label.MA_Cancel}</button>
					<button class="MAbutton button-silver" onclick="c2c.processMapC2C();" style="width: 40%;">Create Record</button>
				</div>
			</div>

		</div>


        <!-- Main Page Loading -->
        <div class="MALoading" style="width: 100%; color: #595959; background:#1468b6; position: absolute; top: 0; height: 100%; z-index: 100000;">
            <div style='margin-top: 50px; text-align: center;'>
                <img style="max-width: 550px;" src="{! URLFOR($Resource.MapAnything, 'MapAnything_logo_large.png') }" />
                <div class="loading">
                     <span class="success" style='display:none'></span>
                     <span class='saved-queries-loading'></span>
                     <span class='tree-loading success'></span>
                     <span class='base-object-loading'></span>
                     <span class='user-pref-loading'></span>
                     <span class='map-loading'></span>
                     <span class='success'></span>
                </div>
                <div class='error' style='display:none; padding-top: 20px; color:rgb(255, 87, 87); font-size:115%'>It seems things are taking longer than usual, please try a refresh...</div>
            </div>
        </div>

        <!-- Map -->
        <div id='mapdiv'></div>

	    <!-- Sidebar -->
        <div id="folderItem-template" style="display:none;">
            <div id="::ID::" data-id="::DATA_ID::" class="folderItem" nodetype="::NODETYPE::" type="::TYPE::" perm-create="::PERM-CREATE::" perm-delete="::PERM-DELETE::" perm-export="::PERM-EXPORT::" perm-modify="::PERM-MODIFY::" perm-read="::PERM-READ::" perm-setpermissions="::PERM-SETPERM::" >
                <div class="ftu-unit-left" action="::DEFAULTACTION::" onclick="MALayers.layerActionsClickHandler(this);" onmouseleave="MALayers.hideContextMenu(this);" oncontextmenu="MALayers.toggleContextMenu(this); return false;">
                    <div class="ftu-icon-left">
                        <div class="ftu-icon-icon inline" type="::TYPE::"></div>
                        <div class="ftu-plotonload"></div>
                    </div>
                    <div class="ftu-text inline layerName">::NAME::</div>
                    <div class="ftu-subline hidden">::PARENT-FOLDER::</div>

                    <div class="ftu-tooltip-arrow"></div>
                    <div class="ftu-tooltip">
                        <div class="ftu-tooltip-inner">
                            <div class="ftu-tooltip-pad">
                                <div class="ft-tooltip-title">::TOOLTIP-TITLE::</div>
                                <div class="ft-tooltip-desc">::TOOLTIP-DESC::</div>
                                <div class="ft-tooltip-baseob">
                                    <!--<b>Base object:</b> ::TOOLTIP-BASEOBJ::&nbsp;&bull;&nbsp;<span class="ft-tooltip-plotonload"><b>Plot On Load:</b> ::TOOLTIP-PLOTONLOAD::</span></div>-->
                                    <table>
                                        <tbody>
                                            <tr class="tooltip-row">
                                                <td class="label">
                                                    <b>Base object</b>
                                                </td>
                                                <td class="value">
                                                    ::TOOLTIP-BASEOBJ::
                                                </td>
                                            </tr>
                                            <tr class="tooltip-row ft-tooltip-plotonload">
                                                <td class="label">
                                                    <b>Plot On Load</b>
                                                </td>
                                                <td class="value">
                                                    ::TOOLTIP-PLOTONLOAD::
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                              <div class="ftu-tooltip-pad-gray">
                                  <table>
                                    <tbody>
                                        <tr class="tooltip-row">
                                            <td class="label">
                                                <b>Created</b>
                                            </td>
                                            <td class="value">
                                                ::TOOLTIP-CREATED::
                                            </td>
                                        </tr>
                                        <tr class="tooltip-row">
                                            <td class="label">
                                                <b>Last modified</b>
                                            </td>
                                            <td class="value">
                                                ::TOOLTIP-MODIFIED::
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div><!--ftu-tooltip-->

                </div><!--ftu-unit-left-wrap-->
                <div class="ftu-icon-right">
                    <div class="dropdown" onmouseenter="MALayers.toggleContextMenu(this);" onmouseleave="MALayers.hideContextMenu(this);">
                        <button id="dLabel" type="button" class="dropdown-hover" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            <span class="glyphicon glyphicon-option-vertical"></span>
                        </button>
                        <div class="dropdown-menu" onmouseleave="MALayers.toggleContextMenu(this);">
                            ::ACTIONS::

                        </div><!--dropdown-menu-->

                    </div>
                </div><!--ftu-icon-right-->
            </div>
        </div>

        <div id="noItem-template" style="display:none;">
            <div class="folderItem" >
                <div class="ftu-text inline noItem-placeholder">::NAME::</div>
            </div>
        </div>

		<div id='sidebar' class="ma-new-folders">

			<!-- create new marker layer base object popup -->
			<div style="display:none;">
				<!-- Clear Coordinates Popup -->
				<div id="SelectBaseObjectPopup" class="popup_block maPopup template SelectBaseObjectPopup" style='max-height: 100%;padding: 0;'>
					<div>
						<!-- Header -->
						<div class="maPopup-head ma-modal-header">
							<h3 class="maPopup-title ma-modal-title">MapAnything&trade; Base Objects</h3>
							<br/>
							<small>::BASE_OBJECT_TYPE::</small>
						</div>

						<div class="maPopup-body ma-modal-content" style="min-height: 100px; max-height: 400px;">
							<table style="padding: 0 5px; width:100%;" class="ma-table" id="baseObjectSelection" cellspacing="0"></table>
						</div>

						<!-- Buttons -->
						<div class='maPopup-footer slds-scope ma-modal-footer markerFooter' style='overflow: hidden;'>
							<button class='slds-button slds-button_neutral' onclick="ClosePopupWindow();">{!$Label.MA_Cancel}</button>
							<button class='slds-button slds-button_brand' data-layerSubType="::layerSubType::" onclick="MALayers.createMarkerLayer(this);" role="saveButton">Continue</button>
						</div>

						<!--<div class='maPopup-footer ma-modal-footer liveFooter' style='overflow: hidden; display:none;'>-->
						<!--    <button class='MAbutton button-silver' onclick="ClosePopupWindow();">{!$Label.MA_Cancel}</button>-->
						<!--    <button class='MAbutton button-blue' onclick="MALayers.createMarkerLayer(this);" role="saveButton">Continue</button>-->
						<!--</div>-->
					</div>
				</div>
			</div>

			<div class="slds-scope">
				<!-- confirmation modal for deleting a route -->
				<div id="deleteRouteConfirmationModal" role="dialog" tabindex="-1" class="slds-modal slds-modal--xx-small">
					<!--slds-fade-in-open-->
					<div class="slds-modal__container">
						<div class="slds-modal__header slds-modal__header--empty">
							<button class="slds-button slds-modal__close slds-button--icon-inverse js-close-this-slds-modal" title="Close">
		                      <span class="slds-button__icon slds-button__icon--large ma-icon ma-icon-close"></span>
		                  </button>
						</div>
						<div class="slds-modal__content slds-p-around--x-large">
							<h2 class="slds-text-heading--medium">Delete route?</h2>
						</div>
						<!-- Buttons -->
						<div class="slds-modal__footer">
							<button class='slds-button slds-button--neutral js-close-this-slds-modal'>{!$Label.MA_Cancel}</button>
							<button class='slds-button slds-button--brand js-close-this-slds-modal' onclick="deleteRouteV2();">Delete</button>
						</div>
					</div>
				</div>

				<!-- confirmation for discarding unsaved changes to active route when creating a new route -->
				<div id="discardUnsavedRouteChangesModal" role="dialog" tabindex="-1" class="slds-modal slds-modal--xx-small">
					<!--slds-fade-in-open-->
					<div class="slds-modal__container">
						<div class="slds-modal__header slds-modal__header--empty">
							<button class="slds-button slds-modal__close slds-button--icon-inverse js-close-this-slds-modal" title="Close">
		                      <span class="slds-button__icon slds-button__icon--large ma-icon ma-icon-close"></span>
		                  </button>
						</div>
						<div class="slds-modal__content slds-p-around--x-large">
							<h2 class="slds-text-heading--medium">Discard unsaved changes to active route?</h2>
						</div>
						<!-- Buttons -->
						<div class="slds-modal__footer">
							<button class='slds-button slds-button--neutral js-close-this-slds-modal'>{!$Label.MA_Cancel}</button>
							<button class='slds-button slds-button--brand js-close-this-slds-modal' onclick="ClearDirections();showSingleRoute();">Discard</button>
						</div>
					</div>
				</div>
			</div>
			<!--slds-scope-lds-->

			<div class="slds-scope lds">
				<div id="CreateNewArcGISWebMapPopup" role="dialog" tabindex="-1" class="slds-modal slds-modal--xxl">
					<!--slds-fade-in-open-->
					<div class="slds-modal__container">
						<div class="slds-modal__header">
							<button class="slds-button slds-modal__close slds-button--icon-inverse js-close-this-slds-modal" title="Close">
		                      <div class="slds-button__icon slds-button__icon--large">
		                          <div class="ma-icon ma-icon-close"></div>
		                      </div>
		                    <span class="slds-assistive-text">Close</span>
		                  </button>
							<h2 id="header43" class="slds-text-heading--medium">ArcGIS Layer</h2>
						</div>
						<div class="slds-modal__content flex-column slds-modal__content-has-navigation">
							<div class="flex-grow-1 flex-row">
								<div class="" style="width:220px;background-color:#FAFAFB;border-right:1px solid #d8dde6;">
									<nav class="slds-nav-vertical slds-nav-vertical_shade" aria-label="Sub page">
										<div class="slds-nav-vertical__section">
											<ul>
												<li class="slds-nav-vertical__item slds-is-active">
													<a href="javascript:void(0);" class="slds-nav-vertical__action" aria-describedby="entity-header" target-content="arcgisDetailsTab">
														Details
													</a>
												</li>
											</ul>
										</div>
									</nav>
								</div>
								<div class="flex-grow-1 slds-is-relative">
									<div id="arcgisDetailsTab" class="slds-navigation-content-area height-100percent slds-show">
										<div class="slds-p-around--large">
											<div class="slds-form slds-form--stacked max-width--320">
												<div class="slds-form-element">
													<label class="slds-form-element__label" for="Name"><abbr class="slds-required" title="required">*</abbr><span style="display:none" id="arcGISNameError">Layer must have a name.</span> Name</label>
													<div class="slds-form-element__control">
														<input type="text" name="Name" maxlength="80" size="15" class="slds-input" placeholder="Name your layer"></input>
													</div>
												</div>
												<div class="slds-form-element">
													<label class="slds-form-element__label" for="Description">Description</label>
													<div class="slds-form-element__control">
														<input type="text" name="Description" maxlength="255" size="15" class="slds-input" placeholder="Describe your layer"></input>
													</div>
												</div>
												<div class="slds-form-element slds-form-element--has-hover-tooltip">
													<label class="slds-form-element__label" for="WebMapURL"><abbr class="slds-required" title="required">*</abbr><span style="display:none" id="arcGISURLError">Layer must have a valid URL</span> ArcGIS WebMap URL</label>
													<div class="slds-form-element__control">
														<textarea id="arcGISWebMapPopupURLField" class="slds-textarea" placeholder="Paste your full ArcGIS Layer URL here" name="WebMapURL" size="30" rows="4"></textarea>
													</div>
													<div class="slds-popover slds-popover--tooltip slds-popover--positioned-right-input-width-field slds-nubbin--left-top" role="tooltip" aria-live="polite">
														<div class="slds-popover__body slds-text-longform">
															<p>Copy and paste the URL for your ArcGIS Layer from your web browser's address bar.</p>
														</div>
													</div>
												</div>
											</div>
										</div>
									</div>
									<div id="arcgisC2CSetupTab" class="slds-navigation-content-area slds-hide">
										<nav role="navigation" aria-label="Breadcrumbs" style="display:none">
											<ol class="slds-breadcrumb slds-list_horizontal slds-wrap slds-p-top_x-small slds-p-bottom_x-small">
												<li class="slds-breadcrumb__item slds-text-title_caps">
													<a href="javascript:void(0);"><span class="icon ma-icon-chevronleft"></span> Back</a>
												</li>

											</ol>
										</nav>
										<div class="slds-p-around--large">
											<div class="slds-text-heading_medium">Click2Create&trade; Setup <span class="slds-badge">Optional</span></div>
											<div class="slds-text-body_regular slds-m-top_small">Create Salesforce records by connecting your ArcGIS Layer using Click2Create&trade; templates.</div>
											<div class="new-arc-template-setup-container">
												<div id="arcButtonGroup">
													<button class="slds-button slds-button_brand slds-m-top_medium slds-m-bottom_medium" id="connectWebMap">
		                                                <span class="slds-button__icon--left ma-icon ma-icon-rotate"></span>Connect your Web Map
		                                            </button>
													<button id="arcConnectionSuccess" class="slds-button slds-m-top_medium slds-m-bottom_medium" style="display:none">
		                                                <span class="slds-button__icon--left ma-icon ma-icon-check"></span>Successful connection
		                                            </button>
													<button id="arcConnectionFail" class="slds-button slds-m-top_medium slds-m-bottom_medium" style="display:none">
		                                                <span class="slds-button__icon--left ma-icon ma-icon-ban"></span>Failed connection
		                                            </button>
												</div>
												<!--Input wrapper for click2create on a ArcGIS Layer-->
												<div class="arc-config-input-wrapper" style="display:none">

												</div>


												<div class="slds-p-bottom--x-large slds-p-top--x-small" id="fieldMappingsWrapper" style="display:none">
													<div class="slds-form-element">
														<label class="slds-form-element__label" for="">
		                            	          		    <abbr class="slds-required" title="required">*</abbr>
		                                	  				Field Mappings
		                            	  			    </label>
													</div>
												</div>
											</div>
											<div class="" id="webMapTemplateTable" style="display:none">
												<button class="slds-button slds-button_brand slds-m-top_medium slds-m-bottom_medium" id="newWebMapTemplate">
		                                            <span class="slds-button__icon--left ma-icon ma-icon-add"></span>Create new template
		                                        </button>
												<table class="slds-table slds-table_bordered slds-table_resizable-cols slds-table_cell-buffer">
													<thead>
														<tr class="slds-text-title_caps">
															<th scope="col" style="width:3.25rem;">
																<div class="slds-th__action">
																	<span class="slds-assistive-text">Delete</span>
																</div>
															</th>
															<th scope="col">
																<div class="slds-truncate" title="Web Map Layers">Web Map Layers</div>
															</th>
															<th scope="col">
																<div class="slds-truncate" title="Salesforce Object">Salesforce Object</div>
															</th>
															<th scope="col">
																<div class="slds-truncate" title="Record Type">Record Type</div>
															</th>
															<th scope="col">
																<div class="slds-truncate" title="Field Set">Record Type</div>
															</th>
															<th scope="col" style="width:3.25rem;">
																<div class="slds-th__action">
																	<span class="slds-assistive-text">Edit</span>
																</div>
															</th>
															<th scope="col" style="width:3.25rem;">
																<div class="slds-th__action">
																	<span class="slds-assistive-text">Delete</span>
																</div>
															</th>
														</tr>
													</thead>
													<tbody class="WebMapC2CTemplateRows"></tbody>
												</table>
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>

						<!-- Buttons -->
						<div class="slds-modal__footer">
							<button class='slds-button slds-button--neutral js-close-this-slds-modal' onclick="closeArcCreateWindow();">{!$Label.MA_Cancel}</button>
							<button class='slds-button slds-button--brand' onclick="MALayers.createArcGISWebMapLayer(this);" role="saveButton">Save</button>
						</div>
					</div>
				</div>
			</div>
			<!--slds-scope-lds-->

			<div class="slds-scope lds">
				<div id="sldsModalBackDrop" class="slds-backdrop"></div>
			</div>

			<!-- Sidebar Content -->
			<div id="sidebar-content">

				<!-- Sidebar Tabs -->
				<div id="tabs-nav" class="tabs-nav">

					<!-- Tab Handles -->
					<ul id="main-sidebar-nav">
						<li title="{!$Label.MA_Layers}"><a id='tabs-nav-plotted' tab-toggle='plotted-tab' href="#tab-plotted"><span class="main-nav-label"><span class="main-nav-icon"></span> {!$Label.MA_Layers}</span></a></li>
						<li title="{!$Label.MARoutes_Routes_Title}"><a id='tabs-nav-routes' tab-toggle='routes-tab' href="#tab-routes" onclick="$('#routeyear').change();"><span class="main-nav-label"><span class="main-nav-icon"></span> {!$Label.MARoutes_Routes_Title}</span></a></li>
						<li title="{!$Label.MA_Points_of_Interest}"><a id='tabs-nav-poi' tab-toggle='poi-tab' href="#tab-poi"><span class="main-nav-label"><span class="main-nav-icon"></span> POI</span></a></li>
					</ul>


					<!-- Layers Tab -->
					<div id="tab-plotted" tab-toggle="plotted-tab">

						<div class="folder-search-wrapper">
							<button id="folder-search-icon"><span class="glyphicon glyphicon-search"></span></button>
							<button id="folder-search-loading"><span class="MA2-loader"></span></button>
							<button id="folder-search-clear" onclick="MALayersSearch.clearSearch();"><span class="glyphicon glyphicon-remove"></span></button>
							<input type="text" id="foldersearchInput" placeholder="{!$Label.MA_Search_Layers}..." autocomplete="off" onkeyup="MALayersSearch.autoCompleteOnKeyUp(event,this);" onclick="MALayersSearch.autoCompleteOnClick(event,this);" />
						</div>
						<div class="folder-search-results-positioning">
							<div class="foldersearch-results" onmouseleave="MALayersSearch.hideResults();">
								<div class="foldersearch-wrap">
									<div id="foldersearch-results-contents" style="min-height:0 !important;">
										<div class="searchresults-placeholder">Type at least 2 characters to search</div>
									</div>
								</div>
							</div>
						</div>

						<div id="layer-tab-nav">
							<div id="folder-search-mask"></div>
							<ul>
								<li title="{!$Label.MA_Recent_Queries}"><a id="layer-tab-nav-recent" tab-toggle="recent-layer-tab" href="#layer-tab-recent" onclick="MALayers.loadRecent();">{!$Label.MA_Recent}</a></li>
								<li title="{!$Label.MA_Saved_Queries}">
									<a id="layer-tab-nav-folders" tab-toggle="folders-layer-tab" href="#layer-tab-folders">
										<!--Folders-->{!$Label.MA_Saved}</a>
								</li>
								<li title="{!$Label.MA_Plotted_Queries}"><a id="layer-tab-nav-plotted" tab-toggle="plotted-layer-tab" href="#layer-tab-plotted">{!$Label.MA_Plotted}</a></li>
							</ul>
							<div id="layer-tab-recent" tab-toggle="recent-layer-tab">
								<div id="recent-queries"></div>
							</div>
							<!--End layer-tab-recent-->

							<div id="layer-tab-folders" tab-toggle="folders-layer-tab">
								<div class="folder-breadcrumb-wrap">
									<div id="folder-breadcrumb"></div>

									<div class="dropdown dropdown-hover">
										<button class="ft-breadcrumb-button ft-breadcrumb-button-options" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
					                                                    <span class="glyphicon glyphicon-option-vertical"></span>
					                                                </button>
										<div class="dropdown-menu" id="folder-actions">

										</div>
									</div>
									<div class="dropdown dropdown-hover">
										<button class="ft-breadcrumb-button ft-breadcrumb-button-new" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
					                                                    <span class="glyphicon glyphicon-plus"></span>
					                                                </button>
										<div class="dropdown-menu create-actions" id="folder-create-actions">

										</div>
									</div>
									<div class="dropdown dropdown-hover">
										<button class="ft-breadcrumb-button ft-breadcrumb-button-filter" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
					                                                    <span class="glyphicon glyphicon-filter"></span>
					                                                </button>
										<div class="dropdown-menu">
											<div class="dropdown-header">Layer Type</div>
											<div class="drop-menu-item"><input type="checkbox" checked="checked" class="folder-filter-type" filter-type="folder" onclick="MALayers.filterChangeHandler();" />{!$Label.MA_Folders}</div>
											<div class="drop-menu-item"><input type="checkbox" checked="checked" class="folder-filter-type" filter-type="marker" onclick="MALayers.filterChangeHandler();" />{!$Label.MA_Marker}</div>

											<apex:outputPanel rendered="{!isLiveEnabled}">
												<div class="drop-menu-item"><input type="checkbox" checked="checked" class="folder-filter-type" filter-type="live" onclick="MALayers.filterChangeHandler();" />{!$Label.MA_Live_Layer}</div>
												<div class="drop-menu-item"><input type="checkbox" checked="checked" class="folder-filter-type" filter-type="live-device" onclick="MALayers.filterChangeHandler();" />{!$Label.MA_DEVICE_LAYER}</div>
												<div class="drop-menu-item"><input type="checkbox" checked="checked" class="folder-filter-type" filter-type="geofence" onclick="MALayers.filterChangeHandler();" />{!$Label.MA_Geofence_Layer}</div>
											</apex:outputPanel>
											<apex:outputPanel rendered="{!isMAArcGISEnabled}">
												<div class="drop-menu-item"><input type="checkbox" checked="checked" class="folder-filter-type" filter-type="arcgisonline" onclick="MALayers.filterChangeHandler();" />ArcGIS Web Map</div>
											</apex:outputPanel>
											<div class="drop-menu-item"><input type="checkbox" checked="checked" class="folder-filter-type" filter-type="datalayer" onclick="MALayers.filterChangeHandler();" />{!$Label.MA_Data_Layer}</div>
											<div class="drop-menu-item"><input type="checkbox" checked="checked" class="folder-filter-type" filter-type="shape" onclick="MALayers.filterChangeHandler();" />{!$Label.MA_SHAPE}</div>
											<div class="drop-menu-item"><input type="checkbox" checked="checked" class="folder-filter-type" filter-type="favorite" onclick="MALayers.filterChangeHandler();" />{!$Label.MA_Favorite_Locations}</div>
										</div>
									</div>
								</div>
								<!--folder-breadcrumb-wrap-->
								<div class="sidebar-clearfix"></div>

								<div id="folder-contents"></div>

							</div>
							<!--End layer-tab-folders-->

							<div id="layer-tab-plotted" tab-toggle="plotted-layer-tab">

								<div class="folder-breadcrumb-wrap">
									<div id="plottedInfo" style="display:none;"></div>
									<!-- Options -->
									<div class="dropdown dropdown-hover" style="padding: 0px;">
										<button class="ft-breadcrumb-button ft-breadcrumb-button-options" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
					                                            <span class="glyphicon glyphicon-option-vertical"></span>
					                                        </button>
										<div class="dropdown-menu" id="folder-actions">
											<div class="dropdown-header">{!$Label.MA_Options}</div>
											<div class="layer-action" action-type="plotted" onclick="addProximityLayer();">
												<div style="padding-left: 15px;" class="ftu-text inline">{!$Label.MA_Add_Boundary}</div>
											</div>
											<div class="layer-action" action-type="plotted" onclick="removeAllLayers();MAListView.Hide();MAListView.CloseListViewNoLayers(); return false;">
												<div style="padding-left: 15px;" class="ftu-text inline">{!$Label.MA_Remove_All_Layers}</div>
											</div>
											<div id="kml-export-action" class="layer-action" action-type="plotted" onclick="MAKMLExport.createKML();">
												<div style="padding-left: 15px;" class="ftu-text inline">Export all layers to KML</div>
											</div>
										</div>
									</div>
								</div>

								<div id="PlottedQueriesWrapper" style="display:block;float:left;margin:0;padding:0;position: relative;width:100%;">
									<!-- WaterMark for empty queries -->
									<div style='padding:0;' class='plotted-watermark MA2hidden MA2active'>
										<img class='sidebar-placeholder-icon' src="{!URLFOR($Resource.MapAnything, 'malayersv2/img/layers_watermark.svg')}" />
										<div class='sidebar-placeholder-text'>{!$Label.MA_Plotted_query_information_will_appear_here}</div>
									</div>
									<!-- Layers Container -->
									<div id="PlottedQueriesContainer" style="display:block;float:left;width:100%; padding:0;border-bottom-right-radius:3px;">
										<div id="PlottedQueriesTable" style='margin-top: 0; padding-top: 0;height:auto;max-height: 475px;'></div>
										<!-- Layer Buttons -->
										<div style='display:none; position: absolute;padding: 5px 10px;z-index:10;bottom: 0;width: 100%;max-width:350px;left: 0;background: #fff;box-sizing:border-box;border-bottom-right-radius: 3px;border-top:1px solid rgba(0,0,0,0.1);'>
											<a class="slds-button slds-button_brand" id="layerbutton-addproximitylayer" onclick="addProximityLayer();">{!$Label.MA_Add_Boundary}</a>
											<a title="{!$Label.MA_Remove_All_Layers}" onclick="removeAllLayers();MAListView.Hide();MAListView.CloseListViewNoLayers(); return false;" class="slds-button slds-button_neutral" style="float:right;" id="layerbutton-addproximitylayer">Remove all layers</a>
										</div>
									</div>



									<div id="TestMe" style="color:black;"></div>
								</div>
							</div>
							<!--End layer-tab-plotted-->
						</div>
					</div>

					<!-- Routes Tab -->
					<div id="tab-routes" tab-toggle="routes-tab" style='width:350px; padding-top: 15px;'>
						<c:MARoutes />
					</div>

					<!-- POI Tab -->
					<div style='margin-top: 15px; padding:0;' id="tab-poi" tab-toggle="poi-tab">
						<div style='padding:0; min-height: 100px;' class='loadmask-wrapper'>

							<!-- WaterMark for empty POI -->
							<div style='padding:0;' class='poi-watermark slds-scope'>
								<!--<div style='padding:0;' ><img class='sidebar-placeholder-icon' width="80" height="73" src="{!URLFOR($Resource.MapAnything, 'malayersv2/img/poi_watermark.svg')}" /></div>-->
								<!--<div class="sidebar-placeholder-text">{!$Label.MA_Poi_Info}</div>-->
								<div class="slds-notify_container--inline slds-p-around--large slds-text-align--center">
									<figure class="slds-m-bottom--large">
										<img class="notification-graphic--medium" src="{!URLFOR($Resource.MapAnythingJS, 'images/search-empty-state.svg')}" />
									</figure>
									<h4>No search results... yet.</h4>
									<p>{!$Label.MA_Poi_Info}<br/><br/>
										<button class="slds-button slds-button--brand" onclick="focusGlobalSearch()">Start a Search</button>
									</p>
								</div>
							</div>

							<div id="searchOutputWrap" style="display:none;" class="slds-scope flex-column">
								<div id="globalSearchQueryOutputSpinner" class="slds-spinner_container">
									<div role="status" class="slds-spinner slds-spinner--medium slds-spinner--brand">
										<span class="slds-assistive-text">Loading</span>
										<div class="slds-spinner__dot-a"></div>
										<div class="slds-spinner__dot-b"></div>
									</div>
								</div>
								<div id="searchOutputContentsWrap" class="flex-column" style="display:none;">
									<div id="searchPlacesQueryOutputHeader" class="slds-p-around--small">
										<div class="flex-row">
											<div class="flex-grow-1">
												<div class="slds-p-left--xx-small slds-p-top--x-small">
													<span class="search-query-label">Search: "<span class="search-query-value">first citizens bank</span>"</span>
												</div>
											</div>
											<div>
												<button onclick="removePOI();" class="slds-button slds-button--neutral js-remove-global-search-query-result">
					            					  <span class="slds-button__icon--left ma-icon ma-icon-close"></span>
					            					  Remove
					            				</button>
											</div>
										</div>
									</div>
									<div id="searchPlacesQueryOutputBody" class="flex-grow-1 slds-scrollable--y">
										<ul class="slds-has-dividers--bottom-space"></ul>
									</div>
								</div>
							</div>


						</div>

					</div>
					<!--End POI Tab-->

				</div>
				<!--tabs-->
			</div>
			<!--sidebar-content-->
		</div>
		<!--sidebar-->
        <!-- Sidebar Shadow -->
        <div id="left-shadow"></div>

        <!-- Main Buttons Top -->
        <div class='nav-buttons-wrapper'>
            <table>
                <tr>
                    <td style='box-shadow: 0 0 4px 1px rgba(0,0,0,0.45); background-color:#fff; border-radius: 3px; display: inline-block; white-space: nowrap; text-align: right; vertical-align: top; margin-left: 10px;'>
                        <div align="center" class='default-view top-row-button' style='border-top-left-radius: 3px; border-bottom-left-radius: 3px;'>
                            <img src="{!URLFOR($Resource.MapAnything, 'images/ui-icons/default-view.png')}" />
                            <div style='width: 0px; height: 0px; border-style: solid; border-width: 0 0 6px 6px; border-color: transparent transparent #95A2AD transparent; position: relative; left: 11px; bottom: 2px;'></div>
                            <div style='display:none; padding: 0 3px; top:38px;' class='menu'>
                                <table class="DefaultViewOverlayTable" style="width:150px;" cellpadding="0" cellspacing="5">
                                    <tr class='mapview-row'>
                                        <td style='padding: 5px;' id="SetAsHomeButton" onclick="SetDefaultMapLocation();">
                                            <div style='position: relative; top: 8px; width: 0px; height: 0px; border-style: solid; border-width: 3px 0 3px 6px; border-color: transparent transparent transparent #3685c5;'></div>
                                            <div style='position: relative; bottom: 2px; margin-left: 15px;'>{!$Label.MA_Set_as_Default_View}</div>
                                        </td>
                                    </tr>
                                    <tr class='mapview-row'>
                                        <td style='padding: 5px;' onclick="GoToHomePosition();">
                                            <div style='position: relative; top: 8px; width: 0px; height: 0px; border-style: solid; border-width: 3px 0 3px 6px; border-color: transparent transparent transparent #3685c5;'></div>
                                            <div style='position: relative; bottom: 2px; margin-left: 15px;'>{!$Label.MA_Move_to_Default_View}</div>
                                        </td>
                                    </tr>
                                </table>
                            </div>
                        </div>
                        <div align="center" title="{!$Label.MA_Zoom_To_Fit}" id="ZoomToFitButton" class='zoom-to-fit top-row-button'><img src="{!URLFOR($Resource.MapAnything, 'images/ui-icons/zoom-to-fit.png')}" /></div>
                        <div align="center" title="{!$Label.MA_My_Position}" id='ShowPositionButton' onclick="ShowHidePosition();" class='show-position top-row-button'><img src="{!URLFOR($Resource.MapAnything, 'images/ui-icons/mylocation.png')}" /></div>
                        <div align="center" title="{!$Label.MA_Traffic}" id="ShowTrafficButton" class='traffic top-row-button' onclick="showGoogleTrafficLayer(this);"><img src="{!URLFOR($Resource.MapAnything, 'images/ui-icons/traffic.png')}" /></div>
                        <div align="center" title="{!$Label.MA_Weather}" id="ShowWeatherButton" class='weather top-row-button'>
                            <img src="{!URLFOR($Resource.MapAnything, 'images/ui-icons/weather.png')}" />
                            <div style='width: 0px; height: 0px; border-style: solid; border-width: 0 0 6px 6px; border-color: transparent transparent #95A2AD transparent; position: relative; left: 11px; bottom: 2px;'></div>
                            <div style='display:none; width: 310px; padding: 0 3px; top:38px;' class='menu'>
                                <c:MAWeather />
                            </div>
                        </div>
                        <div align="center" title="{!$Label.MA_Demographics}" id="ShowDemographicsButton" style="display:none;" class='demographics top-row-button'>
                            <img src="{!URLFOR($Resource.MapAnything, 'images/ui-icons/MA-census-icon.png')}" />
                            <div style='width: 0px; height: 0px; border-style: solid; border-width: 0 0 6px 6px; border-color: transparent transparent #95A2AD transparent; position: relative; left: 11px; bottom: 2px;'></div>
                            <div style='display:none; width: 310px; padding: 10px 10px; top:38px;' class='menu'>
                                <c:MADemographics />
                            </div>
                        </div>
                        <div align="center" title="{!$Label.MA_Map_Types}" id="ShowMapView" class='mapview top-row-button' style='border-top-right-radius: 3px; border-bottom-right-radius: 3px;'>
                            <img src="{!URLFOR($Resource.MapAnything, 'images/ui-icons/map-view.png')}" />
                            <div style='width: 0px; height: 0px; border-style: solid; border-width: 0 0 6px 6px; border-color: transparent transparent #95A2AD transparent; position: relative; left: 11px; bottom: 2px;'></div>
                            <div class="menu" style='display:none; width: 225px;'>

                                <!-- Views -->
                                <table class="MapViewTable" style="width: 215px; top:38px;" cellpadding="0" cellspacing="5">
                                    <tr>
                                        <td data-basemaptype="roadmap" onclick="MA.Map.updateMapType('roadmap');">
                                            <div class="MapViewTitle Active">{!$Label.MA_ROADMAP}</div>
                                        </td>
                                        <td data-basemaptype="satellite" onclick="MA.Map.updateMapType('satellite');">
                                            <div class="MapViewTitle">{!$Label.MA_SATELITTE}</div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td data-basemaptype="hybrid" onclick="MA.Map.updateMapType('hybrid');">
                                            <div class="MapViewTitle">{!$Label.MA_HYBRID}</div>
                                        </td>
                                        <td data-basemaptype="terrain" onclick="MA.Map.updateMapType('terrain');">
                                            <div class="MapViewTitle">{!$Label.MA_TERRAIN}</div>
                                        </td>
                                    </tr>
                                </table>
                            </div>
                        </div>
                    </td>
                    <td style='box-shadow: 0 0 4px 1px rgba(0,0,0,0.45); background-color:#fff; border-radius: 3px; display: inline-block; white-space: nowrap; text-align: right; vertical-align: top; margin-left: 10px;'>
                        <div align="center" title="{!$Label.MA_Export}" id="ExportsButton" class='exports top-row-button' style='border-top-left-radius: 3px; border-bottom-left-radius: 3px;' onclick="BottomWorkspace_Show({ pane: 'Export', title: 'Exports' });">
                            <img src="{! URLFOR($Resource.MapAnything, 'images/ui-icons/export.png') }" />
                        </div>
                        <div align="center" title='LinkedIn' id="LinkedInButton" class='linkedin top-row-button'  style='display: none;'>
                            <!-- onclick="BottomWorkspace_Show({ pane: 'LinkedIn', title: 'LinkedIn' });" -->
                            <img src="{! URLFOR($Resource.MapAnything, 'images/ui-icons/BottomWorkspace_LinkedIn.png') }" />
                            <div style='width: 0px; height: 0px; border-style: solid; border-width: 0 0 6px 6px; border-color: transparent transparent #95A2AD transparent; position: relative; left: 11px; bottom: 2px;'></div>
                            <div style='display:none; min-width: 380px; top:38px; text-align:left;' class='menu persistent' id="linkedin-menu">
                               <div class="social">
                                    <script type="in/Login">

                                        <div class="linkedin-panel-wrapper">

                                        <table class="linkedin-panel-header">
                                            <tr>
                                                <td id="linkedin-loggedin-user-profile-picture" style="vertical-align:middle;"></td>
                                                <td id="linkedin-loggedin-user-name" style="vertical-align:middle;"></td>
                                            </tr>
                                        </table>

                                        <table class="linkedin-panel-body">
                                            <tr>
                                                <td class="linkedin-panel-searchtype">
                                                    <select id="linkedin-searchtype" onClick="LinkedIn_SearchTypeChanged(this);">
                                                        <option value="myconnections">My Connections</option>
                                                        <option value="companysearch">Company Search</option>
                                                    </select>
                                                </td>
                                                <td style="text-align: right;">

                                                </td>
                                            </tr>
                                            <tr id="linkedin-companysearch-filters" style="display:none;">
                                                <td>
                                                    <table class="linkedin-panel-companysearch-filters">
                                                        <tr>
                                                            <td><b>{!$Label.MA_Keywords}:</b></td>
                                                            <td><input type='text' class='linkedin-companysearch-keywords' id='linkedin-companysearch-keywords' /></td>
                                                        </tr>
                                                        <tr>
                                                            <td><b>Industry:</b></td>
                                                            <td>
                                                                <select id="linkedin-companysearch-industry">
                                                                    <option value="all">All</option>
                                                                    <option value="47">Accounting</option>
                                                                    <option value="94">Airlines/Aviation</option>
                                                                    <option value="120">Alternative Dispute Resolution</option>
                                                                    <option value="125">Alternative Medicine</option>
                                                                    <option value="127">Animation</option>
                                                                    <option value="19">Apparel & Fashion</option>
                                                                    <option value="50">Architecture & Planning</option>
                                                                    <option value="111">Arts and Crafts</option>
                                                                    <option value="53">Automotive</option>
                                                                    <option value="52">Aviation & Aerospace</option>
                                                                    <option value="41">Banking</option>
                                                                    <option value="12">Biotechnology</option>
                                                                    <option value="36">Broadcast Media</option>
                                                                    <option value="49">Building Materials</option>
                                                                    <option value="138">Business Supplies and Equipment</option>
                                                                    <option value="129">Capital Markets</option>
                                                                    <option value="54">Chemicals</option>
                                                                    <option value="90">Civic & Social Organization</option>
                                                                    <option value="51">Civil Engineering</option>
                                                                    <option value="128">Commercial Real Estate</option>
                                                                    <option value="118">Computer & Network Security</option>
                                                                    <option value="109">Computer Games</option>
                                                                    <option value="3">Computer Hardware</option>
                                                                    <option value="5">Computer Networking</option>
                                                                    <option value="4">Computer Software</option>
                                                                    <option value="48">Construction</option>
                                                                    <option value="24">Consumer Electronics</option>
                                                                    <option value="25">Consumer Goods</option>
                                                                    <option value="91">Consumer Services</option>
                                                                    <option value="18">Cosmetics</option>
                                                                    <option value="65">Dairy</option>
                                                                    <option value="1">Defense & Space</option>
                                                                    <option value="99">Design</option>
                                                                    <option value="69">Education Management</option>
                                                                    <option value="132">E-Learning</option>
                                                                    <option value="112">Electrical/Electronic Manufacturing</option>
                                                                    <option value="28">Entertainment</option>
                                                                    <option value="86">Environmental Services</option>
                                                                    <option value="110">Events Services</option>
                                                                    <option value="76">Executive Office</option>
                                                                    <option value="122">Facilities Services</option>
                                                                    <option value="63">Farming</option>
                                                                    <option value="43">Financial Services</option>
                                                                    <option value="38">Fine Art</option>
                                                                    <option value="66">Fishery</option>
                                                                    <option value="34">Food & Beverages</option>
                                                                    <option value="23">Food Production</option>
                                                                    <option value="101">Fund-Raising</option>
                                                                    <option value="26">Furniture</option>
                                                                    <option value="29">Gambling & Casinos</option>
                                                                    <option value="145">Glass, Ceramics & Concrete</option>
                                                                    <option value="75">Government Administration</option>
                                                                    <option value="148">Government Relations</option>
                                                                    <option value="140">Graphic Design</option>
                                                                    <option value="124">Health, Wellness and Fitness</option>
                                                                    <option value="68">Higher Education</option>
                                                                    <option value="14">Hospital & Health Care</option>
                                                                    <option value="31">Hospitality</option>
                                                                    <option value="137">Human Resources</option>
                                                                    <option value="134">Import and Export</option>
                                                                    <option value="88">Individual & Family Services</option>
                                                                    <option value="147">Industrial Automation</option>
                                                                    <option value="84">Information Services</option>
                                                                    <option value="96">Information Technology and Services</option>
                                                                    <option value="42">Insurance</option>
                                                                    <option value="74">International Affairs</option>
                                                                    <option value="141">International Trade and Development</option>
                                                                    <option value="6">Internet</option>
                                                                    <option value="45">Investment Banking</option>
                                                                    <option value="46">Investment Management</option>
                                                                    <option value="73">Judiciary</option>
                                                                    <option value="77">Law Enforcement</option>
                                                                    <option value="9">Law Practice</option>
                                                                    <option value="10">Legal Services</option>
                                                                    <option value="72">Legislative Office</option>
                                                                    <option value="30">Leisure, Travel & Tourism</option>
                                                                    <option value="85">Libraries</option>
                                                                    <option value="116">Logistics and Supply Chain</option>
                                                                    <option value="143">Luxury Goods & Jewelry</option>
                                                                    <option value="55">Machinery</option>
                                                                    <option value="11">Management Consulting</option>
                                                                    <option value="95">Maritime</option>
                                                                    <option value="97">Market Research</option>
                                                                    <option value="80">Marketing and Advertising</option>
                                                                    <option value="135">Mechanical or Industrial Engineering</option>
                                                                    <option value="126">Media Production</option>
                                                                    <option value="17">Medical Devices</option>
                                                                    <option value="13">Medical Practice</option>
                                                                    <option value="139">Mental Health Care</option>
                                                                    <option value="71">Military</option>
                                                                    <option value="56">Mining & Metals</option>
                                                                    <option value="35">Motion Pictures and Film</option>
                                                                    <option value="37">Museums and Institutions</option>
                                                                    <option value="115">Music</option>
                                                                    <option value="114">Nanotechnology</option>
                                                                    <option value="81">Newspapers</option>
                                                                    <option value="100">Non-Profit Organization Management</option>
                                                                    <option value="57">Oil & Energy</option>
                                                                    <option value="113">Online Media</option>
                                                                    <option value="123">Outsourcing/Offshoring</option>
                                                                    <option value="87">Package/Freight Delivery</option>
                                                                    <option value="146">Packaging and Containers</option>
                                                                    <option value="61">Paper & Forest Products</option>
                                                                    <option value="39">Performing Arts</option>
                                                                    <option value="15">Pharmaceuticals</option>
                                                                    <option value="131">Philanthropy</option>
                                                                    <option value="136">Photography</option>
                                                                    <option value="117">Plastics</option>
                                                                    <option value="107">Political Organization</option>
                                                                    <option value="67">Primary/Secondary Education</option>
                                                                    <option value="83">Printing</option>
                                                                    <option value="105">Professional Training & Coaching</option>
                                                                    <option value="102">Program Development</option>
                                                                    <option value="79">Public Policy</option>
                                                                    <option value="98">Public Relations and Communications</option>
                                                                    <option value="78">Public Safety</option>
                                                                    <option value="82">Publishing</option>
                                                                    <option value="62">Railroad Manufacture</option>
                                                                    <option value="64">Ranching</option>
                                                                    <option value="44">Real Estate</option>
                                                                    <option value="40">Recreational Facilities and Services</option>
                                                                    <option value="89">Religious Institutions</option>
                                                                    <option value="144">Renewables & Environment</option>
                                                                    <option value="70">Research</option>
                                                                    <option value="32">Restaurants</option>
                                                                    <option value="27">Retail</option>
                                                                    <option value="121">Security and Investigations</option>
                                                                    <option value="7">Semiconductors</option>
                                                                    <option value="58">Shipbuilding</option>
                                                                    <option value="20">Sporting Goods</option>
                                                                    <option value="33">Sports</option>
                                                                    <option value="104">Staffing and Recruiting</option>
                                                                    <option value="22">Supermarkets</option>
                                                                    <option value="8">Telecommunications</option>
                                                                    <option value="60">Textiles</option>
                                                                    <option value="130">Think Tanks</option>
                                                                    <option value="21">Tobacco</option>
                                                                    <option value="108">Translation and Localization</option>
                                                                    <option value="92">Transportation/Trucking/Railroad</option>
                                                                    <option value="59">Utilities</option>
                                                                    <option value="106">Venture Capital & Private Equity</option>
                                                                    <option value="16">Veterinary</option>
                                                                    <option value="93">Warehousing</option>
                                                                    <option value="133">Wholesale</option>
                                                                    <option value="142">Wine and Spirits</option>
                                                                    <option value="119">Wireless</option>
                                                                    <option value="103">Writing and Editing</option>
                                                                </select>
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <td><b>Size:</b></td>
                                                            <td>
                                                                <select id="linkedin-companysearch-size">
                                                                    <option value="all">All</option>
                                                                    <option value="B">1-10</option>
                                                                    <option value="C">11-50</option>
                                                                    <option value="D">51-200</option>
                                                                    <option value="E">201-500</option>
                                                                    <option value="F">501-1000</option>
                                                                    <option value="G">1001-5000</option>
                                                                    <option value="H">5001-10,000</option>
                                                                    <option value="I">10,000+</option>
                                                                </select>
                                                            </td>
                                                        </tr>
                                                    </table>
                                                </td>
                                                <td></td>
                                            </tr>
                                            <tr>
                                                <td>
                                                    <div id="linkedin-action-buttons">
                                                        <button id="LinkedIn_PlotResults_Button" onclick='LinkedIn_PlotResults();' class="linkedin-panel-primary-btn">{!$Label.MA_Plot_Results}</button>
                                                        <button id="LinkedIn_PlotResults_Button" onclick='LinkedIn_Clear();' class="linkedin-panel-default-btn">Clear</button>
                                                    </div>
                                                    <div id="linkedin-status-elements" style='display: none;'>
                                                        <img class='LinkedIn_PlotResults_Loader' src="{!URLFOR($Resource.MapAnything, 'images/chatterstatus-loader.gif')}"  />
                                                        <span id="linkedin-status-text"></span>
                                                    </div>


                                                </td>
                                                <td></td>
                                            </tr>
                                        </table>

                                        </div>


                                    </script>
                                </div>
                            </div>
                        </div>
		    			<div align="center" title="{!$Label.MASettings_Settings}" id='settings' onclick="LaunchSettings({page:'general'});" class='map-settings top-row-button' style='border-top-right-radius: 3px; border-bottom-right-radius: 3px;'>
							<img src="{! URLFOR($Resource.MapAnything, 'images/ui-icons/settings.png') }" />
						</div>
				    </td>
				    <td class="drop2" style='box-shadow: 0 0 4px 1px rgba(0,0,0,0.45); background-color:#fff; border-radius: 3px; display: inline-block; white-space: nowrap; text-align: right; vertical-align: top; margin-left: 10px;'>
				    	<div align="center" title="Hand" id="StopDrawingButton" class='top-row-button activeDrawingTool' style='border-top-left-radius: 3px; border-bottom-left-radius: 3px;' onclick="ChangeDrawingManagerMode('hand');">
		    				<img src="{!URLFOR($Resource.MapAnything, 'images/drawingtools/gt_hand.png')}"/>
		    			</div>
		    			<div align="center" title="Polygon" id="DrawPolygonButton" class='top-row-button' onclick="ChangeDrawingManagerMode('polygon');">
		    				<img src="{!URLFOR($Resource.MapAnything, 'images/drawingtools/gt_polygon.png')}"  />
		    			</div>
		    			<div align="center" title="Circle" id="DrawCircleButton" class='top-row-button' onclick="ChangeDrawingManagerMode('circle');">
		    				<img src="{!URLFOR($Resource.MapAnything, 'images/drawingtools/gt_circle.png')}"  />
		    			</div>
		    			<div align="center" title="Rectangle" id="DrawRectangleButton" class='top-row-button' style='border-top-right-radius: 3px; border-bottom-right-radius: 3px;' onclick="ChangeDrawingManagerMode('rectangle');">
		    				<img src="{!URLFOR($Resource.MapAnything, 'images/drawingtools/gt_rectangle.png')}"  />
		    			</div>

				    </td>

				    <td style='padding-left: 15px; display: inline-block;'>

				    </td>
		    	</tr>
		    </table>
	    </div>

        <div style="float:left;position: absolute;left: 364px;z-index: 10;top: 57px;">
            <button id="visibleAreaRefeshMap" class="MAbutton button-blue icon-left ion-android-refresh ready">Refresh in this area</button>
        </div>

    	<!-- Status Message -->
    	<div id='map-status'></div>

    	<!-- Logo-->
    	<!--<img class="mapanything-map-logo" src="{!URLFOR($Resource.MapAnything, 'mapAnythingSettingsLogo.png')}" />-->
    	<div class="mapanything-map-logo">
    	    <svg viewBox="0 0 119 25" xmlns="http://www.w3.org/2000/svg"><g fill-rule="nonzero" fill="none"><path d="M116.1 6.7h-4.9c-.6 0-1 .4-1 1V9c-.1.4.1.8.4 1 .2 0 .4.2.4.4s-.4.3-1 .2c-.6-.1-1.2-.2-1.8-.2-1.4.1-2.8.6-3.9 1.5-.5.3-1.1.3-1.5-.1-.9-.8-2.1-1.3-3.4-1.4-1 0-1.9.2-2.9.4-.3.1-.6.2-1 .1 0-.3.1-.6.2-.8v-.4c0-1.4-1.2-2.6-2.6-2.5-1.4 0-2.5 1.1-2.5 2.5v.4c.1.3.2.7.2 1.1 0 .2-.4.2-.8-.1-.7-.4-1.6-.6-2.4-.6h-.2c-.3-.2-.4-.6-.3-1v-2c0-.6-.4-1-1-1h-2.7c-.6 0-1 .4-1 1v2.1c.1.4 0 .8-.3 1-.3-.2-.4-.6-.3-.9 0-.5-.5-.9-1-.9H78c-.5 0-1 .4-1 .9.1.4-.2.8-.6.9H75c-.6 0-1 .4-1.2.9l-.4 1.1c-.2.5-.5.5-.7 0l-.4-1.1c-.2-.5-.7-.9-1.3-.9h-4.1s-.4-.1-1-.2h-.6c-1 0-2.1.2-3 .5-.5.1-1.2.4-1.4.5-.3.3-.5.7-.5 1.2v.7c0 .6-.2.6-.4.1L58.3 9c-.3-.7-.8-1-1.4-1h-2.2c-.6 0-1.1.4-1.4.9l-1.4 3.6c-.1.3-.4.5-.7.4-.2 0-.3-.1-.4-.3 0 0-2-2.3-4.6-2.3-.9 0-1.8.2-2.7.4-.5.2-1.2.4-1.4.5-.5.1-.9-.1-1.3-.3-.7-.4-1.5-.6-2.3-.6-.8 0-1.5.2-2.3.4-.5.2-1.1.5-1.3.6-.2.1-.4-.2-.5-.8l-.3-1.6c-.1-.6-.6-1-1.2-1h-2.6c-.6 0-1.1.4-1.3 1l-.7 2.5c-.2.5-.4.5-.6 0L27 8.9c0-.5-.5-.9-1.1-.9h-2.6c-.6 0-1.1.4-1.2 1l-1.8 11.2c-.1.4.2.9.7 1h3c.6 0 1.1-.4 1.2-1l.1-.7c.1-.5.3-.6.4 0l.2.8c.2.6.7.9 1.3 1h1.9c.6 0 1.1-.4 1.3-1l.2-.8c.2-.5.4-.5.4 0l.1.7c.1.6.6 1 1.2 1h2.8c.3.1.7 0 1-.2.3-.1.6 0 .9.1.6.1 1.1.2 1.7.2.6 0 1.3-.1 1.9-.2.4-.1.9.2 1 .6v1.5c0 .6.4 1 1 1h2.7c.6 0 1-.4 1-1v-.9c0-.5.3-1 .8-1.1.4 0 1.4-.3 1.4-.2.3.1.6.2 1 .1h3.1c.6 0 1.1-.4 1.3-.9l.2-.5c.2-.5.8-.9 1.3-.9h.6c.6 0 1.1.4 1.3.9l.2.5c.2.5.8.9 1.3.9H64c.6 0 1-.4 1-1h.3c0 .6.4 1 1 1H69c.6 0 1-.4 1-1 .3.2.4.5.2.8l-.9 2.4c-.2.3 0 .7.3.9.1.1.2.1.4.1h2.9c.6 0 1.1-.4 1.4-.9l2.5-6.5c.2-.5.4-.6.4-.1 0 .6.2 1.2.4 1.7 0 0 1.1 2.9 3.4 2.9h.6l1-.2h3.7c.6 0 1-.4 1-1h.3c0 .6.4 1 1 1h9.8c.6 0 1-.4 1-1h.3c0 .6.4 1 1 1h2c.6 0 1 .4 1 1v.2c0 .4.1.9.4 1.2.2.1.9.3 1.4.5.7.2 1.4.3 2.2.4 3.1 0 4.8-3.9 4.8-3.9.2-.6.4-1.3.4-1.9v-5.4c0-.5.4-1 .9-1h3.3c.6 0 1-.4 1-1V7.7c0-.6-.4-1-1-1h-1zM10.7.7C5.5.7 1.2 5 1.2 10.2c0 2.2 1.3 5 4 8.5 1.2 1.5 2.4 3 3.8 4.4.9 1 2.5 1 3.5.1 1.3-1.4 2.6-2.9 3.8-4.5 2.7-3.6 4-6.4 4-8.6C20.2 4.9 16 .7 10.7.7z" fill="#FFF"/><path fill="#0073CB" d="M30.7 9.5l-2.4 8-2.5-8h-2.1L22 19.6h1.8l1.2-7.9 2.4 7.9h1.7l2.4-7.9 1.3 7.9h1.7L32.9 9.5M38.6 11.9c-.9 0-1.7.2-2.5.6V14c.7-.4 1.4-.6 2.2-.6.7-.1 1.3.3 1.4 1v.8H39c-2.2 0-3.5.8-3.5 2.3 0 1.7 1.4 2.3 3.4 2.3.9 0 1.7-.1 2.6-.3v-5c0-2-1.2-2.6-2.9-2.6zm1.2 6.5c-.3.1-.6.1-.9.1-1 0-1.7-.3-1.7-1.1s.8-1.1 1.9-1.1h.7v2.1zM46.4 11.9c-1 0-2.1.2-3.1.6v10.2H45v-3.1c.4.1.9.2 1.4.2 2.6 0 4.2-1.5 4.2-4-.1-2.5-1.7-3.9-4.2-3.9zm-.1 6.4c-.4 0-.9-.1-1.3-.2v-4.5c.4-.1.9-.2 1.4-.2 1.2-.1 2.3.8 2.5 2v.4c.1 1.3-.8 2.4-2.1 2.5h-.5zM54.7 9.5l-3.9 10.1h1.8l.9-2.4H58l.9 2.4h1.9l-4-10.1h-2.1zm-.7 6.3l1.7-4.7 1.7 4.7H54zM65.3 11.9c-1.2 0-2.4.2-3.5.6v7.1h1.7v-6c.5-.2 1.1-.2 1.6-.2.8-.1 1.5.4 1.6 1.1V19.6h1.7v-4.9c.1-2.1-1.2-2.8-3.1-2.8zM73 18l-2.1-6h-1.8l3.1 7.9-1.1 2.8h1.7L76.9 12h-1.8M80.2 17.1v-3.6h2.2V12h-2.2v-1.8h-1.7V12h-1.1v1.4h1.1v4c-.1 1.1.7 2.2 1.8 2.3h.5c.6 0 1.3-.1 1.8-.4v-1.5c-.4.3-.9.4-1.4.4-.5 0-1-.4-1.1-.9.1 0 .1-.1.1-.2zM87.6 11.9c-.7 0-1.3.1-2 .4V8h-1.7v11.6h1.7v-5.9c.5-.2 1.1-.3 1.6-.3.8-.1 1.5.4 1.6 1.1V19.6h1.7v-4.9c0-2.1-1.2-2.8-2.9-2.8zM93.2 8.7c-.6 0-1 .5-1.1 1 0 .6.5 1.1 1 1.1s1.1-.5 1.1-1c0-.7-.4-1.1-1-1.1zM92.3 12H94v7.6h-1.7zM99.4 11.9c-1.2 0-2.4.2-3.5.6v7.1h1.7v-6c.5-.2 1.1-.2 1.6-.2.8-.1 1.5.4 1.6 1.1V19.6h1.7v-4.9c.1-2.1-1.2-2.8-3.1-2.8zM103.9 15.8c0 2.5 1.7 3.8 4 3.8.5 0 1-.1 1.5-.3v.2c.1 1-.6 1.9-1.6 2h-.4c-.9 0-1.7-.2-2.5-.7v1.6c.8.4 1.6.5 2.5.5 1.7 0 3.7-.8 3.7-3.3v-7.2c-.9-.4-1.9-.5-2.9-.5-2.6 0-4.3 1.4-4.3 3.9zm5.5 2.1c-.4.2-.9.3-1.3.3-1.2.1-2.3-.8-2.4-2.1v-.3c-.1-1.3.9-2.3 2.1-2.4h.5c.4 0 .8.1 1.2.2-.1-.1-.1 4.3-.1 4.3zM111.7 8.5h.8v2.1h.3V8.5h.8v-.3h-1.9M115.8 8.2l-.6 1.7c-.1.2-.1.3-.1.4 0-.1-.1-.2-.1-.4l-.6-1.7h-.5v2.4h.3v-2l.7 2h.3l.7-2v2h.3V8.2h-.4zM10.7 2.2c-4.4 0-8 3.6-8 8 0 1.8 1.2 4.4 3.7 7.6 1.1 1.5 2.4 2.9 3.6 4.3.2.2.4.3.7.3.3 0 .5-.1.7-.3 1.3-1.4 2.5-2.8 3.6-4.3 2.4-3.2 3.7-5.8 3.7-7.6 0-4.4-3.5-8-8-8zm1.4 12.6V15.1l-.1.1c0 .1-.1.1-.1.2v.6l-.1.1c-3.3.5-6.4-1.7-7-5C4.4 9.2 5 7.3 6.2 6v.5h.1c0 .1-.1.1-.1.2-.2.2-.2.2-.4.3 0 .1.2 0 .3-.1l.2-.1c.1-.1.1-.2.2-.2 0-.1.1-.1.1-.2l.1-.1s.1 0 .1-.1c0 0 .1 0 .1-.1H7l.1.1h.2c0 .1.1.1.1.2v.1c0 .1.1.2.1.3V7c0 .1.1.2.2.2s.1.1.1.1v.2s0 .1.1.1c.1.1.1.2.1.2V8.9c0 .1.1.2.1.3 0 .1.1.1.1.2s.1.1.1.2.1.2.1.3c0 .1.1.2.1.3l.2.2c.1.1.1 0 .1 0 0-.1-.1-.1-.1-.2s-.1-.2-.2-.3c0-.1-.1-.1-.1-.2 0 0 .1-.1.1 0 .1 0 .1.1.1.1 0 .1.1.2.1.2.2 0 .3.1.3.1l.1.1.2.2c0 .1.1.1.1.2s0 .1.1.1c0 0 .1.1.2.1s.1.1.2.1c0 .1.1.1.1.2H10.3c.1 0 .1.1.2.1.1.1.2.1.3.1.1 0 .2.1.2.2s.1.1.2.2l.2.1s.1 0 .1.1c.1 0 .1-.1.3.1V12.3l-.1.1c0 .1-.1.1-.1.2l-.1.1v.5l.1.1c0 .1.1.1.1.2s0 .1.1.2v.1c0 .1.1.1.1.1.1 0 .2.1.2.1.1.1.1.1.1.2v.4c0 .1 0 .2-.1.2 0-.1 0-.1 0 0zm.1 1.2c0-.1 0-.1 0 0l.1-.1.1-.1s.1-.1 0-.2h.1v-.1c0-.1.1-.1.2-.1s.1 0 .2-.1v-.2h.1c.1 0 .2 0 .2-.1l.4-.4c0-.1.1-.2.1-.2.1 0 .1-.1.2-.1h.2c0-.1.1-.1.2-.2s.1-.2.1-.2c0-.1.1-.2.1-.2 0-.1.1-.2.1-.2l.2-.2v-.2s0-.1-.1-.1-.1 0-.1-.1c-.1-.1-.1-.1-.2-.1s-.2-.1-.3-.1c-.1 0-.1-.1-.2-.1h-.1v-.2c0-.1-.1-.2-.2-.2s-.1-.1-.2-.1-.2-.1-.2-.1c-.1-.1-.1-.2-.2-.2-.1-.1-.1-.1-.2-.1h-.2c-.1 0-.1 0-.2-.1-.1 0-.1 0-.2-.1H12c-.1 0-.1.1-.1.1s0 .1-.1.1c0 0-.1 0-.1-.1h-.4c-.1-.1-.1-.2-.1-.3 0-.1 0-.1-.1-.2H10.8l.1-.4v-.1h-.1c-.1 0-.2.1-.2.2s-.1.1-.2.1-.2 0-.2-.1c-.1-.1-.1-.2-.1-.2V10l.1-.1h.1v-.1H10.6s.1 0 .1-.1.1 0 .1 0h.4s.1.1.1.2.1.2.1.2c.1.1.1 0 .1 0 0-.1 0-.2-.1-.3v-.2l.1-.1.1-.1c0-.1.1-.1.1-.2.2-.1.3-.2.3-.3 0-.1 0-.2.1-.3 0-.1.1-.1.1-.1h.2c.1 0-.1-.2-.1-.2 0-.1.1-.1.2-.1h.4l.1-.1c.1 0 .1-.1.1-.2h-.2l-.1-.1v-.2c-.1 0-.2 0-.1-.1 0-.1.1-.1.2-.1h.1c.1 0 .2 0 .3-.1.1 0 .2-.1.2-.1l.1-.1v-.2l-.3.1c-.1-.1-.2-.2-.3-.2-.1 0-.1-.1-.1-.1 0-.1 0-.1-.1-.2l-.1-.2-.1-.1v.1s0 .1-.1.1h-.1c0-.1-.1-.1-.1-.2s-.1-.1-.1-.1l-.2-.2-.1-.1h-.2v.5c0 .1.1.1.1.2s0 .2-.1.2c-.1.1-.1.2-.1.2v.2l-.1.1c-.1 0-.1-.1-.1-.1 0-.1-.1-.2-.1-.2 0-.1 0-.1-.1-.1s-.2 0-.2-.1c-.1 0-.2-.1-.2-.1h-.1l-.1-.1c0-.1 0-.1-.1-.1v-.2c0-.1.1-.2.2-.3l.2-.2s0-.1.1-.1h.1c0-.1.1-.2.1-.2 0-.1.1-.1.1-.1.1 0 .1 0 .2-.1V4.9l-.1-.1h-.1v.1s0 .1-.1.1H11s-.1 0-.1-.1v-.2s0-.1-.1-.1l-.1.1v.2s0 .1.1.1l.1.1s0 .1-.1 0c-.1 0-.1-.1-.2-.1 0 0-.1-.1-.1 0 0 0 0 .1-.1.1l-.1.1C10 5 10 5 9.9 4.9h-.1s-.1 0-.1.1h-.5v-.1s0-.1-.1-.1-.1 0-.2-.1c0 0-.1 0-.1-.1h-.1-.2s0-.1-.1-.1-.2.1-.2.1c-.1 0-.1.1-.2.1h-.1l-.1-.1-.1-.1h-.2c3.2-1.4 6.9-.4 8.5 2.5 1.6 2.9.6 6.6-2.3 8.3-.4.3-1 .5-1.5.7z"/><path d="M93.2 8.7c-.6 0-1 .5-1.1 1 0 .6.5 1.1 1 1.1s1.1-.5 1.1-1c0-.7-.4-1.1-1-1.1z" fill="#0073CB"/></g></svg>
    	</div>

        <!-- Growl Wrapper -->
        <div id="growl-wrapper" style='position: absolute; top: 5px; right: 5px;'></div>

        <!-- Search Box -->
		<div id='search-wrapper' class="slds-scope">
			<!--search input-->
			<div id="searchPositioner">
				<div id="globalSearchWrap" class="slds-form-element slds-lookup slds-is-open">
					<div class="slds-form-element__control slds-input-has-icon slds-input-has-icon--left-right">
						<span class="slds-input__icon slds-input__icon--left slds-icon-text-default ma-icon ma-icon-search"></span>
						<input type="text" id="globalSearchInput" class="slds-input js-clearable-input" placeholder="Search for..." />
						<button class="js-globalSearchClear slds-input__icon slds-input__icon--right slds-button slds-button--icon js-clear-this-input-value" style="display:none;">
							<span class="ma-icon ma-icon-clear"></span>
						</button>
					</div>
					<div id="globalSearchTooltip" class="slds-popover slds-popover--tooltip slds-nubbin--top-left" role="tooltip">
						<div class="slds-popover__body">
							<ul>
								<li>&bull; Places and Points of Interest</li>
								<li>&bull; Records in plotted Marker Layers</li>
								<li>&bull; Records in Salesforce</li>
							</ul>
						</div>
					</div>
					<div class="slds-lookup__menu" id="globalSearchAutocompleteResults" style="display:none;">
						<div id="globalSearchAutocompleteListWrap" style="display:none;">
							<ul id="globalSearchAutocompleteResultsListPlaces" class="slds-lookup__list" role="listbox">
								<li>
									<h3 class="slds-section-title--divider">Places</h3></li>
							</ul>
							<ul id="globalSearchAutocompleteResultsListMarkerLayers" class="slds-lookup__list" role="listbox">
								<li>
									<h3 class="slds-section-title--divider">Records in Marker Layers</h3></li>
							</ul>
							<ul id="globalSearchAutocompleteResultsListSalesforce" class="slds-lookup__list" role="listbox">
								<li>
									<h3 class="slds-section-title--divider">Records in Salesforce</h3></li>
							</ul>

						</div>
						<div id="globalSearchAutocompleteSpinner" class="slds-spinner_container" style="display:none;">
							<div role="status" class="slds-spinner slds-spinner--medium slds-spinner--brand">
								<span class="slds-assistive-text">Loading</span>
								<div class="slds-spinner__dot-a"></div>
								<div class="slds-spinner__dot-b"></div>
							</div>
						</div>
					</div>
				</div>
			</div>

		</div>
		<!--search-wrapper-->


	    <!-- ListView Button -->
	     <button class="MAbutton button-light icon-left  glyphicon-list-alt listview-trigger" id="listview-accesstab" onclick="MAListView.DisplayListView();">{!$Label.MA_Open_List_View}</button>
	     <!--<button class="MAbutton button-light icon-left  glyphicon-list-alt listview-trigger" id="listview-accesstab" onclick="MAListView.DisplayListView();">{!$Label.MA_Open_List_View}</button>-->

	    <!-- ListView Workspace -->
	    <div id='listview'>
			<!--<div class='listview-buttons'></div>-->
			<div id="listViewLoader" class="MA2-loading-mask hidden">
				<div style="" class="loadingText">
					<div class="MA2-loader loader-inline"></div>
					Loading...
				</div>
			</div>

			<div class="button-wrapper">

				<a class="MAbutton button-light icon-left  glyphicon-plus-sign" onclick="MAListView.AddSelectedTab(true);">{!$Label.MA_New_Selected_Tab}</a>
				<a class="MAbutton button-light" onclick="MAListView.ClearAllSelected();">{!$Label.MA_Clear_Selections}</a>

				<div class="button-hover-reveal" role="ReferencePointSet" style="display: none; vertical-align:top;">
					<a class="MAbutton button-light icon-left  glyphicon-screenshot has-caret">Address Set!<span class="caret"></span></a>
					<div class="button-hover-reveal-menu">
						<a onclick="MAListView.ClearReferencePoint();">{!$Label.MA_Clear_Reference_Point}</a>
						<a onclick="MAListView.ProcessSelectedTabDrivingDistance();">{!$Label.MA_Drive_Distance_And_Time}</a>
						<a onclick="MAListView.ProcessSelectedTabStraightLineDistance();">{!$Label.MA_Straight_Line_Distance}</a>
					</div>
				</div>

				<div class="button-hover-reveal" role="NoReferencePoint" style="vertical-align:top;">
					<a class="MAbutton button-light icon-left  glyphicon-ban-cirlce has-caret">{!$Label.MA_No_Reference_Point} <span class="caret"></span></a>
					<div class="button-hover-reveal-menu">
						<a href="#" class="text-disabled">{!$Label.MA_Clear_Reference_Point}</a>
						<a href="#" class="text-disabled">{!$Label.MA_Drive_Distance_And_Time}</a>
						<a href="#" class="text-disabled">{!$Label.MA_Straight_Line_Distance}</a>
					</div>
				</div>
			</div>
			<!--button-wrapper-->

			<div class="button-wrapper-right">
				<!-- Close Button -->
				<a class="MAbutton icon  glyphicon-remove-circle listview-close-button" onclick="MAListView.Hide();MAListView.CloseListView();"></a>
				<a class="MAbutton icon  glyphicon-cog listview-settings-button" role="ScrollToTop" onclick="LaunchSettings({page:'listview'});"></a>
				<a class="MAbutton button-clear button-dark icon-right ion-arrow-expand listview-fullscreen-button" role="ScrollToListView" onclick="MAListView.ScrollToListView();">{!$Label.MA_Fullscreen}</a>
				<a class="MAbutton button-clear button-dark icon-right ion-arrow-up-c listview-scrolltotop-button" role="ScrollToTop" onclick="MAListView.ScrollToListViewTop();" style="display:none;">{!$Label.MA_Scroll_To_Top}</a>

			</div>

			<!-- Header -->
			<h2 class='listview-header'></h2>
			<div class='listview-pane' data-pane='tabs'>
				<div id='listview-tabs'>
					<ul>
					</ul>
				</div>
			</div>
		</div>
		<!--listview-->
        <!-- Bottom Workspace -->
        <div id='bottomworkspace'>

            <!-- Close Button -->
            <div class='bottomworkspace-close' onclick='BottomWorkspace_Hide();'></div>

            <!-- Header -->
            <h2 class='header'></h2>

            <!-- Territory Grid -->
            <div class='bottomworkspace-pane' data-pane='TerritoryGrid' style='display: none;'>
                <button id='TerritoryGrid-ManageRollups' onclick="ManageRollups_LaunchPopup();">{!$Label.MA_Manage_Rollups}</button>
                <button id='TerritoryGrid-ShowLegend' onclick="ManageRollups_ShowLegend();" style='display: none;'>{!$Label.MA_Show_Legend}</button>
                <div id='TerritoryGrid'></div>
            </div>

            <!-- Export Pane -->
            <div class='bottomworkspace-pane' data-pane='Export' style='display: none; max-height:200px; overflow: auto;'>

                <!-- Export Options -->
                <div class='form'>

                    <!-- Name -->
                    <div>
                        <span>{!$Label.MA_Name}:</span>
                        <input type='text' id='ExportName' style='width: 400px;' />
                    </div>

                    <!-- Buttons -->
                    <div class='buttons slds-scope'>
                        <a class="slds-button slds-button_brand" onclick="DoExport();">{!$Label.MA_Submit}</a>
                        <a class="slds-button slds-button_neutral" onclick="ClearExport();">{!$Label.MA_Clear_Exports}</a>
                    </div>

                </div>

                <!-- Exports Table -->
                <div id="exportedTable" class='loadmask-wrapper'>

                    <apex:outputPanel id="MAExportsRepeat">
                        <table class="exported">
                            <tr>
                                <th style="width:65%;border-right:1px solid #fff;" colspan="2">{!$Label.MA_Export_Name}</th>
                                <th style="width:28%;">{!$Label.MA_Export_Date}</th>
                            </tr>

                            <apex:repeat value="{!MAExports}" var="e" >
                                <tr>
                                    <td style="width:5%"><a href="{!sitePrefix}/apex/sma__MapAnythingExport?expID={!e.Id}&type=xls&name={!e.Name}" target="_blank">{!e.Name}.xls</a></td>
                                    <td><a href="{!sitePrefix}/apex/sma__MapAnythingExport?expID={!e.Id}&type=csv&name={!e.Name}" target="_blank">{!e.Name}.csv</a></td>
                                    <td><apex:outputField value="{!e.CreatedDate}"/></td>
                                </tr>
                            </apex:repeat>
                        </table>
                    </apex:outputPanel>

                </div>

                <!-- Export Messages -->
                <apex:outputPanel id="ExportPageMessages">
                    <apex:pagemessages ></apex:pagemessages>
                </apex:outputPanel>

            </div><!--End Export Pane-->

            <!-- LinkedIn Pane -->
            <div class='bottomworkspace-pane' data-pane='LinkedIn' style='display: none;'>

                <!-- LinkedIn -->
                <div class="indent menubutton social">
                    <script type="in/Login">
                        <div><input type='checkbox' class='linkedin-myconnections' /><img class='linkedin-myconnections-loader' src="{!URLFOR($Resource.MapAnything, 'images/chatterstatus-loader.gif')}" style='display: none;' /> {!$Label.MA_My_Connections}</div>
                        <div>
                            <input type='checkbox' class='linkedin-search' /><img class='linkedin-search-loader' src="{!URLFOR($Resource.MapAnything, 'images/chatterstatus-loader.gif')}" style='display: none;' /> {!$Label.MA_People_Search}
                            <div class='linkedin-filters-wrapper' style='display: none; padding-left: 25px;'>
                                <div style='margin: 5px 0;'><input type='checkbox' class='linkedin-filters-distance first' data-value='1' checked='checked' />1st <input type='checkbox' class='linkedin-filters-distance second' data-value='2' checked='checked' />2nd <input type='checkbox' class='linkedin-filters-distance third' data-value='3' checked='checked' />3rd <input type='checkbox' class='linkedin-filters-distance out' data-value='-1' checked='checked' />{!$Label.MA_Out} </div>
                                <div class='linkedin-filters'>
                                </div>
                                <span class='link blue addfilter'>{!$Label.MA_Add_Filter}</span>

                                <div style='margin-top: 10px; text-align: right;'><button onclick='LinkedIn_PeopleSearch();'>{!$Label.MA_Plot_Results}</button></div>
                            </div>
                        </div>
                        <div>
                            <input type='checkbox' class='linkedin-companysearch' /><img class='linkedin-companysearch-loader' src="{!URLFOR($Resource.MapAnything, 'images/chatterstatus-loader.gif')}" style='display: none;' /> {!$Label.MA_Company_Search}
                            <div class='linkedin-companyfilters-wrapper' style='display: none; padding-left: 25px;'>
                                <b>{!$Label.MA_Keywords}: </b> <input type='text' class='linkedin-companysearch-keywords' />

                                <div style='margin-top: 10px; text-align: right;'><button onclick='LinkedIn_CompanySearch();'>{!$Label.MA_Plot_Results}</button></div>
                            </div>
                        </div>
                        <div style='margin-top: 10px;'><button onclick='IN.User.logout();'>{!$Label.MA_Logout}</button></div>
                    </script>
                </div>

            </div>

            <!-- Settings Pane -->
            <div class='bottomworkspace-pane' data-pane='Settings' style='display: none;'>
                <c:MASettings />
            </div>

        </div>

    </div>

    <!-- Range Colors -->
    <div id="RangeColorsDiv" style="text-align:center;"></div>

    <!-- Notification Templates -->
    <div id="container" style='display: none;'>
        <div id="basic-template">
            <a class="ui-notify-cross ui-notify-close" href="#">x</a>
            <h1 style="color:red;">#{title}</h1>
            <p>#{text}</p>
        </div>
        <div id="Warning-Template">
            <a class="ui-notify-cross ui-notify-close" href="#">x</a>
            <h1 style="color:yellow;">#{title}</h1>
            <p>#{text}</p>
        </div>
        <div id="Success-Template">
            <a class="ui-notify-cross ui-notify-close" href="#">x</a>
            <h1 style="color:#00FF00;">#{title}</h1>
            <p>#{text}</p>
        </div>
    </div>

    <!-- bootstrap alert templates -->
    <div class="alert-container" style='display: none;'>
        <div class="alert alert-info fade in" id="alert-info">
            <a href="#" class="close" data-dismiss="alert">&times;</a>
            <strong>Note!</strong>
        </div>
        <div class="alert alert-success fade in" id="alert-success">
            <a href="#" class="close" data-dismiss="alert">&times;</a>
            <strong>Success!</strong>
        </div>
        <div class="alert alert-warning fade in" id="alert-warning">
            <a href="#" class="close" data-dismiss="alert">&times;</a>
            <strong>Warning!</strong>
        </div>
        <div class="alert alert-danger fade in" id="alert-danger">
            <a href="#" class="close" data-dismiss="alert">&times;</a>
            <strong>Error!</strong>
        </div>
    </div>

    <!-- Hidden Export Template -->
    <div id="HiddenExport" style="display:none;height:0px;overflow:scroll;">
        <table id="HiddenExportTable" style="display:none;height:0px;overflow:scroll;"></table>
    </div>

    <!-- Hidden Selected Data -->
    <div id="HiddenSelection" qid="selected" style="display:none">
    </div>

    <!-- Create Custom Shape Popup -->
	<div id="CustomShapePopup" class="popup_block maPopup" style='height: 600px;'>
		<div class="maPopupLoading hidden" style="height: 600px;width: 96%;opacity: 1;background: rgba(192, 192, 192, 0);">
			<div class="loading-wrapper" style="position: absolute;top: 50%;width: 100%;text-align: center;font-size: 16px;"><span class="loading-icon icon-left spin ion-load-c"></span><span class="loading-text">Saving...</span></div>
		</div>
		<div class='territory-popup loadmask-wrapper' style='height: 600px;'>
			<h2>Create/Edit Custom Shape Layer</h2>

			<!-- Basic Information -->
			<div class='graybox'>

				<!-- Label -->
				<table class='form'>
					<tr>
						<td style='padding-right: 10px; padding-left: 10px;'>{!$Label.MATerritoryBuilder_Label}</td>
						<td><input class='shape-name' type='text' style='width: 150px; padding: 4px; padding-right: 40px; border: 1px solid #8EA6B9; height: 20px; border-radius: 4px 4px 4px 4px; padding-left: 15px;' /></td>
					</tr>
					<tr>
						<td style='padding-right: 10px; padding-left: 10px;'>Description</td>
						<td><textarea class='shape-description' type='text' style='width: 350px; padding: 4px; padding-right: 40px; border: 1px solid #8EA6B9; height: 50px; border-radius: 4px 4px 4px 4px; padding-left: 15px;'></textarea></td>
					</tr>
				</table>

			</div>

			<!-- Tabs -->
			<div id='tabs' style='padding: 0; border: none; background: none;'>

				<!-- Tabs -->
				<ul class='tabs' style='background: none;'>
					<li class='territory-tab folders-tab'><a href="#tab-folders">Folder</a></li>
					<li class='territory-tab color-tab'><a href="#tab-color-geometry">{!$Label.MATerritoryBuilder_Tab_Options}</a></li>

				</ul>

				<!-- Geometry Pane -->
				<div class='tab-folders' id='tab-folders' style='padding: 10px 0 0 0; height: 470px;'>
					<div class="foldersDisabled"></div>
					<div id="SaveShapeTree" class="demo" style="padding-top:3px;"></div>
				</div>
				<!-- End Geometry Pane -->

				<!-- Color Pane -->
				<div class='tab-color-geometry' id='tab-color-geometry' style='padding: 10px 0 0 0;'>
					<div class='tab-color-geometry-content'>


						<table style="width: 100%;">
							<tr>
								<td style="vertical-align:top;">
									<!-- Geometry Header -->
									<table class='boundary-color-header'>
										<tr>
											<th colspan="2" style="padding-top:10px;">{!$Label.MATerritoryBuilder_Color_Selection}</th>
										</tr>
										<tr>
											<td>{!$Label.MATerritoryBuilder_Fill_Color}:</td>
											<td>
												<input id="custom-shapelayer-shape-fill-color-input" class="color fillcolor boundary-style" style="background-color: rgb(22, 50, 92); color: rgb(255, 255, 255);" type="text" autocomplete="off" value="#16325c" onchange="CustomShapeLayerUpdatePreview();"
												/>
											</td>
										</tr>
										<tr>
											<td>{!$Label.MATerritoryBuilder_Border_Color}:</td>
											<td>
												<input id="custom-shapelayer-border-fill-color-input" class="color bordercolor boundary-style" style="background-color: rgb(48, 131, 211); color: rgb(255, 255, 255);" type="text" autocomplete="off" value="#3083d3" onchange="CustomShapeLayerUpdatePreview();"
												/>
											</td>
										</tr>
										<tr>
											<td>{!$Label.MATerritoryBuilder_Opacity}:</td>
											<td>
												<select id="custom-shapelayer-shape-fill-opacity-input" class="fillopacity" onchange="CustomShapeLayerUpdatePreview();">
                                                    <option value="0.1">10%</option>
                                                    <option value="0.2">20%</option>
                                                    <option value="0.3">30%</option>
                                                    <option value="0.4">40%</option>
                                                    <option value="0.5">50%</option>
                                                    <option value="0.6">60%</option>
                                                    <option value="0.7">70%</option>
                                                    <option value="0.8">80%</option>
                                                    <option value="0.9">90%</option>
                                                    <option value="1.0">100%</option>
                                                </select>
											</td>
										</tr>
										<tr class="labelOptions">
											<th colspan="2">{!$Label.MATerritoryBuilder_Label_Options}:</th>
										</tr>
										<tr class="labelOptions">
											<td>{!$Label.MATerritoryBuilder_Label_Enable}:</td>
											<td>
												<input type='checkbox' id="custom-shapelayer-label-enabled" onchange="CustomShapeLayerUpdatePreview();" />
											</td>
										</tr>
										<tr class="labelOptions">
											<td>{!$Label.MATerritoryBuilder_Label_TextOverride}:</td>
											<td>
												<input class="label-text-override-input" type="text" value="" id="custom-shapelayer-label-override" />
											</td>
										</tr>
										<tr class="labelOptions">
											<td>{!$Label.MATerritoryBuilder_Label_Justification}:</td>
											<td>
												<select id="custom-shapelayer-label-justification" onchange="CustomShapeLayerUpdatePreview();">
	                                                    <option value="left">Left</option>
	                                                    <option value="center" selected="selected">Center</option>
	                                                    <option value="right">Right</option>
	                                                </select>
											</td>
										</tr>
										<tr class="labelOptions">
											<td>{!$Label.MATerritoryBuilder_Label_FontSize}:</td>
											<td>
												<select id="custom-shapelayer-label-font-size" onchange="CustomShapeLayerUpdatePreview();">
                                                    <option>8px</option>
                                                    <option>9px</option>
                                                    <option selected="selected">10px</option>
                                                    <option>11px</option>
                                                    <option>12px</option>
                                                    <option>13px</option>
                                                    <option>14px</option>
                                                    <option>15px</option>
                                                    <option>16px</option>
                                                    <option>17px</option>
                                                    <option>18px</option>
                                                </select>
											</td>
										</tr>
										<tr class="labelOptions">
											<td>{!$Label.MATerritoryBuilder_Label_FontColor}:</td>
											<td>
												<input id="custom-shapelayer-label-font-color" class="color boundary-style" style="background-color: rgb(255, 255, 255); color: rgb(255, 255, 255);" type="text" autocomplete="off" value="#FFFFFF" onchange="CustomShapeLayerUpdatePreview();" />
											</td>
										</tr>
										<tr class="labelOptions">
											<td>{!$Label.MATerritoryBuilder_Label_BGColor}:</td>
											<td>
												<input id="custom-shapelayer-label-bg-color" class="color boundary-style" style="background-color: rgb(0, 0, 0); color: rgb(255, 255, 255);" type="text" autocomplete="off" value="#000000" onchange="CustomShapeLayerUpdatePreview();" />
											</td>
										</tr>
										<tr class="labelOptions">
											<td>{!$Label.MATerritoryBuilder_Label_BGOpacity}:</td>
											<td>
												<select id="custom-shapelayer-label-bg-opacity" onchange="CustomShapeLayerUpdatePreview();">
                                                    <option value="0.1">10%</option>
                                                    <option value="0.2">20%</option>
                                                    <option value="0.3" selected="selected">30%</option>
                                                    <option value="0.4">40%</option>
                                                    <option value="0.5">50%</option>
                                                    <option value="0.6">60%</option>
                                                    <option value="0.7">70%</option>
                                                    <option value="0.8">80%</option>
                                                    <option value="0.9">90%</option>
                                                    <option value="1.0">100%</option>
                                                </select>
											</td>
										</tr>
									</table>
								</td>
								<td>
									<div id="customShape_preview_map" style="width: 470px;height: 390px;float:right;"></div>
								</td>
							</tr>
						</table>
					</div>
				</div>
				<!-- End Options Pane -->
			</div>

			<div style='position: absolute; left: 5px; bottom: 20px;'>
				<a class="MAbutton button-blue" onclick="MACustomShapes.saveV2(false);">{!$Label.MA_Save}</a>
				<a class="MAbutton button-blue savePlot" onclick="MACustomShapes.saveV2(true);">{!$Label.MA_Save_Plot}</a>
				<a class="MAbutton button-silver" onclick="ClosePopupWindow();clearCustomShapeInfo();">{!$Label.MA_Close}</a>
			</div>

			<!-- System Info -->
			<div class='systeminfoShape' style='position: absolute; left: 5px; bottom: 0px; font-size: 10px; color: #757575;'></div>

		</div>
	</div>

    <!--Shape Layer Builder v2 Derek -->
	<div id="shapeBuilderModalPositioner" class="slds-scope">
		<div id="CreateTerritoryPopup" class="slds-modal slds-modal--xxl">
			<!-- slds-fade-in-open -->
			<!-- Start error toast -->
			<div class="slds-notify_container" style="display:none;">
				<div class="slds-notify slds-notify_toast slds-theme_error" role="alert">
					<span class="slds-assistive-text">error</span>
					<span class="slds-icon_container slds-icon-utility-error slds-m-right_small slds-no-flex slds-align-top" title="Description of icon when needed">
	                <span class="slds-icon slds-icon_small ma-icon ma-icon-error" aria-hidden="true"></span>
					</span>
					<div class="slds-notify__content">
						<h2 class="slds-text-heading_small ">Bryan, put your error message here.</h2>
						<p>If needed, add additional details here, being very descriptive and transparent.</p>
					</div>
					<button class="slds-button slds-button_icon slds-notify__close slds-button_icon-inverse js-close-this-slds-toast" title="Close">
	                <span class="slds-button__icon slds-button__icon_large ma-icon ma-icon-close" aria-hidden="true"></span>
	                <span class="slds-assistive-text">Close</span>
	              </button>
				</div>
			</div>
			<!-- End error toast -->
			<div class="slds-modal__container">
				<div class="slds-modal__header">
					<button class="slds-button slds-modal__close slds-button--icon-inverse modal-close-tight-top" title="Close" onclick="cancelTerritoryCreation();">
						<span class="slds-button__icon slds-button__icon--large ma-icon ma-icon-close" aria-hidden="true"></span>
						<span class="slds-assistive-text">Close</span>
					</button>
					<h2 class="slds-text-heading--medium">Shape Layer Builder</h2>
					<!--hook up-->
				</div>
				<!-- Modal Content -->
				<div class="slds-modal__content flex-column full-height slds-modal__content-has-navigation height-100percent overflow-hidden">
					<div class="flex-grow-1 flex-row height-100percent">
						<div style="width:200px;background-color:#FAFAFB;border-right:1px solid #d8dde6;">
							<nav class="slds-nav-vertical slds-nav-vertical_shade" aria-label="Sub page">
								<div class="slds-nav-vertical__section">
									<ul>
										<li class="slds-nav-vertical__item slds-is-active">
											<a id="shapeBuilderNavDetails" href="javascript:void(0);" class="slds-nav-vertical__action" aria-describedby="entity-header" target-content="shapeLayerBuilderTabDetails">
												<span class="slds-badge navigation-badge">1</span>Details
											</a>
										</li>
										<li class="slds-nav-vertical__item disabled" disabled="true">
											<a id="shapeBuilderNavShapeSelection" href="javascript:void(0);" class="slds-nav-vertical__action" aria-describedby="entity-header" target-content="shapeLayerBuilderTabShapeSelection">
												<span class="slds-badge navigation-badge">2</span>Shape Selection
											</a>
										</li>
										<li class="slds-nav-vertical__item disabled" disabled="true">
											<a id="shapeBuilderNavDisplay" href="javascript:void(0);" class="slds-nav-vertical__action" aria-describedby="entity-header" target-content="shapeLayerBuilderTabDisplay">
												<span class="slds-badge navigation-badge">3</span>Display
											</a>
										</li>
									</ul>
								</div>
							</nav>
						</div>
						<div class="flex-grow-1 slds-is-relative">
							<div id="shapeLayerBuilderTabDetails" class="slds-navigation-content-area slds-show">
								<div class="slds-p-around--large">
									<div class="slds-form slds-form--stacked max-width--320 slds-p-bottom--small">
										<div class="slds-form-element">
											<label class="slds-form-element__label" for="shapeBuilderDetailsName"> <abbr class="slds-required" title="required">*</abbr>Name</label>
											<div class="slds-form-element__control">
												<input type="text" id="shapeBuilderDetailsName" class="slds-input territory-name" placeholder="ex. Southeast Territory" />
											</div>
										</div>
										<div class="slds-form-element">
											<label class="slds-form-element__label" for="input-id-02">Description</label>
											<div class="slds-form-element__control">
												<textarea id="input-id-02" class="slds-textarea territory-description" placeholder="ex. Enterprise Sales Territory"></textarea>
											</div>
										</div>
									</div>
									<div>
										<button id="shapeLayerBuilderTabDetailsNextButton" class="slds-button slds-button--success" disabled="true">Next</button>
									</div>
								</div>
							</div>
							<div id="shapeLayerBuilderTabShapeSelection" class="slds-navigation-content-area slds-hide">
								<div class="flex-column full-height">
									<div class="flex-shrink-0" style="border-bottom: 1px solid #d8dde6;">
										<div class="slds-p-vertical--small slds-p-horizontal_large">
											<div class="flex-row align-items-center">
												<div>
													<h3 class="slds-text-heading_small">Shape Selection</h3>
												</div>
												<div class="flex-grow-1"></div>
												<div style="display:none;" class="slds-p-right--x-small js-lasso-wrapper">
													<button class="slds-button slds-button_neutral js-show-shape-builder-drawing-mode">
														<div class="slds-button__icon slds-button__icon_left ma-icon ma-icon-lasso"></div>
														Draw on Map
													</button>
												</div>
												<div class="slds-is-relative">
													<button class="slds-button slds-button_neutral js-show-shape-builder-paste-clipboard">
														<div class="slds-button__icon slds-button__icon_left ma-icon ma-icon-paste"></div>
														Paste from Clipboard
														</button>
													<section id="shapeBuilderPasteClipboardPopover" aria-labelledby="panel-heading-id" class="slds-popover slds-popover_panel slds-popover_medium" role="dialog" style="display:none;">
														<button id="shapeBuilderPasteClipboardCloseX" class="slds-button slds-button_icon slds-button_icon slds-button_icon-small slds-float_right slds-popover__close js-hide-shape-builder-paste-clipboard" title="Close dialog">
															<div class="slds-button__icon ma-icon ma-icon-close" aria-hidden="true"></div>
														</button>
														<div id="shapeBuilderPasteClipboardStart" class="slds-popover__body">
															<div class="slds-p-top--large slds-p-horizontal--large">
																<h3 class="slds-text-heading_small slds-p-bottom--x-small">Paste ZIP Codes from Clipboard</h3>
																<p class="slds-text-body_small slds-text-color_weak">Paste copied ZIP Codes into the text area below and click the "Process Shapes" button. Be sure to review our <a href="javascript:void(0);" class="js-show-shape-builder-paste-clipboard-guidelines">formatting guidelines</a>.</p>
															</div>
															<div id="shapeBuilderPasteClipboardBase">
																<div class="slds-p-top--medium slds-p-horizontal--large slds-p-bottom--xx-small">
																	<div id="shapeBuilderPasteClipboardTextAreaWrap" class="slds-form-element">
																		<div class="slds-form-element__control">
																			<textarea id="shapeBuilderPasteClipboardTextArea" class="slds-textarea" placeholder="Paste ZIP Codes here..."></textarea>
																		</div>
																	</div>
																	<div id="shapeBuilderPasteClipboardProcessingWrap" style="display:none;">
																		<div role="status" class="slds-spinner slds-spinner_brand slds-spinner_large">
																			<span class="slds-assistive-text">Loading</span>
																			<div class="slds-spinner__dot-a"></div>
																			<div class="slds-spinner__dot-b"></div>
																		</div>
																		<p id="shapeBuilderPasteClipboardProcessingLabel" class="slds-text-align_center">Processing...</p>
																	</div>
																</div>
																<div class="slds-p-horizontal--large slds-p-bottom--large">
																	<div class="flex-row">
																		<div class="flex-grow-1"></div>
																		<div>
																			<button id="shapeBuilderPasteClipboardCancelButton" class="slds-button slds-button_neutral js-hide-shape-builder-paste-clipboard">Cancel</button>
																			<button id="shapeBuilderPasteClipboardProcessingButton" class="slds-button slds-button_brand js-show-shape-builder-paste-clipboard-processing">Process Shapes</button>
																		</div>
																	</div>
																</div>
															</div>
															<div id="shapeBuilderPasteClipboardErrorWrap" class="slds-p-top--medium slds-p-horizontal--large" style="display:none;">
																<div class="slds-box slds-box_x-small slds-theme_shade slds-m-bottom--small">
																	<div class="slds-p-bottom--small slds-text-color_weak">
																		<span class="slds-text-color_default">314</span> ZIP Codes successfully added.
																	</div>
																	<div class="slds-p-bottom--xx-small slds-text-color_error">
																		<span>84</span> errors:
																	</div>
																	<div class="slds-box slds-box_x-small slds-theme_default slds-scrollable_y" style="max-height:100px;">
																		28205
																		<br/> 28205
																		<br/> 28205
																		<br/> 28205
																		<br/> 28205
																		<br/> 28205
																		<br/> 28205
																		<br/> 28205
																		<br/> 28205
																		<br/> 28205
																		<br/> 28205
																		<br/> 28205
																		<br/>
																	</div>
																</div>
																<div class="slds-text-align_right slds-p-bottom--small">
																	<button class="slds-button slds-button_neutral js-hide-shape-builder-paste-error-wrap">Dismiss</button>
																</div>
															</div>
														</div>
														<div id="shapeBuilderPasteClipboardGuidelines" class="slds-popover__body" style="display:none;">
															<div class="slds-p-around--large">
																<h3 class="slds-text-heading_small slds-p-bottom--x-small">Formatting Guidelines</h3>
																<p class="slds-text-body_small slds-text-color_weak slds-m-bottom--medium">Set up your boundaries by separating them with a comma or a line break. Examples below.</p>
																<div class="flex-row slds-p-bottom--medium">
																	<div class="width-50percent slds-p-right--xx-small">
																		<div>Comma</div>
																		<div class="slds-box slds-theme_shade">
																			<p class="slds-text-body_small slds-text-color_weak">28205, 28206, 28207<br/><br/></p>
																		</div>
																	</div>
																	<div class="width-50percent slds-p-left--xx-small">
																		<div>Line Break</div>
																		<div class="slds-box slds-theme_shade">
																			<p class="slds-text-body_small slds-text-color_weak">28205<br/> 28206<br/> 28207</p>
																		</div>
																	</div>
																</div>
																<div>
																	<button class="slds-button slds-button_neutral js-show-shape-builder-paste-clipboard-guidelines js-hide-shape-builder-paste-clipboard-guidelines">
																		<div class="slds-button__icon slds-button__icon_left ma-icon ma-icon-check "></div>
																		Got It
																		</button>
																</div>
															</div>
														</div>
													</section>
												</div>
											</div>
										</div>
									</div>
									<div class="flex-grow-1 flex-column flex-grow-1">
										<div class="flex-row flex-grow-1">
											<div class="width-33percent flex-column flex-grow-1">
												<div class="flex-shrink-0 flex-grow-1 slds-p-vertical--medium slds-p-right--small slds-p-left--large">
													<div class="slds-form slds-form--stacked slds-m-bottom--x-small">
														<div class="slds-form-element">
															<label class="slds-form-element__label" for="shapeLayerBuilderInputCountry">Country</label>
															<div class="slds-form-element__control select2-fluid">
																<div class="slds-select_container">
																	<select class="slds-select select2-input territory-country" id="shapeLayerBuilderInputCountry">

																		</select>
																</div>
															</div>
														</div>
														<div class="slds-form-element">
															<label class="slds-form-element__label" for="shapeLayerBuilderInputIWantToSee">I Want To See...</label>
															<div class="slds-form-element__control select2-fluid slds-is-relative">
																<div class="slds-select_container">
																	<select id="shapeLayerBuilderInputIWantToSee" class="slds-select select2-input">


																		</select>
																</div>
																<div id="shapeBuilderIWantToSeeTooltip" class="slds-popover slds-popover_tooltip slds-nubbin_left-top" role="tooltip">
																	<div class="slds-popover__body">
																		Select what shape type you want to see on the map.
																		<br/><br/> e.g. I want to see <strong>ZIP Codes</strong>.
																	</div>
																</div>
															</div>
														</div>
													</div>
													<div id="shapeBuilderFiltersDrawOnMapWrap" class="slds-p-bottom--medium" style="display:none;">
														<button class="slds-button slds-button--neutral js-show-shape-builder-drawing-mode">
															<div class="slds-button__icon slds-button__icon--left ma-icon ma-icon-lasso"></div>
															Draw on Map
															</button>
													</div>
													<div id="shapeBuilderFiltersWrap" style="display:none;">
														<div class="slds-filters">
															<h3 class="slds-text-body_small slds-m-vertical_x-small">Matching all these filters</h3>
															<ol id="filterItemList" class="slds-list_vertical slds-list_vertical-space">
																<li id="filterItemExample1" class="slds-item slds-hint-parent" style="display:none;">
																	<div id="filterExample1Item" class="slds-filters__item slds-grid slds-grid_vertical-align-center slds-is-relative slds-is-new">
																		<button href="javascript:void(0);" class="slds-button_reset slds-grow slds-has-blur-focus">
    																		<div class="filter-example-content-complete" style="display:none;">
    																			<span class="slds-assistive-text">Edit filter:</span>
    																			<p class="slds-text-body_small">County</p>
    																			<p>equals "Mecklenburg, NC"</p>
    																		</div>
    																		<div class="filter-example-content-new">
    																			New Filter
    																		</div>
																		</button>
																		<button class="slds-button slds-button_icon slds-button_icon slds-button_icon-small">
																		    <div class="slds-button__icon ma-icon ma-icon-remove slds-filters__item-remove-button"></div>
																		</button>
																	</div>
																</li>
															</ol>
														</div>
														<div class="slds-filters__footer slds-p-around--none slds-p-vertical--medium flex-row">
															<div class="slds-is-relative">
																<button id="shapeBuilderFiltersFooterAddFilterButton" class="slds-button_reset slds-text-link" href="javascript:void(0);">Add Filter</button>
																<div id="shapeBuilderAddFilterButtonTooltip" class="slds-popover slds-popover_tooltip slds-nubbin_left-top in" role="tooltip">
																	<div class="slds-popover__body" style="hyphens: none;">
																		Lets filter down what ZIP Codes you want to see.
																		<br/><br/> e.g. I want to see ZIP Codes filtered by <strong>County equals "Mecklenburg, NC"</strong>.
																	</div>
																</div>
															</div>
															<div class="flex-grow-1"></div>
															<div id="shapeBuilderFiltersFooterRemoveButton" style="display:none;">
																<button class="slds-button_reset slds-text-link slds-col_bump-left remove-all-shape-filters" href="javascript:void(0);">Remove All</button>
															</div>
														</div>
													</div>
												</div>
											</div>
											<!--moving the filter outside of the scrollable area fix-->
											<div id="filterExample1" class="slds-filters__item-popover slds-filters__item-popover-positioner-left-bottom slds-is-fixed" style="display:none;">
												<section class="slds-popover slds-popover_panel slds-nubbin_left-bottom slds-popover_large">
													<div class="slds-p-around--large filter-form-container">
														<div class="slds-p-top--medium">
															<div class="flex-row">
																<div class="flex-grow-1"></div>
																<div>
																	<button class="slds-button slds-button_neutral js-slds-filters__item-popover-done-button">Done</button>
																</div>
															</div>
														</div>
													</div>
												</section>
											</div>
											<div id="shapeBuilderAvailableShapesColumn" class="width-33percent flex-column">
												<div class="flex-column flex-grow-1 slds-p-vertical--medium slds-p-left--small slds-p-right--large">
													<div class="flex-column flex-grow-1">
														<div class="flex-shrink-0">
															<label class="slds-form-element__label" for="shapeLayerBuilderInputCountry">Available Shapes</label>
														</div>
														<div class="flex-grow-1 flex-column">
															<div class="slds-dueling-list__header">
																<div class="slds-p-horizontal--small slds-p-vertical--x-small">
																	<div class="flex-row">
																		<div>
																			Select <a href="javascript:void(0);" onclick="selectAllOptions('#shapeBuilderAvailableShapesColumn')">All</a> / <a href="javascript:void(0);" onclick="deselectAllOptions('#shapeBuilderAvailableShapesColumn')">None</a>
																		</div>
																	</div>
																</div>
															</div>
															<div class="slds-dueling-list has-dueling-list-header slds-is-relative flex-column flex-grow-1">
																<div id="shapeSelectionDuelingPicklistButtonPositioner">
																	<div class="flex-column">
																		<div class="slds-p-bottom--medium">
																			<button id="shapeBuilderShapeSelectionMoveTo" class="slds-button slds-button_icon slds-button_icon-border slds-button_icon-border-filled">
																					<div class="slds-button__icon ma-icon ma-icon-right"></div>
																				</button>
																		</div>
																		<div>
																			<button id="shapeBuilderShapeSelectionRemoveFrom" class="slds-button slds-button_icon slds-button_icon-border slds-button_icon-border-filled">
																					<div class="slds-button__icon ma-icon ma-icon-left"></div>
																				</button>
																		</div>
																	</div>
																</div>
																<div class="flex-column flex-grow-1 slds-form-element multiselect-has-header" style="width:100%;">
																	<div class="flex-column flex-grow-1 slds-form-element__control slds-is-relative">
																		<select class="slds-select" size="999" multiple="multiple" style="overflow-y:auto;">

	    																	</select>
																		<div id="shapeBuilderAvailableShapesSpinner" class="slds-spinner_container" style="display:none;left: 1px;top: 1px;height: calc(100% - 2px);width: calc(100% - 2px);border-radius: 0 0 4px 4px;">
																			<div role="status" class="slds-spinner slds-spinner_medium slds-spinner_brand">
																				<span class="slds-assistive-text">Loading</span>
																				<div class="slds-spinner__dot-a"></div>
																				<div class="slds-spinner__dot-b"></div>
																			</div>
																		</div>
																		<div id="shapeBuilderAvailableFilterCue">
																			<div class="slds-text-align_center">
																				<div class="slds-p-bottom_medium">
																					<span class="slds-icon_container ma-icon ma-icon-info"></span>
																				</div>
																				<div class="slds-text-color_weak">
																					The shape type you want to see returns a large number of results. Please add a filter to narrow down the available shapes.
																				</div>
																			</div>
																		</div>
																	</div>
																</div>
															</div>
														</div>
													</div>
												</div>
											</div>
											<div id="shapeBuilderSelectedShapesColumn" class="width-33percent flex-column">
												<div class="flex-column slds-p-vertical--medium slds-p-horizontal--large">
													<div class="flex-column">
														<div class="flex-shrink-0">
															<label class="slds-form-element__label" for="shapeLayerBuilderInputCountry">Selected Shapes</label>
														</div>
														<div class="flex-grow-1 flex-column slds-is-relative">
															<div class="slds-dueling-list__header">
																<div class="slds-p-horizontal--small slds-p-vertical--x-small">
																	<div class="flex-row">
																		<div>
																			Select <a href="javascript:void(0);" onclick="selectAllOptions('#shapeBuilderSelectedShapesColumn')">All</a> / <a href="javascript:void(0);" onclick="deselectAllOptions('#shapeBuilderSelectedShapesColumn')">None</a>
																		</div>
																	</div>
																</div>
															</div>
															<div class="flex-column slds-form-element multiselect-has-header">
																<div class="flex-column slds-form-element__control">
																	<select class="slds-select" size="999" multiple="multiple" style="overflow-y:auto;">

																		</select>
																</div>
															</div>
															<div id="shapeBuilderPasteClipboardProcessingSuccessTooltip" class="slds-popover slds-popover_tooltip slds-nubbin_right-top" role="tooltip">
																<button class="slds-button slds-button_icon slds-button_icon-small slds-float_right slds-popover__close slds-button_icon-inverse">
																	<div class="slds-button__icon ma-icon ma-icon-close"></div>
																	</button>
																<div class="slds-popover__body" style="padding-right: 32px;">
																	<div class="flex-row align-items-center">
																		<div class="slds-p-right--small slds-p-left--xxx-small">
																			<span class="slds-icon_container">
																					<div class="slds-icon slds-icon-text-default slds-icon_small ma-icon ma-icon-check" style="color:#4bca81;font-size:20px;"></div>
																				</span>
																		</div>
																		<div class="flex-grow-1" style="hyphens:none;">
																			<!--<div>Your pasted shapes were successfully processed and added to your selection.</div>-->
																			<div>Correctly formatted ZIP codes have been successfully processed and added to your selection.</div>
																			<br></br>
																			<div class="js-import-results">

																			</div>
																		</div>
																	</div>
																</div>
															</div>
														</div>
													</div>
												</div>
											</div>
										</div>
									</div>
								</div>
							</div>
							<div id="shapeLayerBuilderTabDisplay" class="slds-navigation-content-area slds-hide">
								<!--Color Pane -->
								<div class='tab-color-geometry' id='tab-color-geometry'>
									<div class='tab-color-geometry-content slds-p-around_large'>
										<table style="width: 100%;">
											<tr>
												<td>
													<table class='boundary-color-header'>
														<tr>
															<th colspan="2" style="padding-top:0;">
																<h3 class="slds-text-heading_small" style="font-weight: normal;padding-top:0;margin-top:0;">
	                                                    {!$Label.MATerritoryBuilder_Color_Selection}
	                                                </h3>
															</th>
														</tr>
														<tr>
															<td>
																<label class="slds-form-element__label">
	                                                    {!$Label.MATerritoryBuilder_Fill_Color}
	                                                </label>
															</td>
															<td class="slds-p-bottom_xx-small">
																<input id="shapelayer-shape-fill-color-input" class="color fillcolor boundary-style slds-input" style="background-color: rgb(22, 50, 92); color: rgb(255, 255, 255);" type="text" autocomplete="off" value="#16325C" onchange="ShapeLayerUpdatePreview();"
																/>
															</td>
														</tr>
														<tr>
															<td>
																<label class="slds-form-element__label">
	                                                    {!$Label.MATerritoryBuilder_Border_Color}
	                                                </label>
															</td>
															<td class="slds-p-bottom_xx-small">
																<input id="shapelayer-border-fill-color-input" class="color bordercolor boundary-style slds-input" style="background-color: rgb(48, 131, 211); color: rgb(255, 255, 255);" type="text" autocomplete="off" value="#3083d3" onchange="ShapeLayerUpdatePreview();"
																/>
															</td>
														</tr>
														<tr>
															<td>
																<label class="slds-form-element__label">
	                                                    {!$Label.MATerritoryBuilder_Opacity}
	                                                </label>
															</td>
															<td class="slds-p-bottom_xx-small">
																<select id="shapelayer-shape-fill-opacity-input" class="fillopacity slds-select" onchange="ShapeLayerUpdatePreview();">
				                                                    <option value="0.1">10%</option>
				                                                    <option value="0.2">20%</option>
				                                                    <option value="0.3">30%</option>
				                                                    <option value="0.4">40%</option>
				                                                    <option value="0.5">50%</option>
				                                                    <option value="0.6">60%</option>
				                                                    <option value="0.7">70%</option>
				                                                    <option value="0.8">80%</option>
				                                                    <option value="0.9">90%</option>
				                                                    <option value="1.0">100%</option>
				                                                </select>
																<!--<input class="fillopacity boundary-style" type="text" value=""/>-->
															</td>
														</tr>
														<tr>
															<th colspan="2" style="padding: 16px 0 12px;">
																<h3 class="slds-text-heading_small" style="font-weight: normal;">
	                                                    {!$Label.MATerritoryBuilder_Label_Options}
	                                                </h3>
															</th>
														</tr>
														<tr>
															<td>
																<label class="slds-form-element__label">
	                                                    {!$Label.MATerritoryBuilder_Label_Enable}
	                                                </label>
															</td>
															<td class="slds-p-bottom_xx-small">
																<!--<input type='checkbox' id="shapelayer-label-enabled" onchange="ShapeLayerUpdatePreview();" />-->

																<span class="slds-checkbox">
	                                                  <input type="checkbox" id="shapelayer-label-enabled" onchange="ShapeLayerUpdatePreview();" />
	                                                  <label class="slds-checkbox__label" for="shapelayer-label-enabled">
	                                                    <span class="slds-checkbox_faux"></span>
																<span class="slds-form-element__label"> </span>
																</label>
																</span>
															</td>
														</tr>
														<tr>
															<td>
																<label class="slds-form-element__label">
	                                                    {!$Label.MATerritoryBuilder_Label_TextOverride}
	                                                </label>
															</td>
															<td class="slds-p-bottom_xx-small">
																<input class="label-text-override-input slds-input" type="text" value="" id="shapelayer-label-override" />
															</td>
														</tr>
														<tr>
															<td>
																<label class="slds-form-element__label">
	                                                    {!$Label.MATerritoryBuilder_Label_Justification}
	                                                </label>
															</td>
															<td class="slds-p-bottom_xx-small">
																<select id="shapelayer-label-justification" class="slds-select" onchange="ShapeLayerUpdatePreview();">
	                                                    <option value="left">Left</option>
	                                                    <option value="center" selected="selected">Center</option>
	                                                    <option value="right">Right</option>
	                                                </select>
															</td>
														</tr>
														<tr>
															<td>
																<label class="slds-form-element__label">
	                                                    {!$Label.MATerritoryBuilder_Label_FontSize}
	                                                </label>
															</td>
															<td class="slds-p-bottom_xx-small">
																<select id="shapelayer-label-font-size" class="slds-select" onchange="ShapeLayerUpdatePreview();">
				                                                    <option>8px</option>
				                                                    <option>9px</option>
				                                                    <option selected="selected">10px</option>
				                                                    <option>11px</option>
				                                                    <option>12px</option>
				                                                    <option>13px</option>
				                                                    <option>14px</option>
				                                                    <option>15px</option>
				                                                    <option>16px</option>
				                                                    <option>17px</option>
				                                                    <option>18px</option>
				                                                </select>
															</td>
														</tr>
														<tr>
															<td>
																<label class="slds-form-element__label">
	                                                    {!$Label.MATerritoryBuilder_Label_FontColor}
	                                                </label>
															</td>
															<td class="slds-p-bottom_xx-small">
																<input id="shapelayer-label-font-color" class="color boundary-style slds-input" style="background-color: rgb(255, 255, 255); color: rgb(255, 255, 255);" type="text" autocomplete="off" value="#FFFFFF" onchange="ShapeLayerUpdatePreview();" />
															</td>
														</tr>
														<tr>
															<td>
																<label class="slds-form-element__label">
	                                                    {!$Label.MATerritoryBuilder_Label_BGColor}
	                                                </label>
															</td>
															<td class="slds-p-bottom_xx-small">
																<input id="shapelayer-label-bg-color" class="color boundary-style slds-input" style="background-color: rgb(0, 0, 0); color: rgb(255, 255, 255);" type="text" autocomplete="off" value="#000000" onchange="ShapeLayerUpdatePreview();" />
															</td>
														</tr>
														<tr>
															<td>
																<label class="slds-form-element__label">
	                                                    {!$Label.MATerritoryBuilder_Label_BGOpacity}
	                                                </label>
															</td>
															<td class="slds-p-bottom_xx-small">
																<select id="shapelayer-label-bg-opacity" class="slds-select" onchange="ShapeLayerUpdatePreview();">
				                                                    <option value="0.1">10%</option>
				                                                    <option value="0.2">20%</option>
				                                                    <option value="0.3" selected="selected">30%</option>
				                                                    <option value="0.4">40%</option>
				                                                    <option value="0.5">50%</option>
				                                                    <option value="0.6">60%</option>
				                                                    <option value="0.7">70%</option>
				                                                    <option value="0.8">80%</option>
				                                                    <option value="0.9">90%</option>
				                                                    <option value="1.0">100%</option>
				                                                </select>
															</td>
														</tr>
														<tr>
															<th colspan="2" style="padding: 16px 0 12px;">
																<h3 class="slds-text-heading_small" style="font-weight: normal;">
				                                                    {!$Label.MATerritoryBuilder_AdvancedOptions}
				                                                </h3>
															</th>
														</tr>
														<tr>
															<td colspan="2" class="slds-p-bottom_xx-small">
																<span class="slds-checkbox">
																	<input type="checkbox" id="shapelayer-advanced-dissolve-enabled" class='dissolve-geometry' onchange="ShapeLayerUpdatePreview();" />
																	<label class="slds-checkbox__label" for="shapelayer-advanced-dissolve-enabled">
																		<span class="slds-checkbox_faux"></span>
																		<span class="slds-form-element__label"> &nbsp;{!$Label.MA_Dissolve_Geometry}</span>
																	</label>
																</span>
															</td>
														</tr>
													</table>
												</td>
												<td>
													<div id="shapelayer_preview_map" style="width: 470px;height: 390px;float:right;"></div>
												</td>
											</tr>
										</table>
									</div>
								</div>
								<!-- End Options Pane -->
							</div>
						</div>
					</div>
				</div>
				<div class="slds-modal__footer">
					<button class="slds-button slds-button--neutral" onclick="cancelTerritoryCreation();">Cancel</button>
					<button class="slds-button slds-button_brand save-boundary" onclick="saveBoundary();">Save &amp; Close</button>
					<button class="slds-button slds-button_brand save-boundary" onclick="saveBoundary(true);">Save &amp; Plot</button>
				</div>
			</div>
		</div>
	</div>

	<div id="shapeBuilderBackdropPositioner" class="slds-scope">
	    <div id="CreateTerritoryPopupBackdrop" class="slds-modal-backdrop"></div><!-- slds-modal-backdrop--open-->
	</div>

	<div id="shapeBuilderDrawingPanelPositioner" class="slds-scope">
		<div id="shapeBuilderDrawingModePanelWrap" class=""><!--in-->
		<div class="flex-column full-height">
			<div class="slds-p-vertical--x-small slds-p-horizontal--medium" style="background-color: #f4f6f9;border-bottom: 1px solid #d8dde6;">
				<div class="flex-row align-items-center">
					<div>
						<button class="slds-button slds-button_neutral js-show-shape-builder-manual-mode">
							<div class="slds-button__icon slds-button__icon_left ma-icon ma-icon-back"></div>
							Back to Full Editor
						</button>
					</div>
				</div>
			</div>
			<div class="slds-p-around--medium flex-shrink-0">
				<div class="flex-grow-1"></div>
				<div>
					<!-- <h3 class="slds-text-heading_small">Southeast Territory</h3> -->
					<div class="slds-form-element">
						<label class="slds-form-element__label" for="shapeBuilderDetailsName"> <abbr class="slds-required" title="required">*</abbr>Name</label>
						<div class="slds-form-element__control slds-is-relative">
							<input type="text" id="shapeBuilderDetailsNameDrawingMode" class="slds-input" placeholder="ex. Southeast Territory" />
							<div id="shapeBuilderDrawingModeNameTooltip" class="slds-popover slds-popover_tooltip slds-nubbin_right" role="tooltip">
								<div class="slds-popover__body">
									Name your new Shape Layer
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="slds-p-horizontal--medium slds-p-bottom--medium flex-column flex-grow-1">
				<label class="slds-form-element__label" for="shapeBuilderDetailsName">Shape Selection</label>
				<div class="slds-dueling-list__header">
					<div class="slds-p-horizontal--small slds-p-vertical--x-small">
						<div class="flex-row">
							<div>
								Select <a href="javascript:void(0);" id="shapeBuilderDrawingSelectionSelectAll">All</a> / <a href="javascript:void(0);" id="shapeBuilderDrawingSelectionSelectNone">None</a>
							</div>
						</div>
					</div>
				</div>
				<div class="slds-dueling-list has-dueling-list-header">
					<div class="slds-dueling-list__column width-100percent">
						<div class="slds-dueling-list__options slds-dueling-list__options-auto-height blue-selection width-100percent slds-is-relative" role="application">
							<ul id="shapeBuilderDrawingSelectionList" aria-describedby="option-drag-label" aria-labelledby="label-49" aria-multiselectable="true" class="slds-listbox slds-listbox_vertical" role="listbox" tabindex="0">

								<!-- the following is an example of the rendered li element-->
								<!--<li role="presentation" class="slds-listbox__item slds-is-selected">
									<span class="slds-listbox__option slds-listbox__option_plain slds-media" aria-selected="false" draggable="true" role="option" tabindex="0">
										<span class="slds-truncate" title="Option 1">
											<span class="slds-icon slds-icon_selected slds-icon_x-small slds-icon-text-default slds-m-right_x-small ma-icon ma-icon-check"></span>
											28205
										</span>
									</span>
								</li>-->

							</ul>
							<div id="shapeBuilderDrawingSelectionListSpinner" class="slds-spinner_container" style="display:none;">
								<div role="status" class="slds-spinner slds-spinner_medium slds-spinner_brand">
									<span class="slds-assistive-text">Loading</span>
									<div class="slds-spinner__dot-a"></div>
									<div class="slds-spinner__dot-b"></div>
								</div>
							</div>
						</div>
					</div>
				</div>
				<div class="flex-shrink-0 slds-p-top--x-small slds-text-color_weak">
					(<span id="shapeBuilderDrawingSelectionCount">3</span>) shapes selected
				</div>
			</div>
			<div class="flex-shrink-0">
				<div class="flex-row slds-p-vertical--x-small slds-p-horizontal--medium" style="background-color: #f4f6f9;border-top: 1px solid #d8dde6;">
					<div class="flex-grow-1"></div>
					<div>
						<button class="slds-button slds-button_neutral" onclick="cancelTerritoryCreation();">Cancel</button>
					</div>
					<div style="display:none;" class="slds-p-left--x-small">
						<button id="shapeBuilderDrawingSaveAndNew" class="slds-button slds-button_brand">Save &amp; New</button>
					</div>
					<div class="slds-p-left--x-small">
						<button id="shapeBuilderDrawingSaveAndPlot" class="slds-button slds-button_brand">Save &amp; Plot</button>
					</div>
				</div>
			</div>
		</div>
	</div>
    </div>

    <div id="shapeBuilderDrawingToolsPositioner" class="slds-scope">
	    <div id="shapeBuilderDrawingModeTools" class=""><!--in-->
	<div class="slds-button-group slds-button-group--shadow" role="group">
		<button id="shapeBuilderButtonLassoPlus" class="slds-button slds-button_icon slds-button_icon-large-icon slds-button_icon-border-filled shape-builder-drawing-tool-button no-focus-styling has-hover-tooltip slds-is-active">
		<div class="slds-button__icon ma-icon ma-icon-lasso-plus"></div>
		<div class="slds-popover slds-popover_tooltip slds-nubbin_top-right shape-builder-drawing-button-tooltip" role="tooltip">
			<div class="slds-popover__body">
				Add to your selection by drawing a circle around shapes
				<div class="slds-text-body_small slds-m-top--small tooltip-action-instruction">Click &#43; Hold to draw</div>
				<!--<div class="slds-text-body_small slds-m-top--xx-small tooltip-action-instruction">Hold the [Shift] key to toggle the default cursor</div>-->
			</div>
		</div>
		</button>
		<button id="shapeBuilderButtonLassoMinus" class="slds-button slds-button_icon slds-button_icon-large-icon slds-button_icon-border-filled shape-builder-drawing-tool-button no-focus-styling has-hover-tooltip">
		<div class="slds-button__icon ma-icon ma-icon-lasso-minus"></div>
		<div class="slds-popover slds-popover_tooltip slds-nubbin_top-right shape-builder-drawing-button-tooltip" role="tooltip">
			<div class="slds-popover__body">
				Remove from your selection by drawing a circle around shapes
				<div class="slds-text-body_small slds-m-top--small tooltip-action-instruction">Click &#43; Hold to draw</div>
				<!--<div class="slds-text-body_small slds-m-top--xx-small tooltip-action-instruction">Hold the [Shift] key to toggle the default cursor</div>-->
			</div>
		</div>
		</button>
		<button id="shapeBuilderButtonLassoToggle" class="slds-button slds-button_icon slds-button_icon-large-icon slds-button_icon-border-filled shape-builder-drawing-tool-button no-focus-styling has-hover-tooltip">
		<div class="slds-button__icon ma-icon ma-icon-lasso-toggle"></div>
		<div class="slds-popover slds-popover_tooltip slds-nubbin_top-right shape-builder-drawing-button-tooltip" role="tooltip">
			<div class="slds-popover__body">
				Click individual shapes to toggle their selection
				<!--<div class="slds-text-body_small slds-m-top--small tooltip-action-instruction">Hold the [Shift] key to toggle the default cursor</div>-->
			</div>
		</div>
		</button>
		<button id="shapeBuilderButtonDefaultPointer" class="slds-button slds-button_icon slds-button_icon-border-filled shape-builder-drawing-tool-button no-focus-styling has-hover-tooltip">
		<div class="slds-button__icon ma-icon ma-icon-hand"></div>
		<div class="slds-popover slds-popover_tooltip slds-nubbin_top-right shape-builder-drawing-button-tooltip" role="tooltip">
			<div class="slds-popover__body">
				Default map cursor
			</div>
		</div>
		</button>
	</div>
</div>
    </div>

    <!-- Templates -->
    <div id='TerritoryBuilder-Templates' style='display: none;'>

        <!-- Search Wrapper -->
        <div class='search-wrapper'>
            <input type='text' class='search-input' />
            <img class='search-loading' src="{!URLFOR($Resource.MapAnything, 'images/chatter-loader.gif')}" style='display:none' />
            <img class='search-button' src="{!URLFOR($Resource.MapAnything, 'images/ui-icons/search-icon.png')}" />
            <div class='search-menu' style='display:none;'></div>
        </div>

        <!-- Results div when selecting area -->
        <div class='autocomplete-selection'>
            <span class='result-text'></span>
            <span class='result-remove'>x</span>
        </div>

        <!-- Return templates for each area -->
        <div class='boundary-cell' data-adminlevel=''>
            <div class='icon'><img class="territory-selector-img" /></div>
            <div class='info'><div class='title'></div><div class='subtitle'></div></div>
            <div class='checkbox'></div>
        </div>

        <!-- SVG Shape Icon -->
        <svg class='svg-shape-icon' width="20" height="20" preserveAspectRatio="xMidYMid meet">
            <g>
                <path id="svg_10" d="m2.75,17.25c0,0 10,0 10,0c0,0 4.75,-8 4.75,-8c0,0 -3.5,-5 -3.5,-5c0,0 -6.75,-2 -6.75,-2c0,0 -4.5,4.25 -4.5,4.25c0,0 0,10.75 0,10.75z" opacity="0.55" stroke-width="2" stroke="__BorderColor__" fill="__FillColor__"/>
                <ellipse fill="__BorderColor__" stroke="__BorderColor__" stroke-width="0" cx="3" cy="17.25" id="svg_1" rx="2" ry="2"/>
                <ellipse fill="__BorderColor__" stroke="__BorderColor__" stroke-width="0" cx="2.75" cy="6.75" rx="2" ry="2" id="svg_3"/>
                <ellipse fill="__BorderColor__" stroke="__BorderColor__" stroke-width="0" cx="7.25" cy="2.25" rx="2" ry="2" id="svg_4"/>
                <ellipse fill="__BorderColor__" stroke="__BorderColor__" stroke-width="0" cx="14" cy="4" rx="2" ry="2" id="svg_5"/>
                <ellipse fill="__BorderColor__" stroke="__BorderColor__" stroke-width="0" cx="17.75" cy="9.5" rx="2" ry="2" id="svg_6"/>
                <ellipse fill="__BorderColor__" stroke="__BorderColor__" stroke-width="0" cx="13" cy="17.25" rx="2" ry="2" id="svg_7"/>
            </g>
        </svg>

    </div>
    <div id="shapeLayerEditorTemplates" style="display:none;">

        <div class="shape-filter-template js-shape-filter-wrapper">
            <div class="slds-form slds-form_stacked">
    			<div class="slds-form-element">
    				<label class="slds-form-element__label">Field</label>
    				<div class="slds-form-element__control select2-fluid">
    					<div class="slds-select_container">
    						<select class="slds-select select2-input field-select">
    							<optgroup label="Political Boundaries">

    							</optgroup>
    							<optgroup label="Data Metrics">

    							</optgroup>
    						</select>
    					</div>
    				</div>
    			</div>
    			<div class="slds-form-element">
    				<label class="slds-form-element__label">Operator</label>
    				<div class="slds-form-element__control select2-fluid">
    					<div class="slds-select_container">
    						<select class="slds-select select2-input operator-select">
    							<option selected="selected">equals</option>
    							<option>less than</option>
    							<option>greater than</option>
    						</select>
    					</div>
    				</div>
    			</div>
    			<div class="slds-form-element">
    				<label class="slds-form-element__label string-label">Value</label>
    				<label class="slds-form-element__label range-label" style="display:none;">Min</label>
    				<input id="filterItemValueInput" class="slds-input min" type="text" />
    				<div id="filterItemValueDropdown" class="slds-dropdown slds-dropdown_left slds-is-absolute" style="display:none;min-height:100px;max-height:500px;overflow-y:scroll">
    					<ul class="slds-dropdown__list" role="menu">

    					</ul>
    					<div class="slds-spinner_container" id="shapeFilterSpinner" style="left: 1px; top: 1px; height: calc(100% - 2px); width: calc(100% - 2px); border-radius: 0px 0px 4px 4px; display: block;">
							<div class="slds-spinner slds-spinner_medium slds-spinner_brand" role="status">
								<span class="slds-assistive-text">Loading</span>
								<div class="slds-spinner__dot-a"></div>
								<div class="slds-spinner__dot-b"></div>
							</div>
						</div>
    				</div>
    				<label class="slds-form-element__label range-label" style="display:none;">Max</label>
    				<input id="MaxValueInput" class="slds-input max" type="text" style="display:none;"/>

    				<div class="slds-p-top--xx-small filter-item-pills" style="display:none;">
    					<!--<span class="slds-pill slds-pill_link">
    						<a href="javascript:void(0);" class="slds-pill__action" title="Full pill label verbiage mirrored here">
    							<span class="slds-pill__label">Mecklenburg, NC</span>
    						</a>
    						<button class="slds-button slds-button_icon slds-button_icon slds-pill__remove" title="Remove">
    						<div class="slds-button__icon ma-icon ma-icon-remove"></div>
    						</button>
    					</span>-->
    				</div>
    			</div>
    		</div>
            <div class="slds-p-top--medium">
    			<div class="flex-row">
    				<div class="flex-grow-1"></div>
    				<div>
    				    <button class="slds-button slds-button_neutral js-slds-filters__item-popover-cancel-button">Cancel</button>
    					<button class="slds-button slds-button_neutral js-slds-filters__item-popover-done-button">Done</button>
    				</div>
    			</div>
    		</div>
        </div>

        <ul id="filter-items-list-template">
            <li class="slds-item slds-hint-parent filter-list-item" style="display:none;">
				<div class="slds-filters__item slds-grid slds-grid_vertical-align-center slds-is-relative slds-is-new filter-item">
					<button href="javascript:void(0);" class="slds-button_reset slds-grow slds-has-blur-focus">
						<div class="filter-content-complete" style="display:none;">
							<span class="slds-assistive-text">Edit filter:</span>
							<p class="slds-text-body_small field-label"></p>
							<p class='filters-from-pills'></p>
						</div>
						<div class="filter-content-new">
							New Filter
						</div>
					</button>
					<button class="slds-button slds-button_icon slds-button_icon slds-button_icon-small js-remove-filter-item">
					    <div class="slds-button__icon ma-icon ma-icon-remove slds-filters__item-remove-button remove-filter-item"></div>
					</button>
				</div>
			</li>

        </ul>

        <ul id="lasso-list-item-template">
            <li role="presentation" class="slds-listbox__item slds-is-selected lasso-list-item">
				<span class="slds-listbox__option slds-listbox__option_plain slds-media" aria-selected="false" draggable="true" role="option" tabindex="0">
					<span class="slds-truncate" title="Option 1">
						<span class="slds-icon slds-icon_selected slds-icon_x-small slds-icon-text-default slds-m-right_x-small ma-icon ma-icon-check"></span>
						<span class='list-item-label'></span>
					</span>
				</span>
			</li>

        </ul>

    </div>
    <!-- Tutorial Content -->


    <!-- Tutorial Content -->
    <div id='MATutorial-Content' class='popup_block' style='max-height: 550px !important;'>
        <div class='loadmask-wrapper'>

            <!-- Close Button -->
            <a class='closebtn' onclick="ClosePopupWindow();">X</a>

            <!-- Steps -->
            <div id='MATutorial-Steps'>

                <!-- Step: Base Object Selection -->
                <div id='MATutorial-Steps-BaseObjectSelection'>

                    <!-- Header -->
                    <h2>{!$Label.MATutorial_Welcome}</h2>

                    <!-- Instructions -->
                    <p class='popup-instructions'>{!$Label.MATutorial_Popup_Instructions}</p>

                    <!-- Content -->
                    <table id='MATutorial-BaseObjects' class='grid-blue'>
                        <tr>
                            <th>{!$Label.MATutorial_Available_Base_Objects}</th>
                            <th style='text-align: center;'><span style='font-size: 10px; cursor: pointer;' onclick='$("#MATutorial-BaseObjects .data").removeClass("unchecked").addClass("checked");'>All</span> | <span style='font-size: 10px; cursor: pointer;' onclick='$("#MATutorial-BaseObjects .data").removeClass("checked").addClass("unchecked");'>None</span></th>
                        </tr>
                        <tr class='baseobject-row standard' data-baseobject='Account'>
                            <td class='label'>
                                <div class='name'>{!$Label.MA_Account}</div>
                                <div class='fields'>{!$Label.MA_Billing_Street}, {!$Label.MA_Billing_City}, {!$Label.MA_Billing_State}, {!$Label.MA_Billing_Postal_Code}, {!$Label.MA_Billing_Country}</div>
                                <div class='fields'>{!$Label.MA_Latitude}, {!$Label.MA_Longitude}</div>
                            </td>
                            <td class='data checked'><div></div></td>
                        </tr>
                        <tr class='baseobject-row standard' data-baseobject='Contact'>
                            <td class='label'>
                                <div class='name'>{!$Label.MA_Contact}</div>
                                <div class='fields'>{!$Label.MA_Account}: {!$Label.MA_Billing_Street}, {!$Label.MA_Billing_City}, {!$Label.MA_Billing_State}, {!$Label.MA_Billing_Postal_Code}, {!$Label.MA_Billing_Country}</div>
                                <div class='fields'>{!$Label.MA_Account}: {!$Label.MA_Latitude}, {!$Label.MA_Longitude}</div>
                            </td>
                            <td class='data checked'><div></div></td>
                        </tr>
                        <tr class='baseobject-row standard' data-baseobject='Lead'>
                            <td class='label'>
                                <div class='name'>{!$Label.MA_Lead}</div>
                                <div class='fields'>Street, City, State, Postal Code, Country</div>
                                <div class='fields'>{!$Label.MA_Latitude}, {!$Label.MA_Longitude}</div>
                            </td>
                            <td class='data checked'><div></div></td>
                        </tr>
                        <tr class='baseobject-row standard' data-baseobject='Opportunity'>
                            <td class='label'>
                                <div class='name'>{!$Label.MA_Opportunity}</div>
                                <div class='fields'>{!$Label.MA_Account}: {!$Label.MA_Billing_Street}, {!$Label.MA_Billing_City}, {!$Label.MA_Billing_State}, {!$Label.MA_Billing_Postal_Code}, {!$Label.MA_Billing_Country}</div>
                                <div class='fields'>{!$Label.MA_Account}: {!$Label.MA_Latitude}, {!$Label.MA_Longitude}</div>
                            </td>
                            <td class='data checked'><div></div></td>
                        </tr>
                        <tr class='baseobject-row standard' data-baseobject='Case'>
                            <td class='label'>
                                <div class='name'>{!$Label.MA_Case}</div>
                                <div class='fields'>{!$Label.MA_Account}: {!$Label.MA_Billing_Street}, {!$Label.MA_Billing_City}, {!$Label.MA_Billing_State}, {!$Label.MA_Billing_Postal_Code}, {!$Label.MA_Billing_Country}</div>
                                <div class='fields'>{!$Label.MA_Account}: {!$Label.MA_Latitude}, {!$Label.MA_Longitude}</div>
                            </td>
                            <td class='data checked'><div></div></td>
                        </tr>
                        <tr class='baseobject-row standard' data-baseobject='Task'>
                            <td class='label'>
                                <div class='name'>{!$Label.MA_Task}</div>
                                <div class='fields'>{!$Label.MA_Account}: {!$Label.MA_Billing_Street}, {!$Label.MA_Billing_City}, {!$Label.MA_Billing_State}, {!$Label.MA_Billing_Postal_Code}, {!$Label.MA_Billing_Country}</div>
                                <div class='fields'>{!$Label.MA_Account}: {!$Label.MA_Latitude}, {!$Label.MA_Longitude}</div>
                            </td>
                            <td class='data checked'><div></div></td>
                        </tr>
                    </table>

                    <!-- Spacer -->
                    <div style="height: 15px;">&nbsp;</div>

                    <!-- Buttons -->
                    <div class='buttons'>
                        <div class="bigbutton orange" onclick="MATutorial_Steps_BaseObjectSelection_Next();">{!$Label.MATutorial_Next}</div>
                    </div>

                </div>

                <!-- Step: Custom Configuration - Basic Info -->
                <div id='MATutorial-Steps-Custom-BasicInfo' style='display: none;'>

                    <!-- Header -->
                    <h2>{!$Label.MATutorial_Custom_Configuration}</h2>

                    <!-- Instructions -->
                    <p class='popup-instructions'>{!$Label.MATutorial_Custom_Popup_Instructions}</p>

                    <!-- Content -->
                    <table class='grid-blue'>
                        <tr><th colspan='2'>{!$Label.MATutorial_Basic_Info}</th></tr>
                        <tr><td>{!$Label.MA_Name}</td><td><input type='text' id='MATutorial-Steps-Custom-Name' /></td></tr>
                        <tr><td>Base Object</td><td><select id='MATutorial-Steps-Custom-Object' class='combobox'></select></td></tr>
                    </table>

                    <!-- Character Limit Disclaimer -->
                    <div style='font-size: 10px;color: #757575;font-style: italic;float: right;'>{!$Label.MATutorial_Character_Limit}</div>

                    <!-- Spacer -->
                    <div style='height: 15px;'>&nbsp;</div>

                    <!-- Buttons -->
                    <div class='buttons'>
                        <div class="bigbutton gray" style='float: left;' onclick="MATutorial_Steps_Custom_BasicInfo_Back();">{!$Label.MATutorial_Start_Over}</div>
                        <div class="bigbutton orange" onclick="MATutorial_Steps_Custom_BasicInfo_Next();">{!$Label.MATutorial_Next}</div>
                    </div>

                </div>

                <!-- Step: Custom Configuration - Field Map -->
                <div id='MATutorial-Steps-Custom-FieldMap' style='display: none;'>

                    <!-- Header -->
                    <h2>{!$Label.MATutorial_Custom_Field_Map}</h2>

                    <!-- Instructions -->
                    <p class='popup-instructions'>{!$Label.MATutorial_Custom_Field_Map_Instructions}</p>

                    <!-- Content -->
                    <table class='grid-blue'>
                        <tr>
                            <th>{!$Label.MA_Field}</th>
                            <th style='text-align: right;'><span style='font-size: 10px; cursor: pointer;' onclick='MATutorial_Steps_Custom_FieldMap_Suggest();'>Suggest</span></th>
                        </tr>
                        <tr><td>Address Location</td><td><select id='MATutorial-Steps-Custom-AddressLocation' class='combobox'></select></td></tr>
                        <tr><td>Street</td><td><select id='MATutorial-Steps-Custom-Street' class='combobox addressfield'></select></td></tr>
                        <tr><td>City</td><td><select id='MATutorial-Steps-Custom-City' class='combobox addressfield'></select></td></tr>
                        <tr><td>State</td><td><select id='MATutorial-Steps-Custom-State' class='combobox addressfield'></select></td></tr>
                        <tr><td>Postal Code</td><td><select id='MATutorial-Steps-Custom-PostalCode' class='combobox addressfield'></select></td></tr>
                        <tr><td>Country</td><td><select id='MATutorial-Steps-Custom-Country' class='combobox addressfield'></select></td></tr>
                        <tr><td>Latitude</td><td><select id='MATutorial-Steps-Custom-Latitude' class='combobox coordinatefield'></select></td></tr>
                        <tr><td>Longitude</td><td><select id='MATutorial-Steps-Custom-Longitude' class='combobox coordinatefield'></select></td></tr>
                    </table>

                    <!-- Spacer -->
                    <div style='height: 15px;'>&nbsp;</div>

                    <!-- Buttons -->
                    <div class='buttons'>
                        <div class="bigbutton gray" style='float: left;' onclick="MATutorial_Steps_Custom_FieldMap_Back();">{!$Label.MA_Back}</div>
                        <div class="bigbutton orange" onclick="MATutorial_Steps_Custom_FieldMap_Next();">{!$Label.MATutorial_Next}</div>
                    </div>

                </div>

                <!-- Step: Custom Configuration - Add Another -->
                <div id='MATutorial-Steps-Custom-AddAnother' style='display: none;'>

                    <!-- Header -->
                    <h2>{!$Label.MATutorial_Custom_Field_Instructions}</h2>

                    <!-- Instructions -->
                    <p class='popup-instructions'>{!$Label.MATutorial_Custom_Configuration_Popup_Finish}</p>

                    <!-- Content -->
                    <div>
                        <div class='bigbutton blue' style='width: 49%;' onclick='MATutorial_Steps_Custom_AddAnother_Yes();'>
                            <div class='title'>{!$Label.MA_Yes}</div>
                            <div class='subtitle'>{!$Label.MATutorial_Add_Custom_Config}</div>
                        </div>
                        <div class='bigbutton orange' style='width: 49%;' onclick='MATutorial_Steps_Custom_AddAnother_No();'>
                            <div class='title'>{!$Label.MA_No}</div>
                            <div class='subtitle'>{!$Label.MATutorial_Review_Custom_Config}</div>
                        </div>
                    </div>

                </div>

                <!-- Step: Review -->
                <div id='MATutorial-Steps-Review' style='display: none;'>

                    <!-- Header -->
                    <h2>{!$Label.MATutorial_Review}</h2>

                    <!-- Instructions -->
                    <p class='popup-instructions'>{!$Label.MATutorial_Add_Custom_Config_Install}</p>

                    <!-- Content -->
                    <div style='max-height: 400px; overflow-y: auto;'>

                        <!-- Selected Configurations -->
                        <table id='MATutorial-Steps-Review-SelectedConfigurations' class='grid-blue'>
                            <tr>
                                <th>{!$Label.MATutorial_Selected_Configurations}</th>
                            </tr>
                        </table>

                    </div>

                    <!-- Spacer -->
                    <div style='height: 15px;'>&nbsp;</div>

                    <!-- Buttons -->
                    <div class='buttons'>
                        <div class="bigbutton orange" onclick="MATutorial_Steps_Review_Finish();">{!$Label.MA_Finish}</div>
                    </div>

                </div>

            </div>

        </div>
    </div>

    <!-- Copy To Popup -->
    <div id="CopyToPopup" class="popup_block">
        <h2><span role="copyLabel">{!$Label.MA_Copy}</span> <span role="moveLabel" style="display:none;">{!$Label.MA_Move}</span> <span id="copynode" copyid="" copynodetype="" style="font-size:14px;color:black;"></span> {!$Label.MA_To}...</h2>
        <div id="CopyToTree" class="demo" style="padding-top:3px;"></div>
        <br />
        <br />
        <a class="button1-blue" role="saveButton" onclick="SubmitCopyTo();">{!$Label.MA_Submit}</a>
        <a class="button1-blue" onclick="ClosePopupWindow();$('#CopyToTree').html('');">{!$Label.MA_Close}</a>
    </div>

    <!-- Edit Permissions Popup -->
    <div id="EditPermissionsPopup" class="popup_block">
        <div class='loadmask-wrapper'>
            <h2>{!$Label.MA_Folder_Permissions_for} <span id="foldertoedit" folderid="" style="font-size:14px;color:black;"></span></h2>
            <br />
            <table style='width: 100%;'>
                <tr>
                    <td>
                        <!-- Permissions Grid Filters  -->
                        <table id="permissions-filters">
                            <tr>
                                <td>{!$Label.MA_Search_for}</td>
                                <td><select id='permissionsfilter-searchtype'><option value='Both' selected="selected">{!$Label.MA_Both}</option><option value='User'>{!$Label.MA_User}</option><option value='Profile'>{!$Label.MA_Profile}</option></select></td>
                                <td><input type='text' id='permissionsfilter-searchtext' /></td>
                            </tr>
                        </table>
                    </td>
                    <td>
                        <!-- Permissions Grid Paging -->
                        <table style='float: right;'>
                            <tr>
                                <td id='permissions-pageinfo'></td>
                            </tr>
                            <tr>
                                <td style='text-align: right; verticle-align: middle;'>{!$Label.MA_Go_to_page} <select id='permissions-page'></select></td>
                            </tr>
                        </table>
                    </td>
                </tr>

            </table>
            <div id="permissions-grid-wrapper">
                <div id="permissions-grid-loadmask"></div>
                <div id="permissions-grid-status">
                    <div class='status'>
                        <img src="{!URLFOR($Resource.MapAnything, 'images/chatterstatus-loader.gif')}" />
                        <span></span>
                    </div>
                </div>
                <table id="permissions-grid" cellspacing="5">
                    <thead>
                        <tr style="width:100%;">
                            <td style="width:15%;text-align:left;"><b>{!$Label.MA_Permission_Type}</b></td>
                            <td style="width:20%;text-align:left;"><b>{!$Label.MA_Permission_For}</b></td>
                            <td style="width:10%"><b>{!$Label.MA_Read}</b></td>
                            <td style="width:10%"><b>{!$Label.MA_Create}</b></td>
                            <td style="width:10%"><b>{!$Label.MA_Modify}</b></td>
                            <td style="width:10%"><b>{!$Label.MA_Delete}</b></td>
                            <td style="width:10%"><b>{!$Label.MA_Set_Perm}</b></td>
                            <td style="width:15%"></td>
                        </tr>
                    </thead>
                </table>
            </div>
            <br />
            <br />
            <a class="button1-blue" onclick="CreateNewPermissionPopup();">{!$Label.MA_Create_New}</a>
            <a class="button1-blue" onclick="ClosePopupWindow();">{!$Label.MA_Close}</a>
        </div>
    </div>

    <!-- Debug Window -->
    <div id="DebugWindowPopup" class="popup_block">
        <h2>Debug Log</h2>
        <div id="DebugOut"></div>
        <br />
        <br />
        <a class="button1-blue" onclick="ClosePopupWindow();">{!$Label.MA_Close}</a>
        <a class="button1-lightgray" onclick="ClearDebugWindow();">{!$Label.MA_Clear}</a>
        <a class="button1-lightgray" onclick="EmailDebugLog();">{!$Label.MA_Email_Log}</a>
    </div>

    <!-- Address Not Found Window -->
    <div id="AddressNotFoundPopup" class="popup_block">
        <h2>{!$Label.MA_Addresses_Not_Found}</h2>
        <div id="MissingAddressesContent" ></div>
        <br />
        <br />
        <a class="button1-blue" href="javascript:ClosePopupWindow();">{!$Label.MA_Close}</a>
        <a class="button1-lightgray" onclick="ExportMissingAddresses();">{!$Label.MA_Export_Selected}</a>
        <a class="button1-lightgray" onclick="ExportMissingAddresses(true);">{!$Label.MA_Export_All}</a>
    </div>

    <!--Custom Dis Popup -->
    <!--<div id="CustomDispositionPopup" class="ma-modal ma-modal--large">-->
         <!--Loadmask -->
    <!--    <div id='customDis-loadmask'></div>-->

    <!--    <div class="ma-modal-container">-->
    <!--        <div class="ma-modal-header">-->
    <!--            <button onclick="MALayers.hideModal();" class="ma-button ma-modal-close">-->
    <!--                <div class="ma-icon ma-icon-close"></div>-->
    <!--            </button>-->
    <!--            <h4 class="ma-modal-title">Custom Disposition</h4>-->
    <!--        </div>-->
    <!--        <div class="ma-modal-content pad-16">-->
    <!--            <div>-->
    <!--                <div>-->
    <!--                    <div class="disposition-row">-->
    <!--                        <div class="disposition-instruction label">-->
    <!--                            <div class="disposition-instruction-subtext">-->
    <!--                                Please complete the fields below.-->
    <!--                                <span style="font-weight:bold;color:#c23934;">*</span> = Required-->
    <!--                            </div>-->
    <!--                        </div>-->
    <!--                    </div>-->
    <!--                    <ul id='customDis-fieldset-errors'></ul>-->
    <!--                    <div class="overflow customDisWrapper" style="position:relative;">-->
    <!--                        <div id='customDis-fieldset'></div>-->
    <!--                    </div>-->
    <!--                </div>-->
    <!--            </div>-->
    <!--        </div>-->
    <!--        <div class="ma-modal-footer clearfix">-->
    <!--            <div class="float-right customDis-buttons">-->
    <!--                <button class="slds-button slds-button_neutral customDis-cancel" onclick="cancelDisposition(); MALayers.hideModal();">{!$Label.MA_Cancel}</button>-->
    <!--                <button class="slds-button slds-button_brand saveDisposition">{!$Label.MA_Finish}</button>-->
    <!--            </div>-->
    <!--        </div>-->
    <!--    </div>    -->
    <!--</div>-->



    <!-- Add to Campaign Window -->
    <!--<div id="AddToCampaignPopup" class="ma-modal ma-modal--large" style='max-height: 600px;'>-->
    <!--    <div class="ma-modal-container" style="width:700px;">-->
    <!--        <div class="ma-modal-header">-->
    <!--            <button class="ma-button ma-modal-close" onclick="MALayers.hideModal();">-->
    <!--                <div class="ma-icon ma-icon-close"></div>-->
    <!--            </button>-->
    <!--            <h4 class="ma-modal-title">{!$Label.MAActionFramework_Add_to_Campaign}</h4>-->
    <!--        </div>-->

    <!--        <div class="ma-modal-content" style="padding:0;height: 400px;position: relative;">-->
    <!--            <div class="pad-16" style="height: calc(100% - 33px);">-->
    <!--                <div id='addtocampaign-select-wrapper' style="height:100%;">-->
    <!--                    <h4>{!$Label.MA_Step_1_Select_Campaigns}</h4>-->

    <!--                    <div id="addtocampaign-select-filters" style="height: calc(100% - 25px);">-->
    <!--                        <div class="ma-form-control-wrap">-->
    <!--                            <label class="ma-input-label">-->
    <!--                                {!$Label.MA_Name}-->
    <!--                                <span class="required">*</span> -->
    <!--                                <span style="font-size: 10px;color:#3083d3;" class='hidden link showadvancedfilters'>{!$Label.MA_Show_Advanced_Filters}</span> -->
    <!--                                | -->
    <!--                                <div class="inline" id='addtocampaign-select-selectiondetails'><span>0</span> {!$Label.MA_selected} <span style="font-size: 10px;color:#3083d3;" class='link clearselections'>{!$Label.MA_Clear_Selections}</span></div>-->
    <!--                                <span style="font-size: 10px;color:#3083d3;" class='link hidden clearfilters'>{!$Label.MA_Clear_Filters}</span>-->
    <!--                            </label>-->
    <!--                            <div class="ma-form-control icon-right">-->
    <!--                                <i class="MAIcon ion-android-search inset-icon--right" style="font-size: 20px;top: 5px;"></i>-->
    <!--                                <input id='addtocampaign-filter-name' class="ma-input searchDynamicInput" type="text"/>-->
    <!--                            </div>-->
    <!--                        </div>-->

    <!--                        <div id="addtocampaign-select-advanced-filters" style='display: none;'>-->
    <!--                            <table>-->
    <!--                                <tr>-->
    <!--                                    <td class='label'>{!$Label.MA_Type}</td>-->
    <!--                                    <td class='data'><input type='text' id='addtocampaign-filter-type' class='filter-text ma-input-row' data-field='Type' /></td>-->
    <!--                                    <td class='label'>{!$Label.MA_Status}</td>-->
    <!--                                    <td class='data'><input type='text' id='addtocampaign-filter-status' class='filter-text ma-input-row' data-field='Status' /></td>-->
    <!--                                </tr>-->
    <!--                                <tr>-->
    <!--                                    <td class='label'>{!$Label.MA_Start_Date}</td>-->
    <!--                                    <td class='data' colspan='3'>between <input type='text' id='addtocampaign-filter-startdate-start' class='filter-calendar start ma-input-row' data-field='StartDate' /> and <input type='text' id='addtocampaign-filter-startdate-end' class='filter-calendar end ma-input-row' data-field='StartDate' /></td>-->
    <!--                                </tr>-->
    <!--                                <tr>-->
    <!--                                    <td class='label'>{!$Label.MA_End_Date}</td>-->
    <!--                                    <td class='data' colspan='3'>between <input type='text' id='addtocampaign-filter-enddate-start' class='filter-calendar start ma-input-row' data-field='EndDate' /> and <input type='text' id='addtocampaign-filter-enddate-end' class='filter-calendar end ma-input-row' data-field='EndDate' /></td>-->
    <!--                                </tr>-->
    <!--                                <tr>-->
    <!--                                    <td class='label'># {!$Label.MA_Lead}</td>-->
    <!--                                    <td class='data' colspan='3'>between <input type='text' id='addtocampaign-filter-leads-start' class='filter-number start ma-input-row' data-field='NumberOfLeads' /> and <input type='text' id='addtocampaign-filter-leads-end' class='filter-number end ma-input-row' data-field='NumberOfLeads' /></td>-->
    <!--                                </tr>-->
    <!--                                <tr>-->
    <!--                                    <td class='label'># {!$Label.MA_Contact}</td>-->
    <!--                                    <td class='data' colspan='3'>between <input type='text' id='addtocampaign-filter-contacts-start' class='filter-number start ma-input-row' data-field='NumberOfContacts' /> and <input type='text' id='addtocampaign-filter-contacts-end' class='filter-number end ma-input-row' data-field='NumberOfContacts' /></td>-->
    <!--                                </tr>-->
    <!--                                <tr>-->
    <!--                                    <td class='label'># {!$Label.MA_Responses}</td>-->
    <!--                                    <td class='data' colspan='3'>between <input type='text' id='addtocampaign-filter-responses-start' class='filter-number start ma-input-row' data-field='NumberOfResponses' /> and <input type='text' id='addtocampaign-filter-responses-end' class='filter-number end ma-input-row' data-field='NumberOfResponses' /></td>-->
    <!--                                </tr>-->
    <!--                            </table>-->
    <!--                        </div>-->

    <!--                        <div class="ma-form-control-wrap" style="overflow: auto; height: calc(100% - 70px);">-->
    <!--                            <table id='addtocampaign-select-grid' class="ma-table">-->
    <!--                                <thead class="ma-table-header">-->
    <!--                                    <tr>-->
    <!--                                        <th style='width: 20px;'></th>-->
    <!--                                        <th>{!$Label.MA_Name}</th>-->
    <!--                                        <th>{!$Label.MA_Type}</th>-->
    <!--                                        <th>{!$Label.MA_Status}</th>-->
    <!--                                        <th>{!$Label.MA_Start_Date}</th>-->
    <!--                                        <th>{!$Label.MA_End_Date}</th>-->
    <!--                                        <th># {!$Label.MA_Lead}</th>-->
    <!--                                        <th># {!$Label.MA_Contact}</th>-->
    <!--                                        <th># {!$Label.MA_Responses}</th>-->
    <!--                                    </tr>-->
    <!--                                </thead>-->
    <!--                                <tbody class="tableResults">-->
    <!--                                    <tr><td colspan="9">Please Search Above...</td></tr>-->
    <!--                                </tbody>-->
    <!--                            </table>-->
    <!--                        </div>-->
    <!--                    </div>-->

    <!--                </div>-->

    <!--                <div id='addtocampaign-options-wrapper'>-->
    <!--                    <h4>{!$Label.MA_Step_2_Options}</h4>-->


    <!--                    <div id='addtocampaign-options-grid-wrapper' class='loadmask-wrapper'>-->
    <!--                        <table id='addtocampaign-options-grid' class='ma-table ma-table--fullwidth'>-->
    <!--                            <thead class="ma-table-header">-->
    <!--                                <tr>-->
    <!--                                    <th>{!$Label.MA_Name}</th>-->
    <!--                                    <th>{!$Label.MA_Member_Status}</th>-->
    <!--                                    <th>{!$Label.MA_Override_Status}</th>-->
    <!--                                </tr>-->
    <!--                            </thead>-->
    <!--                        </table>-->
    <!--                    </div>-->

    <!--                </div>-->
    <!--            </div>-->
    <!--        </div>-->

    <!--        <div class="ma-modal-footer clearfix">-->
    <!--            <div class="float-right">-->
    <!--                <button class="MAbutton button-red" id="maModalClose" onclick="MALayers.hideModal('AddToCampaignPopup',true);">{!$Label.MA_Cancel}</button>-->
    <!--                <button class="slds-button slds-button_brand step2" onclick="AddToCampaign_Step1();">{!$Label.MA_Back}</button>-->
    <!--                <button class="slds-button slds-button_brand step1" onclick="AddToCampaign_Step2();">{!$Label.MA_Next}</button>-->
    <!--                <button class="slds-button slds-button_brand step2" onclick="AddToCampaign_Finish();">{!$Label.MA_Add_Close}</button>-->
    <!--            </div>-->
    <!--        </div>-->
    <!--    </div>-->
    <!--</div>-->


    <div id="CustomDispositionPopup" class="maModal">
        <div class="slds-scope">
            <section class="slds-modal" role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-describedby="modal-content-id-1">
                <div id='customDis-loadmask'></div>
                <div class="slds-modal__container">
                    <header class="slds-modal__header">
                        <button class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse js-close-this-slds-modal" title="Close" onclick="MALayers.hideModal();">
                            <span class="slds-button__icon slds-button__icon--large ma-icon ma-icon-close" aria-hidden="true"></span>
                            <span class="slds-assistive-text">Close</span>
                        </button>
                        <h2 id="modal-heading-01" class="slds-text-heading--medium slds-hyphenate maPopup-title">Custom Disposition</h2>
                    </header>

                    <div class="slds-modal__content slds-p-around_medium">
                        <div class="disposition-row">
                            <div class="disposition-instruction label">
                                <div class="slds-text-title_caps">
                                    Please complete the fields below.
                                </div>
                                <span style="font-weight:bold;color:#c23934;">*</span> = Required
                            </div>
                        </div>
                        <ul id='customDis-fieldset-errors'></ul>
                        <div class="overflow customDisWrapper" style="position:relative;">
                            <div id='customDis-fieldset'></div>
                        </div>
                    </div>

                    <footer class="slds-modal__footer">
                        <div class="float-right footer-buttons customDis-buttons">
                            <button class="slds-button slds-button_neutral customDis-cancel" onclick="cancelDisposition(); MALayers.hideModal();">{!$Label.MA_Cancel}</button>
                            <button class="slds-button slds-button_brand saveDisposition">{!$Label.MA_Finish}</button>
                        </div>
                    </footer>
                </div>
            </section>
        </div>
   </div>

    <div id="AddToCampaignPopup" class="maModal">
        <div class="slds-scope">
            <section class="slds-modal slds-modal--xxl" role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-describedby="modal-content-id-1">
                <div class="slds-modal__container">
                    <header class="slds-modal__header">
                        <button class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse js-close-this-slds-modal" title="Close" onclick="MALayers.hideModal();">
                            <span class="slds-button__icon slds-button__icon--large ma-icon ma-icon-close" aria-hidden="true"></span>
                            <span class="slds-assistive-text">Close</span>
                        </button>
                        <h2 id="modal-heading-01" class="slds-text-heading--medium slds-hyphenate maPopup-title">{!$Label.MAActionFramework_Add_to_Campaign}</h2>
                    </header>

                    <div class="slds-modal__content slds-p-around_medium">
                        <div id="addtocampaign-select-wrapper">
                            <h4>{!$Label.MA_Step_1_Select_Campaigns}</h4>

                            <div id="addtocampaign-select-filters">
                                <div class="ma-form-control-wrap">
                                    <label class="ma-input-label">
                                        {!$Label.MA_Name}
                                        <span class="required">*</span>
                                        <span style="font-size: 10px;color:#3083d3;" class='hidden link showadvancedfilters'>{!$Label.MA_Show_Advanced_Filters}</span>
                                        |
                                        <div class="inline" id='addtocampaign-select-selectiondetails'><span>0</span> {!$Label.MA_selected} <span style="font-size: 10px;color:#3083d3;" class='link clearselections'>{!$Label.MA_Clear_Selections}</span></div>
                                        <span style="font-size: 10px;color:#3083d3;" class='link hidden clearfilters'>{!$Label.MA_Clear_Filters}</span>
                                    </label>
                                    <div class="ma-form-control icon-right">
                                        <i class="MAIcon ion-android-search inset-icon--right" style="font-size: 20px;top: 5px;"></i>
                                        <input id='addtocampaign-filter-name' class="ma-input searchDynamicInput" type="text"/>
                                    </div>
                                </div>

                                <div id="addtocampaign-select-advanced-filters" style='display: none;'>
                                    <table>
                                        <tr>
                                            <td class='label'>{!$Label.MA_Type}</td>
                                            <td class='data'><input type='text' id='addtocampaign-filter-type' class='filter-text ma-input-row' data-field='Type' /></td>
                                            <td class='label'>{!$Label.MA_Status}</td>
                                            <td class='data'><input type='text' id='addtocampaign-filter-status' class='filter-text ma-input-row' data-field='Status' /></td>
                                        </tr>
                                        <tr>
                                            <td class='label'>{!$Label.MA_Start_Date}</td>
                                            <td class='data' colspan='3'>between <input type='text' id='addtocampaign-filter-startdate-start' class='filter-calendar start ma-input-row' data-field='StartDate' /> and <input type='text' id='addtocampaign-filter-startdate-end' class='filter-calendar end ma-input-row' data-field='StartDate' /></td>
                                        </tr>
                                        <tr>
                                            <td class='label'>{!$Label.MA_End_Date}</td>
                                            <td class='data' colspan='3'>between <input type='text' id='addtocampaign-filter-enddate-start' class='filter-calendar start ma-input-row' data-field='EndDate' /> and <input type='text' id='addtocampaign-filter-enddate-end' class='filter-calendar end ma-input-row' data-field='EndDate' /></td>
                                        </tr>
                                        <tr>
                                            <td class='label'># {!$Label.MA_Lead}</td>
                                            <td class='data' colspan='3'>between <input type='text' id='addtocampaign-filter-leads-start' class='filter-number start ma-input-row' data-field='NumberOfLeads' /> and <input type='text' id='addtocampaign-filter-leads-end' class='filter-number end ma-input-row' data-field='NumberOfLeads' /></td>
                                        </tr>
                                        <tr>
                                            <td class='label'># {!$Label.MA_Contact}</td>
                                            <td class='data' colspan='3'>between <input type='text' id='addtocampaign-filter-contacts-start' class='filter-number start ma-input-row' data-field='NumberOfContacts' /> and <input type='text' id='addtocampaign-filter-contacts-end' class='filter-number end ma-input-row' data-field='NumberOfContacts' /></td>
                                        </tr>
                                        <tr>
                                            <td class='label'># {!$Label.MA_Responses}</td>
                                            <td class='data' colspan='3'>between <input type='text' id='addtocampaign-filter-responses-start' class='filter-number start ma-input-row' data-field='NumberOfResponses' /> and <input type='text' id='addtocampaign-filter-responses-end' class='filter-number end ma-input-row' data-field='NumberOfResponses' /></td>
                                        </tr>
                                    </table>
                                </div>

                                <div class="ma-form-control-wrap" style="overflow: auto;">
                                    <table id='addtocampaign-select-grid' class="ma-table">
                                        <thead class="ma-table-header">
                                            <tr>
                                                <th style='width: 20px;'></th>
                                                <th>{!$Label.MA_Name}</th>
                                                <th>{!$Label.MA_Type}</th>
                                                <th>{!$Label.MA_Status}</th>
                                                <th>{!$Label.MA_Start_Date}</th>
                                                <th>{!$Label.MA_End_Date}</th>
                                                <th># {!$Label.MA_Lead}</th>
                                                <th># {!$Label.MA_Contact}</th>
                                                <th># {!$Label.MA_Responses}</th>
                                            </tr>
                                        </thead>
                                        <tbody class="tableResults">
                                            <tr><td colspan="9">Please Search Above...</td></tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>

                        </div>

                        <div id='addtocampaign-options-wrapper'>
                            <h4>{!$Label.MA_Step_2_Options}</h4>


                            <div id='addtocampaign-options-grid-wrapper' class='loadmask-wrapper'>
                                <table id='addtocampaign-options-grid' class='ma-table ma-table--fullwidth'>
                                    <thead class="ma-table-header">
                                        <tr>
                                            <th>{!$Label.MA_Name}</th>
                                            <th>{!$Label.MA_Member_Status}</th>
                                            <th>{!$Label.MA_Override_Status}</th>
                                        </tr>
                                    </thead>
                                </table>
                            </div>
                        </div>
                    </div>

                    <footer class="slds-modal__footer">
                        <div class="float-right footer-buttons">
                            <button class="slds-button slds-button_neutral" id="maModalClose" onclick="MALayers.hideModal('AddToCampaignPopup',true);">{!$Label.MA_Cancel}</button>
                            <button class="slds-button slds-button_brand step2" onclick="AddToCampaign_Step1();">{!$Label.MA_Back}</button>
                            <button class="slds-button slds-button_brand step1" onclick="AddToCampaign_Step2();">{!$Label.MA_Next}</button>
                            <button class="slds-button slds-button_brand step2" onclick="AddToCampaign_Finish();">{!$Label.MA_Add_Close}</button>
                        </div>
                    </footer>
                </div>
            </section>
        </div>
    </div>








    <!-- Change Owner Window -->
    <div id="ChangeOwnerPopup" class="popup_block" style='max-height: 600px;'>
        <h2>{!$Label.MAActionFramework_Change_Owner}</h2>

        <!-- Step 1: Select New Owner -->
        <div id='changeowner-select-wrapper' class='loadmask-wrapper'>

            <!-- Header -->
            <h4>{!$Label.MA_Step_1_Select_New_Owner}</h4>

            <!-- Grid -->
            <div class='grid-wrapper'>

                <!-- Users Grid Options -->
                <table style='width: 100%;'>
                    <tr>
                        <td style='vertical-align: top;'>

                            <!-- Grid Filters -->
                            <table>
                                <tr>
                                    <td class='label'>{!$Label.MA_Name}</td>
                                    <td class='data'><input type='text' id='changeowner-filter-name' class='filter-text' data-field='Name' /></td>
                                </tr>
                            </table>

                        </td>
                        <!--<td style="vertical-align:top">-->
                        <!--    <div class="slds-form-element">-->
                        <!--      <div class="slds-form-element__control">-->
                        <!--        <span class="slds-checkbox">-->
                        <!--          <input type="checkbox" name="options" id="checkbox-1" value="on" checked="checked" />-->
                        <!--          <label class="slds-checkbox__label" for="checkbox-1">-->
                        <!--            <span class="slds-checkbox_faux"></span>-->
                        <!--            <span class="slds-form-element__label">Show only subordinates</span>-->
                        <!--          </label>-->
                        <!--        </span>-->
                        <!--      </div>-->
                        <!--    </div>-->
                        <!--</td>-->
                        <td style='vertical-align: bottom;'>

                            <!-- Grid Paging -->
                            <table style='float: right;'>
                                <tr>
                                    <td class='grid-pageinfo'></td>
                                </tr>
                                <tr>
                                    <td style='text-align: right; verticle-align: middle;'>{!$Label.MA_Go_to_page} <select class='grid-page'></select></td>
                                </tr>
                            </table>

                        </td>
                    </tr>

                </table>

                <!-- Spacer -->
                <div style='height: 15px;'>&nbsp;</div>

                <!-- Users Grid -->
                <div id='changeowner-select-grid-wrapper' class='loadmask-wrapper'>
                    <table id='changeowner-select-grid' class='grid-blue'>
                        <tr>
                            <th>{!$Label.MA_Name}</th>
                        </tr>
                    </table>
                </div>

            </div>

            <!-- Spacer -->
            <div style='height: 15px;'>&nbsp;</div>

            <!-- Buttons -->
            <span class='link' style='font-size: 10px; line-height: 22px;' onclick="ClosePopupWindow();">{!$Label.MA_Cancel}</span>

        </div>

        <!-- Step 2: Options -->
        <div id='changeowner-options-wrapper' class='loadmask-wrapper'>

            <!-- Header -->
            <h4>{!$Label.MA_Step_2_Transfer_Options}</h4>

            <!-- Spacer -->
            <div style='height: 15px;'>&nbsp;</div>

            <!-- Transfer Options -->
            <div>
                <h4>{!$Label.MA_Related_items_transfer}</h4>

                <div><input type='checkbox' id='changeowner-notes' checked='checked' /> {!$Label.MA_Notes}</div>
                <div><input type='checkbox' id='changeowner-attachments' checked='checked' /> {!$Label.MA_Attachments}</div>
                <div><input type='checkbox' id='changeowner-tasks' checked='checked' /> {!$Label.MA_Open_Tasks}</div>
                <div><input type='checkbox' id='changeowner-events' checked='checked' /> {!$Label.MA_Future_Events}</div>
            </div>

            <!-- Spacer -->
            <div style='height: 15px;'>&nbsp;</div>

            <!-- Buttons -->
            <a class="button1-lightgray" onclick="ChangeOwner_Step1();">{!$Label.MA_Back}</a>
            <a class="button1-lightgray" onclick="ChangeOwner_Finish();">{!$Label.MA_Save_Close}</a>
            <span class='link' style='font-size: 10px; line-height: 22px;' onclick="ClosePopupWindow();">{!$Label.MA_Cancel}</span>

        </div>

    </div>

    <!-- Dynamic Filter Window -->
    <script id='DynamicFilterPopupWrapper' type='text/template'>
        <div class="popup_block" style='max-height: 600px;'>
            <div class='loadmask-wrapper'>
                <h2>Dynamic Filters</h2>
                <p style='margin: 2px 0;'> This query contains dynamic filters.  Please enter values for the fields below and click continue.</p>

                <!-- Form -->
                <div style='height: 120px; margin-top: 15px;'>
                    <table class='form-stretch'>

                        <!-- New value -->
                        <tr class='updatefield-value-wrapper'>
                            <td id='DynamicFilterPopup-FieldLabel'></td>
                            <td class='updatefield-value'><input type='text' id='DynamicFilterPopup-FieldValue' /></td>
                        </tr>

                    </table>
                </div>

                <!-- Buttons -->
                <a id='DynamicFilterPopup-Continue' class="button1-lightgray">Continue</a>
                <span id='DynamicFilterPopup-Cancel' class='link' style='font-size: 10px; line-height: 22px;'>{!$Label.MA_Cancel}</span>

            </div>
        </div>
    </script>

    <!-- New Task Window -->
    <div id="NewTaskPopup" class="maModal">
        <div class="slds-scope">
            <section class="slds-modal" role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-describedby="modal-content-id-1">
                <div class="slds-modal__container">
                    <header class="slds-modal__header">
                        <button class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse js-close-this-slds-modal" title="Close" onclick="MALayers.hideModal();">
                            <span class="slds-button__icon slds-button__icon--large ma-icon ma-icon-close" aria-hidden="true"></span>
                            <span class="slds-assistive-text">Close</span>
                        </button>
                        <h2 id="modal-heading-01" class="slds-text-heading--medium slds-hyphenate maPopup-title">{!$Label.MA_New_Task}</h2>
                    </header>

                    <div class="slds-modal__content slds-p-around_medium">
                        <div id='newtask-assignto-wrapper'>
                            <h4>{!$Label.MA_Step_1_Assign_To}</h4>

                            <!-- Assignment Type -->
                            <!--<div class='newtask-assignto-type-wrapper'>-->
                            <!--    <input type='radio' name='newtask-assignto-type' id='newtask-assignto-type-static' value='Static' />-->
                            <!--    <label for='newtask-assignto-type-static'>{!$Label.MA_Static}</label>-->

                            <!--    <input type='radio' name='newtask-assignto-type' id='newtask-assignto-type-dynamic' value='Dynamic' />-->
                            <!--    <label for='newtask-assignto-type-dynamic'>{!$Label.MA_Dynamic}</label>-->
                            <!--</div>-->
                            <fieldset class="newtask-assignto-type-wrapper slds-form-element">
                              <div class="slds-form-element__control">
                                <span class="slds-radio">
                                  <input type="radio" id="newtask-assignto-type-static" name="newtask-assignto-type" value='Static' />
                                  <label class="slds-radio__label" for="newtask-assignto-type-static">
                                    <span class="slds-radio_faux"></span>
                                    <span class="slds-form-element__label">{!$Label.MA_Static}</span>
                                  </label>
                                </span>
                                <span class="slds-radio">
                                  <input type="radio" id="newtask-assignto-type-dynamic" name="newtask-assignto-type" value='Dynamic' />
                                  <label class="slds-radio__label" for="newtask-assignto-type-dynamic">
                                    <span class="slds-radio_faux"></span>
                                    <span class="slds-form-element__label">{!$Label.MA_Dynamic}</span>
                                  </label>
                                </span>
                              </div>
                            </fieldset>

                            <div class="ma-form-control-wrap newtask-assignto-type Static">
                                <label class="ma-input-label">{!$Label.MA_Step_1_Assign_To}<span class="required">*</span></label>
                                <div class="ma-form-control icon-right">
                                    <i class="MAIcon ion-android-search inset-icon--right" style="font-size: 20px;top: 5px;"></i>
                                    <input placeholder="Search Users..." class="ma-input searchDynamicInput taskOwner" type="text"/>
                                </div>

                                <div class="ma-form-control-wrap">
                                    <ul style="max-height: 220px;overflow: auto;" class="ma-list table-view search-table-view">
                                        <li class="table-view-cell">Please search above...</li>
                                    </ul>
                                </div>
                            </div>

                            <div class="ma-form-control-wrap newtask-assignto-type Dynamic">
                                <table id='newtask-assignto-type-dynamic-table' class='ma-table ma-table--fullwidth'></table>
                            </div>
                        </div>

                        <div id='newtask-details-wrapper'>
                            <h4>{!$Label.MA_Step_2_Task_Details}</h4>
                            <div class="ma-form-control-wrap">
                                <label class="ma-input-label">{!$Label.MA_Subject}<span class="required">*</span></label>
                                <div class="ma-form-control">
                                    <input id='newtask-details-subject' class="ma-input taskSubject" type="text"/>
                                </div>
                            </div>
                            <div class="ma-form-control-wrap">
                                <label class="ma-input-label">{!$Label.MA_Due_Date}</label>
                                <div class="ma-form-control icon-right">
                                    <i style="font-size: 20px;top: 5px;" class="MAIcon ion-android-calendar inset-icon--right"></i>
                                    <input id='newtask-details-duedate' class="ma-input taskDate" type="text"/>
                                </div>
                            </div>
                            <div class="ma-form-control-wrap">
                                <label class="ma-input-label">{!$Label.MA_Comments}</label>
                                <div class="ma-form-control">
                                    <textarea id='newtask-details-description' style="min-height: 66px;" class="ma-input taskDescription" type="text"></textarea>
                                </div>
                            </div>
                        </div>
                    </div>

                    <footer class="slds-modal__footer">
                        <div class="float-left footer-buttons">
                            <button class="slds-button slds-button_neutral" id="newTaskClassic" onclick="newTaskClassic();">View in Salesforce</button>
                        </div>
                        <div class="float-right footer-buttons">
                            <button class="slds-button slds-button_neutral" id="maModalClose" onclick="MALayers.hideModal('NewTaskPopup',true);">Cancel</button>
                            <button class="slds-button slds-button_brand step2" onclick="NewTask_Step1();">{!$Label.MA_Back}</button>
                            <button class="slds-button slds-button_brand step1" onclick="NewTask_Step2();">{!$Label.MA_Next}</button>
                            <button class="slds-button slds-button_brand step2" onclick="NewTask_Finish();">{!$Label.MA_Add_Close}</button>
                        </div>
                    </footer>
                </div>
            </section>
        </div>
    </div>

    <!-- New Event Window -->
    <div id="NewEventPopup" class="maModal">
        <div class="slds-scope">
            <section class="slds-modal" role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-describedby="modal-content-id-1">
                <div class="slds-modal__container">
                    <header class="slds-modal__header">
                        <button class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse js-close-this-slds-modal" title="Close" onclick="MALayers.hideModal();">
                            <span class="slds-button__icon slds-button__icon--large ma-icon ma-icon-close" aria-hidden="true"></span>
                            <span class="slds-assistive-text">Close</span>
                        </button>
                        <h2 id="modal-heading-01" class="slds-text-heading--medium slds-hyphenate maPopup-title">{!$Label.MA_New_Event}</h2>
                    </header>

                    <div class="slds-modal__content slds-p-around_medium">
                        <div id='newevent-assignto-wrapper'>
                            <h4>{!$Label.MA_Step_1_Assign_To}</h4>

                            <!-- Assignment Type -->
                            <!--<div class='newevent-assignto-type-wrapper'>-->
                            <!--    <input type='radio' name='newevent-assignto-type' id='newevent-assignto-type-static' value='Static' />-->
                            <!--    <label for='newevent-assignto-type-static'>{!$Label.MA_Static}</label>-->

                            <!--    <input type='radio' name='newevent-assignto-type' id='newevent-assignto-type-dynamic' value='Dynamic' />-->
                            <!--    <label for='newevent-assignto-type-dynamic'>{!$Label.MA_Dynamic}</label>-->
                            <!--</div>-->
                            <fieldset class="newevent-assignto-type-wrapper slds-form-element">
                              <div class="slds-form-element__control">
                                <span class="slds-radio">
                                  <input type="radio" id="newevent-assignto-type-static" name="newevent-assignto-type" value='Static' />
                                  <label class="slds-radio__label" for="newevent-assignto-type-static">
                                    <span class="slds-radio_faux"></span>
                                    <span class="slds-form-element__label">{!$Label.MA_Static}</span>
                                  </label>
                                </span>
                                <span class="slds-radio">
                                  <input type="radio" id="newevent-assignto-type-dynamic" name="newevent-assignto-type" value='Dynamic' />
                                  <label class="slds-radio__label" for="newevent-assignto-type-dynamic">
                                    <span class="slds-radio_faux"></span>
                                    <span class="slds-form-element__label">{!$Label.MA_Dynamic}</span>
                                  </label>
                                </span>
                              </div>
                            </fieldset>

                            <div class="ma-form-control-wrap newevent-assignto-type Static">
                                <label class="ma-input-label">{!$Label.MA_Step_1_Assign_To}<span class="required">*</span></label>
                                <div class="ma-form-control icon-right">
                                    <i class="MAIcon ion-android-search inset-icon--right" style="font-size: 20px;top: 5px;"></i>
                                    <input placeholder="Search Users..." class="ma-input searchDynamicInput taskOwner" type="text"/>
                                </div>

                                <div class="ma-form-control-wrap">
                                    <ul style="max-height: 220px;overflow: auto;" class="ma-list table-view search-table-view">
                                        <li class="table-view-cell">Please search above...</li>
                                    </ul>
                                </div>
                            </div>

                            <div class="ma-form-control-wrap newevent-assignto-type Dynamic">
                                <table id='newevent-assignto-type-dynamic-table' class='ma-table ma-table--fullwidth'></table>
                            </div>
                        </div>

                        <div id='newevent-details-wrapper'>
                            <h4>{!$Label.MA_Step_2_Event_Details}</h4>
                            <div class="ma-form-control-wrap">
                                <label class="ma-input-label">{!$Label.MA_Subject}<span class="required">*</span></label>
                                <div class="ma-form-control">
                                    <input id='newevent-details-subject' class="ma-input taskSubject" type="text"/>
                                </div>
                            </div>
                            <div class="ma-form-control-wrap">
                                <label class="ma-input-label">{!$Label.MA_Start}<span class="required">*</span></label>
                                <div class="ma-form-control icon-right">
                                    <input type='text' id='newevent-details-startdate' class='datepicker ma-input-row'/>
                                    <select class="ma-input-row" type='text' id='newevent-details-starthour'><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option><option value="11">11</option><option value="12">12</option></select>
                                    <select class="ma-input-row" type='text' id='newevent-details-startminute'><option value="00">00</option><option value="01">01</option><option value="02">02</option><option value="03">03</option><option value="04">04</option><option value="05">05</option><option value="06">06</option><option value="07">07</option><option value="08">08</option><option value="09">09</option><option value="10">10</option><option value="11">11</option><option value="12">12</option><option value="13">13</option><option value="14">14</option><option value="15">15</option><option value="16">16</option><option value="17">17</option><option value="18">18</option><option value="19">19</option><option value="20">20</option><option value="21">21</option><option value="22">22</option><option value="23">23</option><option value="24">24</option><option value="25">25</option><option value="26">26</option><option value="27">27</option><option value="28">28</option><option value="29">29</option><option value="30">30</option><option value="31">31</option><option value="32">32</option><option value="33">33</option><option value="34">34</option><option value="35">35</option><option value="36">36</option><option value="37">37</option><option value="38">38</option><option value="39">39</option><option value="40">40</option><option value="41">41</option><option value="42">42</option><option value="43">43</option><option value="44">44</option><option value="45">45</option><option value="46">46</option><option value="47">47</option><option value="48">48</option><option value="49">49</option><option value="50">50</option><option value="51">51</option><option value="52">52</option><option value="53">53</option><option value="54">54</option><option value="55">55</option><option value="56">56</option><option value="57">57</option><option value="58">58</option><option value="59">59</option></select>
                                    <select class="ma-input-row" type='text' id='newevent-details-startperiod'><option value='AM'>AM</option><option value='PM'>PM</option></select>
                                </div>
                            </div>
                            <div class="ma-form-control-wrap">
                                <label class="ma-input-label">{!$Label.MA_End}<span class="required">*</span></label>
                                <div class="ma-form-control icon-right">
                                    <input type='text' id='newevent-details-enddate' class='datepicker ma-input-row'/>
                                    <select class="ma-input-row" type='text' id='newevent-details-endhour'><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option><option value="11">11</option><option value="12">12</option></select>
                                    <select class="ma-input-row" type='text' id='newevent-details-endminute'><option value="00">00</option><option value="01">01</option><option value="02">02</option><option value="03">03</option><option value="04">04</option><option value="05">05</option><option value="06">06</option><option value="07">07</option><option value="08">08</option><option value="09">09</option><option value="10">10</option><option value="11">11</option><option value="12">12</option><option value="13">13</option><option value="14">14</option><option value="15">15</option><option value="16">16</option><option value="17">17</option><option value="18">18</option><option value="19">19</option><option value="20">20</option><option value="21">21</option><option value="22">22</option><option value="23">23</option><option value="24">24</option><option value="25">25</option><option value="26">26</option><option value="27">27</option><option value="28">28</option><option value="29">29</option><option value="30">30</option><option value="31">31</option><option value="32">32</option><option value="33">33</option><option value="34">34</option><option value="35">35</option><option value="36">36</option><option value="37">37</option><option value="38">38</option><option value="39">39</option><option value="40">40</option><option value="41">41</option><option value="42">42</option><option value="43">43</option><option value="44">44</option><option value="45">45</option><option value="46">46</option><option value="47">47</option><option value="48">48</option><option value="49">49</option><option value="50">50</option><option value="51">51</option><option value="52">52</option><option value="53">53</option><option value="54">54</option><option value="55">55</option><option value="56">56</option><option value="57">57</option><option value="58">58</option><option value="59">59</option></select>
                                    <select class="ma-input-row" type='text' id='newevent-details-endperiod'><option value='AM'>AM</option><option value='PM'>PM</option></select>
                                </div>
                            </div>
                            <div class="ma-form-control-wrap">
                                <label class="ma-input-label">{!$Label.MA_Description}</label>
                                <div class="ma-form-control">
                                    <textarea id='newevent-details-description' style="min-height: 66px;" class="ma-input taskDescription" type="text"></textarea>
                                </div>
                            </div>
                        </div>
                    </div>

                    <footer class="slds-modal__footer">
                        <div class="float-left footer-buttons">
                            <button class="slds-button slds-button_neutral" id="newEventClassic" onclick="newEventClassic();">View in Salesforce</button>
                        </div>
                        <div class="float-right footer-buttons">
                            <button class="slds-button slds-button_neutral" id="maModalClose" onclick="MALayers.hideModal('NewEventPopup',true);">Cancel</button>
                            <button class="slds-button slds-button_brand step2" onclick="NewEvent_Step1();">{!$Label.MA_Back}</button>
                            <button class="slds-button slds-button_brand step1" onclick="NewEvent_Step2();">{!$Label.MA_Next}</button>
                            <button class="slds-button slds-button_brand step2" onclick="NewEvent_Finish();">{!$Label.MA_Add_Close}</button>
                        </div>
                    </footer>
                </div>
                </section>
        </div>
    </div>

    <!-- Chatter Post Popup -->
    <div id="ChatterPostPopup" class="popup_block" style='max-height: 600px;'>
        <h2>Chatter Post</h2>

        <!-- Step 1: Content -->
        <div id='chatterpost-content-wrapper' class='loadmask-wrapper'>

            <!-- Header -->
            <h4>Step 1: Content</h4>

            <!-- Spacer -->
            <div style='height: 15px;'>&nbsp;</div>

            <!-- Details -->
            <table class='grid-blue'>
                <tr>
                    <td>Content</td>
                    <td><textarea id='chatterpost-content' style='width: 100%; height: 100px; -webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box;'></textarea></td>
                </tr>
            </table>

            <!-- Spacer -->
            <div style='height: 15px;'>&nbsp;</div>

            <!-- Buttons -->
            <a class="button1-lightgray" onclick="ChatterPost_Finish();">{!$Label.MA_Add_Close}</a>
            <span class='link' style='font-size: 10px; line-height: 22px;' onclick="ClosePopupWindow();">{!$Label.MA_Cancel}</span>

        </div>
    </div>

    <!-- Clear Coordinates Popup -->
    <div id="ClearCoordinatesPopup" class="popup_block" style='max-height: 600px;'>

        <!-- Header -->
        <h2>{!$Label.MA_Clear_Coordinates}</h2>

        <!-- Instructions -->
        <p class='popup-instructions'>{!$Label.MA_Clear_Coord_Info}</p>

        <!-- Buttons -->
        <a class="button1-lightgray" onclick="ClearCoordinatesForVisible(true); ClosePopupWindow();">{!$Label.MA_Clear_Coord_Verified}</a>
        <a class="button1-lightgray" onclick="ClearCoordinatesForVisible(false); ClosePopupWindow();">{!$Label.MA_Clear_Coord_Unverified}</a>
        <span class='link' style='font-size: 10px; line-height: 22px;' onclick="ClosePopupWindow();">{!$Label.MA_Cancel}</span>

    </div>

    <!-- Create Record Data Layer Popup -->
    <div id="CreateRecordDataLayerPopup" class="popup_block">

        <!-- Loadmask -->
        <div id='createrecordDataLayer-loadmask'></div>

        <!-- Step 1 -->
        <div id='createrecordDataLayer-step1' class='createrecord-step'>
            <h1>Step 1</h1>

            <div class="overflow" style="max-height:400px; overflow: auto;">
                <div class='createrecord-formitem'>
                    <label>What would you like to create?</label>
                    <select id="createrecordDataLayer-object" onchange="MAData.createRecordFromDataLayer.object_Change();"></select>
                </div>
                <div class='createrecord-formitem'>
                    <label>Select a record type:</label>
                    <select id='createrecordDataLayer-recordtype'></select>
                </div>
            </div>

            <div class='createrecord-buttons'>
                <button class='slds-button slds-button_neutral createrecordDataLayer-cancel' onclick="MAData.createRecordFromDataLayer.cancel_Record();">Cancel</button>
                <button class="slds-button slds-button_brand" onclick='MAData.createRecordFromDataLayer.create_step_2();'>Continue</button>
            </div>
        </div>

        <!-- Step 2 -->
        <div id='createrecordDataLayer-step2' style="display:none;" class='createrecordDataLayer-step'>
            <h1>Step 2</h1>

            <div>
                <label>Fill in the fields below</label>
                <div class="overflow" style="max-height:400px; overflow: auto;">
                    <div id='createrecordDataLayer-fieldset'></div>
                </div>
                <ul id='createrecordDataLayer-fieldset-errors'></ul>
            </div>

            <div class='createrecordDataLayer-buttons'>
                <button class='slds-button slds-button_neutral createrecord-cancel' onclick="MAData.createRecordFromDataLayer.cancel_Record();">Cancel</button>
                <button class="slds-button slds-button_brand" onclick='MAData.createRecordFromDataLayer.saveDataLayerRecord();'>Finish</button>
            </div>
        </div>

    </div>

    <!-- Create Record Popup -->
    <div id="CreateRecordPopup" class="popup_block">

        <!-- Loadmask -->
        <div id='createrecord-loadmask'></div>

        <!-- Step 1 -->
        <div id='createrecord-step1' class='createrecord-step'>
            <h1>Step 1</h1>

            <div class='createrecord-formitem'>
                <label>What would you like to create?</label>
                <select id="createrecord-object" onchange="CreateRecord_Object_Change();"></select>
            </div>
            <div class='createrecord-formitem'>
                <label>Select a record type:</label>
                <select id='createrecord-recordtype'></select>
            </div>

            <div class='createrecord-buttons'>
                <button onclick='CreateRecord_Step1_Continue();'>Continue</button>
                <button class='createrecord-cancel' onclick="CreateRecord_Cancel();">Cancel</button>
            </div>
        </div>

        <!-- Step 2 -->
        <div id='createrecord-step2' class='createrecord-step'>
            <div class="slds-text-title_caps">Step 2</div>

            <div>
                <div class="slds-text-body_regular slds-m-bottom_medium">Fill in the fields below</div>
                <ul id='createrecord-fieldset-errors'></ul>
                <div id='createrecord-fieldset'></div>
            </div>

            <div class='createrecord-buttons'>
                <button onclick='CreateRecord_Step2_Continue();'>Finish</button>
                <button class='createrecord-cancel' onclick="CreateRecord_Cancel();">Cancel</button>
            </div>
        </div>
    </div>

    <!-- LinkedIn Message Popup -->
    <div id="LinkedInMessagePopup" class="popup_block">
        <div class='loadmask-wrapper'>

            <!-- Header -->
            <h2>{!$Label.MA_Send_Message}</h2>

            <!-- Instructions -->
            <p class='popup-instructions'>{!$Label.MA_Enter_Subject_Message}</p>

            <!-- Content -->
            <table class='grid-blue'>
                <tr>
                    <td>{!$Label.MA_Subject}</td>
                    <td><input type='text' class='linkedin-message-subject' style='width: 100%; -webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box;' /></td>
                </tr>
                <tr>
                    <td>{!$Label.MA_Body}</td>
                    <td><textarea class='linkedin-message-body' style='width: 100%; height: 100px; -webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box;'></textarea></td>
                </tr>
            </table>

            <!-- Spacer -->
            <div style="height: 15px;">&nbsp;</div>

            <!-- Buttons -->
            <a class="button1-lightgray" onclick="linkedIn_SendMessage_Send();">{!$Label.MA_Send_Message}</a>
            <span class='link' style='font-size: 10px; line-height: 22px;' onclick="ClosePopupWindow();">{!$Label.MA_Cancel}</span>

        </div>
    </div>

    <!-- Export Window -->
    <div id="ExportPopup" class="popup_block">
        <h2>{!$Label.MA_Export}</h2>
        <br />
        <br />
        <a class="button1-blue" href="javascript:ClosePopupWindow();">{!$Label.MA_Close}</a>
    </div>

    <!-- Loading Popup -->
    <div id="LoadingPopup" class="popup_block">
        <table>
            <tr>
                <td>
                    <img src='{!URLFOR($Resource.MapAnything, "MapLoadingGif.gif")}' />
                </td>
                <td style="vertical-align:middle;">
                    <b>{!$Label.MA_Loading}...</b>
                </td>
            </tr>
        </table>
    </div>

    <!-- Truck Options -->
    <div id="TruckOptions" class="popup_block">
        <h2>Truck Options</h2>

        <table cellpadding="5">
            <tr>
                <td style="vertical-align:top;"><b>Hazardous Goods</b></td>
                <td>
                    <table>
                        <tr>
                            <td><input type="checkbox" name="explosive" value="explosive" />Explosive</td>
                            <td><input type="checkbox" name="gas" value="gas" />Gas</td>
                            <td><input type="checkbox" name="flammable" value="flammable" />Flammable</td>
                            <td><input type="checkbox" name="combustible" value="combustible" />Combustible</td>
                            <td><input type="checkbox" name="organic" value="organic" />Organic</td>
                        </tr>
                        <tr>
                            <td><input type="checkbox" name="poison" value="poison" />Poison</td>
                            <td><input type="checkbox" name="radioActive" value="radioActive" />Radio-Active</td>
                            <td><input type="checkbox" name="corrosive" value="corrosive" />Corrosive</td>
                            <td colspan="2"><input type="checkbox" name="other" value="other" />Other<br /></td>
                        </tr>
                        <tr>
                            <td colspan="2">
                                <input type="checkbox" name="poisonousInhalation" value="poisonousInhalation" />Poisonous upon Inhalation<br />
                            </td>
                            <td colspan="3">
                                <input type="checkbox" name="harmfulToWater" value="harmfulToWater" />Harmful to Water<br />
                            </td>
                        </tr>
                    </table>
                </td>
            </tr>
            <tr>
                <td style="vertical-align:top;"><b>Truck &amp; Trailer</b></td>
                <td>
                    <table cellpadding="3">
                        <tr>
                            <td><b>Height</b></td>
                            <td><input type="text" name="email" size="10" /></td>
                            <td style="color:#909090;">Maximum truck height in meters.</td>
                        </tr>
                        <tr>
                            <td><b>Width</b></td>
                            <td><input type="text" name="width" size="10"/></td>
                            <td style="color:#909090;">Maximum truck width in meters.</td>
                        </tr>
                        <tr>
                            <td><b>Length</b></td>
                            <td><input type="text" name="length" size="10" /></td>
                            <td style="color:#909090;">Maximum truck length in meters.</td>
                        </tr>
                        <tr>
                            <td><b>Trailer Weight</b></td>
                            <td><input type="text" name="trailerWeight" size="10"/></td>
                            <td style="color:#909090;">Maximum trailer weight in tons.</td>
                        </tr>

                    </table>
                </td>
            </tr>

        </table>

        <a class="button1-blue" href="javascript:ClosePopupWindow();">{!$Label.MA_Save_Close}</a>
    </div>

    <!-- Choose Download Type -->
    <div id="ChooseDownloadTypePopup" class="popup_block">

        <!-- Download Type Options -->
        <select id='downloadType' style="margin-right: 10px;">
            <option value="xls" data-type="application/vnd.ms-excel">xls</option>
            <option value="csv" data-type="text/csv">csv</option>
        </select>

        <a class="button1-blue" style="float: right;" href="javascript:ClosePopupWindow();">{!$Label.MA_Close}</a>
        <a class="button1-blue" style="float: right;" href="javascript:downloadRoute();">{!$Label.MA_Save}</a>
    </div>

    <!-- General Popup -->
    <div class="popup-container" id="AlertPopup" style="background-color: rgba(0, 0, 0, 0.4);">
        <div class="popup">
            <div class="popup-head">
                <h3 class="popup-title">Error Getting Position</h3>
                <h5 class="popup-sub-title">name may not be blank</h5>
            </div>
            <div class="popup-body">
            </div>
            <div class="popup-buttons">
                <a class='slds-button slds-button_brand' style='float: left;' onclick="$(this).closest('.popup-container').removeClass('active')">{!$Label.MA_Close}</a>
            </div>
        </div>
    </div>

    <!-- Create Folder PopUP -->
    <div id="CreateFolderPopup"  class="popup_block">
        <!-- Loading Wrapper -->
        <div class='loadmask-wrapper'>
            <!-- Loading -->
            <div class="saving-wrapper" style="display:none; position: absolute;background-color: rgba(255, 255, 255, 0.85);z-index: 10;width: 100%;height: 100%;">
                <div style="position:relative; width 100%; height: 150px;">
                    <div style="position: absolute;bottom: 0px;right: 0px;color: #298AD0;">Saving...</div>
                </div>
            </div>

            <!-- Header -->
            <h2 role="header">Create Folder</h2>

            <!-- Spacer -->
            <div style='height: 15px;'>&nbsp;</div>

            <!-- Instructions -->
            <div style="font-size:12px;">{!$Label.MAFavoriteLocation_Please_complete_all_information}:</div>

            <!-- Spacer -->
            <div style='height: 25px;'>&nbsp;</div>

            <!-- Location Info Table -->
            <table>
                <tr>
                    <td>
                        <div class="slds-form-element">
                          <label class="slds-form-element__label" for="text-input-id-1">{!$Label.MA_Name}</label>
                          <div class="slds-form-element__control">
                            <input maxlength='80' class="folderName slds-input" type='text' tabindex="0" role="folderName" placeholder="Enter folder name..." />
                          </div>
                        </div>
                    </td>
                </tr>
            </table>

            <!-- Spacer -->
            <div style='height: 25px;'>&nbsp;</div>

            <!-- Buttons -->
            <div class='create-location-buttons' style='overflow: hidden;'>
                <a class='slds-button slds-button_neutral' style='float: left;' onclick="ClosePopupWindow();">{!$Label.MA_Cancel}</a>
                <a class='slds-button slds-button_brand' style='float: left; margin-right:10px;' onclick="createNewFolder();" role="saveButton">{!$Label.MA_Save_Close}</a>
            </div>

        </div>
    </div>

    <!-- Save Routes Popup Missing Waypoint Name -->
    <div id="SaveRoutesPopupMissingWaypointName" class="popup_block">

        <!-- Save Options -->
        <div id='routeMessage' style="margin-bottom: 10px;">
        </div>

        <a class="button1-blue" href="javascript:CloseMessageWindow();">{!$Label.MA_Close}</a>
    </div>

    <!-- Log A Call Popup -->
    <div id="LogACallPopup" class="maModal">
        <div class="slds-scope">
            <section class="slds-modal" role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-describedby="modal-content-id-1">
                <div class="slds-modal__container">
                    <header class="slds-modal__header">
                        <button class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse js-close-this-slds-modal" title="Close" onclick="MALayers.hideModal();">
                            <span class="slds-button__icon slds-button__icon--large ma-icon ma-icon-close" aria-hidden="true"></span>
                            <span class="slds-assistive-text">Close</span>
                        </button>
                        <h2 id="modal-heading-01" class="slds-text-heading--medium slds-hyphenate maPopup-title">{!$Label.MAActionFramework_Log_a_Call}</h2>
                    </header>

                    <div class="slds-modal__content slds-p-around_medium">
                        <div class="ma-form-control-wrap">
                            <label class="ma-input-label">Subject</label>
                            <div class="ma-form-control">
                                <input class="ma-input callSubject" type="text" value="Call"/>
                            </div>
                        </div>
                        <div class="ma-form-control-wrap">
                            <label class="ma-input-label">Comments</label>
                            <div class="ma-form-control">
                                <textarea style="min-height: 66px;" class="ma-input callComments" type="text"></textarea>
                            </div>
                        </div>
                        <div class="hidden ma-form-control-wrap">
                            <label class="ma-input-label">Name</label>
                            <div class="ma-form-control icon-left">
                                <i style="color: #54698d;position: absolute;top: 6px;left: 14px;font-size: 16px;" class="MAIcon ion-android-search"></i>
                                <input class="ma-input callContact" type="text" placeholder="Search Contacts"/>
                            </div>
                        </div>
                        <div class="hidden ma-form-control-wrap">
                            <label class="ma-input-label">Related To</label>
                            <div class="ma-form-control icon-left">
                                <i style="color: #54698d;position: absolute;top: 6px;left: 14px;font-size: 16px;" class="MAIcon ion-android-search"></i>
                                <input class="ma-input callAccount" type="text" placeholder="Search Accounts"/>
                            </div>
                        </div>
                    </div>

                    <footer class="slds-modal__footer">
                        <div class="float-left footer-buttons">
                            <button class="slds-button slds-button_neutral" id="LogACallClassic" onclick="LogACallClassic();">View in Salesforce</button>
                        </div>
                        <div class="float-right footer-buttons">
                            <button class="slds-button slds-button_neutral" id="maModalClose" onclick="MALayers.hideModal('LogACallPopup',true);">{!$Label.MA_Cancel}</button>
                            <button class="slds-button slds-button_brand" onclick="logACall_Finish();">{!$Label.MA_Finish}</button>
                        </div>
                    </footer>
                </div>
            </section>
        </div>
    </div>




    <!-- Save Routes Popup -->
    <div id="SaveRoutesPopup" class="popup_block">

        <!-- Header -->
        <div class='save-route-header'>
            <h2>{!$Label.MA_Save_Route}</h2>
        </div>

        <!-- Save Options -->
        <div id='saveRouteOptions' class="slds-scope" style="margin-bottom: 15px; text-align: center;">
            <select id="savemonth">
                <option value="1">{!$Label.MA_January}</option>
                <option value="2">{!$Label.MA_February}</option>
                <option value="3">{!$Label.MA_March}</option>
                <option value="4">{!$Label.MA_April}</option>
                <option value="5">{!$Label.MA_May}</option>
                <option value="6">{!$Label.MA_June}</option>
                <option value="7">{!$Label.MA_July}</option>
                <option value="8">{!$Label.MA_August}</option>
                <option value="9">{!$Label.MA_September}</option>
                <option value="10">{!$Label.MA_October}</option>
                <option value="11">{!$Label.MA_November}</option>
                <option value="12">{!$Label.MA_December}</option>
               </select>
            <select id="saveyear">
            </select>
            <div class="inline" style="padding-left:5px;">
                <div class="slds-form-element__control slds-input-has-icon slds-input-has-icon--right slds-input-has-icon--right-compact">
        			<input type='text' id='saveactiveusers' class="slds-input" />
        			<input type='hidden' id='saveactiveusers-value' />
        			<span class="hidden MA2-loader route-search-loader" style="right: 15px;top: 7px;position: absolute;left: inherit;"></span>
        			<span class="slds-input__icon slds-icon-text-default ma-icon ma-icon-search"></span>
        		</div>
        	</div>
        </div>

        <!-- Calendar Template -->
        <div id="fullCalendar" class="calendar-container">
            <div class="full-calendar">
                <div class="calendar-head">
                    <div style='border-top-left-radius: 15px;'>{!$Label.MA_Monday}</div>
                    <div>{!$Label.MA_Tuesday}</div>
                    <div>{!$Label.MA_Wednesday}</div>
                    <div>{!$Label.MA_Thursday}</div>
                    <div>{!$Label.MA_Friday}</div>
                    <div>{!$Label.MA_Saturday}</div>
                    <div style='border-top-right-radius: 15px;'>{!$Label.MA_Sunday}</div>
                </div>
            </div>
        </div>

        <input type="hidden" id="saveRouteType" />
        <div class='save-route-buttons slds-scope'>
            <button class="slds-button slds-button_neutral" onclick="ClosePopupWindow();">{!$Label.MA_Close}</button>
            <button class="slds-button slds-button_brand" onclick="saveRoute($('#saveRouteType').val());">{!$Label.MA_Save_Close}</button>
        </div>
    </div>

    <!-- Query Editor Window -->
    <div id='queryeditor-modal' style='display: none;'>
        <div class='query-editor-modal-loader'>{!$Label.MA_Loading}...</div>
        <div class='query-editor-modal-content'></div>
    </div>




    <!-- Tooltip Template -->
    <div id='tooltip-content-template' style='display: none;'>

        <!-- Header -->
        <div class='tooltip-header'>
            <!-- -->
            <div class="savedQueryName">::QueryName::</div>

            <!-- Record Name -->
            <div class='name'>
                <a href="/::Id::" target="_blank">::Name::</a>
            </div>

            <!-- Record Address -->
            <div class='address'>
                <span class="ma-icon ma-icon-checkin slds-icon slds-icon--x-small"></span>
                <span class="address-text">::Address::</span>
            </div>
        </div>

        <!-- Tabs -->
        <div class='tabs' ContentKey="::ContentKey::">
            <ul>
                <li id='tab-info' class="tooltip-tab" data-tab="info"><a href="#pane-info-::ContentKey::">{!$Label.MA_Info}</a></li>
                <li id='tab-actions' class="tooltip-tab" data-tab="actions"><a href="#pane-actions-::ContentKey::">{!$Label.MA_Actions}</a></li>
                <li id='tab-chatter' class="tooltip-tab" data-tab="chatter" style='display: none;'><a href="#pane-chatter-::ContentKey::">{!$Label.MA_Chatter}</a></li>
                <li id='tab-relatedlist' class="tooltip-tab" data-tab="relatedlist" style='display: none;'><a href="#pane-relatedlist-::ContentKey::">{!$Label.MA_Related_Lists}</a></li>
                <li id='tab-weather' class="tooltip-tab" data-tab="weather" style='display: none;'><a href="#pane-weather-::ContentKey::">{!$Label.MA_Weather}</a></li>
                <li id='tab-live' class="tooltip-tab" data-tab="live" style='display: none;'><a href="#pane-live-::ContentKey::">Live</a></li>
                <li id='tab-history' class="tooltip-tab" data-tab="live-history" style='display: none;'><a href="#pane-history-::ContentKey::">Tracking History</a></li>
            </ul>

            <!-- Info Tab -->
            <div id="pane-info-::ContentKey::">

                <!-- Tooltips -->
                <div class="tooltips">
                    <table>

                    </table>
                </div>

            </div>

            <!-- Actions Tab -->
            <div id="pane-actions-::ContentKey::">
                <div class='layout-tooltip'></div>
            </div>

            <!--Chatter Tab -->
            <div id="pane-chatter-::ContentKey::" class='loading' style='overflow: hidden; padding: 0;'>
            </div>

            <!-- Related Lists Tab -->
            <div id="pane-relatedlist-::ContentKey::">
                <div id="ajax-::ContentKey::" style='overflow: auto;'></div>
            </div>

            <!-- Weather Tab -->
            <div id="pane-weather-::ContentKey::">
                <div id="weather-ajax-::ContentKey::"></div>
            </div>
            <!-- Live Info Tab -->
            <div id="pane-live-::ContentKey::">
                <div id="live-infobubble-content-::ContentKey::">
                    <div class="live-info live-template" style='display: none;'>
                    </div>
                </div>
            </div>

            <!-- Device History Tab -->
            <div id="pane-history-::ContentKey::">
                <div id="history-infobubble-content-::ContentKey::" class="slds-scope">
                    <div class="device-history-input live-template slds-p-bottom_small" style='display: none;'>
                        <table class="live-tracking-history-tooltip-table">
                            <caption></caption>
                            <tbody>
                                <tr>
                                    <td class="live-day-input" style="width:240px;max-width:240px;min-width:240px;">
                                        <label class="slds-form-element__label">Date</label>
                                        <input type="text" name="liveday" autocomplete="off" class="date-input live-input slds-select" />
                                    </td>
                                    <td class="time-zone-input" style="width:240px;max-width:240px;min-width:240px;">
                                        <label class="slds-form-element__label">Time Zone</label>
                                        <select class="live-input live-time-zone slds-select"></select>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="live-time-input">
                                        <label class="slds-form-element__label">Start Time</label>
                                        <input type="time" name="livestarttime" autocomplete="off" class="live-starttime time-input live-input slds-select" />
                                    </td>
                                    <td class="live-time-input">
                                        <label class="slds-form-element__label">End Time</label>
                                        <input type="time" name="liveendtime" autocomplete="off" class="live-endtime time-input live-input slds-select" />
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        <!-- ************teddy************ -->
                                        <label class="slds-form-element__label">Tracking Line Color</label>
                                        <div class="tracking-history-content">
                                            <div class="tracking-history-forms-full">
                                                <div class="live-history-color">
                                                    <input type="radio" name="colorChoice" value="#4986E7" class="colorIsChecked" checked="checked" id="cor1"/>
                                                    <label for="cor1" class="cor1"></label>
                                                    <input type="radio" name="colorChoice" value="#B5CF48" id="cor2"/>
                                                    <label for="cor2" class="cor2"></label>
                                                    <input type="radio" name="colorChoice" value="#A4BDFC" id="cor3"/>
                                                    <label for="cor3" class="cor3"></label>
                                                    <input type="radio" name="colorChoice" value="#46D6DB" id="cor4"/>
                                                    <label for="cor4" class="cor4"></label>
                                                    <input type="radio" name="colorChoice" value="#7AE7BF" id="cor5"/>
                                                    <label for="cor5" class="cor5"></label>
                                                    <input type="radio" name="colorChoice" value="#51B749" id="cor6"/>
                                                    <label for="cor6" class="cor6"></label>
                                                    <input type="radio" name="colorChoice" value="#FBD75B" id="cor7"/>
                                                    <label for="cor7" class="cor7"></label>
                                                    <input type="radio" name="colorChoice" value="#FFB878" id="cor8"/>
                                                    <label for="cor8" class="cor8"></label>
                                                    <input type="radio" name="colorChoice" value="#FF887C" id="cor9"/>
                                                    <label for="cor9" class="cor9"></label>
                                                    <input type="radio" name="colorChoice" value="#DC2127" id="cor10"/>
                                                    <label for="cor10" class="cor10"></label>
                                                    <input type="radio" name="colorChoice" value="#DBADFF" id="cor11"/>
                                                    <label for="cor11" class="cor11"></label>
                                                    <input type="radio" name="colorChoice" value="#E1E1E1" id="cor12"/>
                                                    <label for="cor12" class="cor12"></label>
                                                </div>
                                            </div>
                                        </div>
                                        <!-- ************teddy************ -->
                                    </td>
                                    <td class="live-point-density-input">
                                        <label class="slds-form-element__label">Tracking Event Density</label>
                                        <div class="slds-select_container">
                                            <select class="live-input live-point-density slds-select">
                                              <option value="100">100%</option>
                                              <option value="50">50%</option>
                                            </select>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div class="device-history-buttons live-template" style='display: none;'>
                        <div class="slds-grid slds-grid_align-end">
                            <div>
                                <img class="saving" src="/resource/1472208638000/sma__MapAnything/images/chatterstatus-loader.gif" style='display: none;' />
                                <img class="error" src="/resource/1472208638000/sma__MapAnything/images/x-22.png" title="Unable to complete Action" style='display: none;' />
                            </div>
                            <div class="slds-p-left_x-small">
                                <button class="slds-button slds-button_neutral device-history-button live-button" data-type="Standard Action" data-action="Remove History">Remove</button>
                            </div>
                            <div class="slds-p-left_x-small">
                                <button class="slds-button slds-button_brand device-history-button live-button" data-type="Standard Action" data-action="Track History">Generate Tracking History</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!--teddy-->
    <!-- Live vertice Tooltip Template -->
    <div id='live-vertice-tooltip-content-template' class="infobubble" style='display: none;'>
        <!-- Header -->
        <div class='tooltip-header'>
            <!-- -->
            <div style="margin: 0 0 5px 0;padding: 0 0 0 10px;font-size: 10px;" class="savedQueryName">::QueryName::</div>

            <!-- Record Name -->
            <div class='name'>
                <a href="/::Id::" target="_blank">::Name::</a>
            </div>

            <!-- Record Address -->
            <div class='address'>
                <span class="address-text">::Address::</span>
            </div>
        </div>
        <hr />
        <div class="device-history-vertice-info"></div>

        <div class="vertice-tooltip-button-div">
            <input style="display: block; margin: 0 auto;" type="button" class="actionbutton removeHistoryButton vertice-tooltip-button" value="Remove History" data-action="Remove History" data-type="Standard Action"></input>
        </div>
        <!--<div class="layout-tooltip">
            <div>
                    <div class="buttonset-section">
                        <div class="buttonset-section-columns">
                            <div class="buttoncolumn">
                                <input class="actionbutton disabled" type="button"  onclick="MAPlotting.tooltipActionClick(this)" value="Set Verified Location" data-type="Standard Action" data-action="Set Verified Location"></input>
                            </div>
                        </div>
                    </div>
            </div>
        </div>-->
    </div>
    <!--teddy-->

    <!--teddy-->
    <!-- Live polyline Tooltip Template -->
    <div id='live-polyline-tooltip-content-template' class="infobubble" style='display: none;'>
        <!-- Header -->
        <div class='tooltip-header'>
            <!-- -->
            <div style="margin: 0 0 5px 0;padding: 0 0 0 10px;font-size: 10px;" class="savedQueryName">::QueryName::</div>

            <!-- Record Name -->
            <div class='name'>
                <a href="/::Id::" target="_blank">::Name::</a>
            </div>

            <!-- Record Address -->
            <div class='address'>
                <span class="address-text">::Address::</span>
            </div>
        </div>
        <hr />
        <div class="device-history-polyline-info"></div>

        <div class="polyline-tooltip-button-div">
            <input style="display: block; margin: 0 auto;" type="button" class="actionbutton removeHistoryButton polyline-tooltip-button" value="Remove History" data-action="Remove History" data-type="Standard Action"></input>
        </div>
    </div>
    <!--teddy-->

    <!-- POI Totals Template -->
    <div id='poi-results-totals-template' style='display: none;'>
        <div class='poi-results-page template'>
            <div class='results-row'>::start:: - ::end:: of ::total:: for ::searchterm::</div>
        </div>
    </div>

    <!-- Territory Tooltip Template -->
    <div id='territory-tooltip-content-template' style='display: none;'>

        <!-- Territory Name -->
        <div class='name'></div>

        <!-- Aggregate Info -->
        <table>
            <tr>
                <td class='aggregate-name'></td>
                <td class='aggregate-value'></td>
            </tr>
        </table>

    </div>

    <!-- Invisible Playground (used for measuring markers) -->
    <div id='invisible' style='opacity: 0; position: absolute; z-index: -9999999999; top: -999999px; left: -99999999px;'>
    </div>

    <div id='direction-list' style='display:none;'>
        <table class='direction-table'>
        </table>
    </div>

    <!-- MA Territory Tree Templates -->
    <div id='MATerritoryTreeTemplates' style='display: none;'>

        <!-- Territory Table -->
        <table class='territory-table grid-blue'>
            <tr data-id='Territories' data-level='0'>
                <th>Territory</th>
                <th>Visible</th>
            </tr>
        </table>

        <!-- New Territory Popup -->
        <div id='NewTeritoryPopup'>

            <!-- Geometry Header -->
            <table style='border-bottom: 2px solid silver; margin-bottom: 10px; width: 100%;'>
                <tr>
                    <td style='color: rgb(34, 101, 187); font-size: 120%; font-weight: bold;'>New Territory</td>
                </tr>
            </table>

            <!-- Label -->
            <table>
                <tr>
                    <td>Please enter a label to continue:</td>
                </tr>
            </table>
            <table>
                <tr>
                    <td><input maxlength='80' class='territory-label' type='text'></input></td>
                </tr>
            </table>
        </div>

        <!-- Territory Rows -->
        <table>

            <!-- Territory Row -->
            <tr class='territory-row'>
                <td><div class='territory-row-toggle'></div><span class='name'></span></td>
                <td class='visible'><input type='checkbox' /></td>
            </tr>

            <!-- Rollup Legend Row -->
            <tr class='territory-legend-row'>
                <td class='label'></td>
                <td class='from'></td>
                <td>-</td>
                <td class='to'></td>
                <td class='color' style='vertical-align: middle; text-align: right;'><div></div></td>
            </tr>

        </table>

    </div>

    <!-- Templates -->
    <div id='templates' style='display: none;'>
        <!-- Street View Close Button -->
        <a id="closeStreetView" class="btn btn-sm btn-primary">Close Street View</a>

        <li class="poi-row slds-item clickable-item global-search-result-item global-search-result-item js-show-global-search-query-individual-item">
            <div class="slds-tile slds-media">
                <div class="slds-media__figure">
                    <div aria-hidden="true" class="slds-icon">
                        <img class='poi-image'/>
                    </div>
                </div>
                    <div class="slds-media__body">
                    <h3 class="slds-truncate"><a href='' target="_blank" class='poi-name'></a></h3>
                    <div class="slds-tile__detail slds-text-body--small">
                        <ul class="slds-list--horizontal">
                            <li class="slds-item poi-address"></li>
                        </ul>
                    </div>
                </div>
            </div>
        </li>

        <div class="dynamicFilterPopup template">
            <div style="padding: 0 5%;color: #757575;">
                <div class="MAIcon ion-information-circled" style="display: inline-block;vertical-align: top;font-size: 20px;"></div>
                <div style="color: #757575;font-size: 11px;display: inline-block;width: 90%;">This query contains dynamic filters.  Please enter values for the fields below and click continue.</div>
            </div>
            <div style='height: 120px; margin-top: 15px;'>
                <table class='form-stretch'>

                </table>
            </div>
        </div>

        <div class="queryFilter template">
            <div class="filter-row ma-form-control-wrap" data-parentfield="::parentfield::" data-fieldapiname="::fieldapiname::" data-fieldlabel="::fieldlabel::" data-operator="::operator::">
                <label class="ma-input-label"><strong>Field:</strong> ::FIELD::</label>
                <select class="ma-input fieldInput ::RowUID::" multiple="multiple" id="accountPlotDynamicField" placeholder="Field value..." type="text"></select>
            </div>
        </div>

        <!-- autocomplete -->
        <div class="autocompleteWrapper">
            <ul class="autocompleteList"></ul>
            <div class="ac-button-wrap">
                <button class="ac-button-close button-small MAbutton button-silver">Close</button>
            </div>
        </div>


        <!-- Color Picker Template -->
        <div class="MAColorPicker">
            <div class="icon-selection inline" style="width: 110px;">

            </div>
            <div class="palette inline">
                <table class="palette-table"></table>
            </div>

            <div class="footer">
                <button class="slds-button slds-button_neutral cancelPicker">Cancel</button>
                <button class="slds-button slds-button_brand confirmPicker">Done</button>
            </div>
        </div>



        <!-- Data Layer Popup V2 -->
        <div class="CreateRecordDataLayerPopup2" style="position:relative;">

            <!-- Step 1 -->
            <div class='createrecordDataLayer2-step1 createrecord-step'>
                <div class="slds-text-title_caps">Step 1</div>
                <!--<div class="overflow" style="max-height:400px; overflow: auto;">-->
                <!--    <div class='createrecord-formitem'>-->
                <!--        <label>What would you like to create?</label>-->
                <!--        <select class="createrecordDataLayer2-object" onchange="MAData.createRecordFromDataLayer.object_Change_V2();"></select>-->
                <!--    </div>-->
                <!--    <div class='createrecord-formitem'>-->
                <!--        <label>Select a record type:</label>-->
                <!--        <select class='createrecordDataLayer2-recordtype'></select>-->
                <!--    </div>-->
                <!--</div>-->
                <div class="overflow">
                    <div class="slds-form-element select2-form-element select2-form-element createrecord-formitem">
                      <label class="slds-form-element__label" for="select-01">What would you like to create?</label>
                      <div class="slds-form-element__control slds-input-has-icon slds-input-has-icon--right">
                        <span class="slds-input__icon slds-icon-text-default ma-icon ma-icon-down" aria-hidden="true"></span>
                        <div class="slds-select_container">
                          <select class="select2-fluid slds-select select2-input select2-input-hide-search createrecordDataLayer2-object" id="select-01" onchange="MAData.createRecordFromDataLayer.object_Change_V2();"></select>
                        </div>
                      </div>
                    </div>
                    <div class="slds-form-element select2-form-element select2-form-element createrecord-formitem">
                      <label class="slds-form-element__label" for="select-02">Select a record type</label>
                      <div class="slds-form-element__control slds-input-has-icon slds-input-has-icon--right">
                        <span class="slds-input__icon slds-icon-text-default ma-icon ma-icon-down" aria-hidden="true"></span>
                        <div class="slds-select_container">
                          <select class="select2-fluid slds-select select2-input select2-input-hide-search createrecordDataLayer2-recordtype" id="select-02"></select>
                        </div>
                      </div>
                    </div>
                </div>
            </div>

            <!-- Step 2 -->
            <div class='createrecordDataLayer2-step2 createrecordDataLayer-step' style="display:none;">
                <div class="slds-text-title_caps">Step 2</div>

                <div>
                    <div class="slds-text-body_regular slds-m-bottom_medium">Fill in the fields below</div>
                    <div class='createrecordDataLayer-fieldset'></div>
                    <ul class='createrecordDataLayer2-fieldset-errors'></ul>
                </div>
            </div>
        </div>

        <!-- Data Layer Popup Rows -->
        <div class="dl-filter-row dl-row">
            <div class="inline filter-content">
                <div>
                    <div style="width:30%;" class="fieldLabel inline">{!$Label.MA_TOPIC}:</div>
                    <div style="width:30%;" class="fieldLabel inline">{!$Label.MA_OPERATOR}:</div>
                    <div style="width:30%;" class="fieldLabel inline">{!$Label.MA_Value}:</div>
                </div>
                <div>
                    <div style="width:30%;" class="dl-filter-topic-wrap inline"><select></select></div>
                    <div style="width:30%;" class="dl-filter-operator-wrap inline"><select style="width:100%" class="dl-filter-operator"><option value="" disabled="disabled" selected="selected"></option></select></div>
                    <div style="width:30%;" class="inline"><div class="dl-filter-value-wrapper" style="position:relative;"><input class="dl-filter-value" type="text"/></div></div>
                </div>
                <div style="position: absolute;top: 0px;right: 0px;">
                    <button class="MA2-button-remove ion-close-circled remove-row"></button>
                </div>
            </div>
        </div>

        <div onclick="MAData.wizard.handleTooltipClick(this);" class="dl-tab template">
            <div class="transparent input">
                <input onclick="MAData.wizard.handleTooltipClick(this);" class="tab-name" type="text" value=""/>
            </div>
            <button class="MAbutton button-clear remove-tab ion-android-cancel" onclick="MAData.wizard.removeTooltipTab(this);"></button>
        </div>

        <div class="dl-tab-row">
            <div class="inline MAheader header-main">
                <div class="dl-tooltip-header" style="height:40px;border-bottom: 1px solid #C6C6C6; padding: 0px 10px;">
                    <div class="inline tab-title" style="line-height: 40px;"></div>
                    <div class="inline" style="float: right;margin-top: 7px;"><button onclick="MAData.wizard.collapseInfo(this);" class="MA2button button-xsmall icon-left ion-android-remove-circle dl-tooltip-collapse">Collapse</button></div>
                </div>
                <div class="dl-tooltip-subheader MAheader header-info header-collapse">
                    <div class="MA2-pad-10">
                    <table style="width: inherit;">
                        <tr>
                            <td>Title:</td><td><input class="tab-title-input" value="New Tab" type="text"/></td>
                        </tr>
                    </table>
                    </div>
                </div>
                <div class="MA2-divider-compact"></div>
                <div class="dl-tooltip-rows MAheader header-info header-collapse"></div>
                <div class="dl-tooltip-footer MAheader header-info header-collapse">
                    <div class="MA2-pad-10">
                    <button onclick="MAData.wizard.createToolipRow({element:this,type:'tab'});" class="MA2button button-small icon-left ion-android-add-circle addTooltipRow">Add a row</button>
                    </div>
                </div>
            </div>
            <div style="display:inline-block;vertical-align: top;">
                <button class="MA2-button-remove ion-close-circled remove-row"></button>
            </div>
        </div>

        <div class="dl-tooltip-row dl-row">
            <div class="inline" style="width:100%;">
                <div>
                    <div style="width:18%;" class="inline">{!$Label.MA_DATA_SOURCE}:</div>
                    <div style="width:30%;" class="inline dl-tooltip-file-wrap"><select class="dl-tooltip-file" style="width:100%;"><option value="--">-Select-</option></select></div>
                    <div style="width:10%;text-align: right;" class="inline">{!$Label.MA_TOPIC}:</div>
                    <div style="width:30%;" class="inline dl-tooltip-topic-wrap"><select class="dl-tooltip-topic" style="width:100%;"><option value="--">-Select-</option></select></div>
                    <div class="inline" style="vertical-align: top;"><button class="MA2-button-remove ion-close-circled remove-row"></button></div>
                </div>
            </div>
        </div>

        <div class="dl-legend-row dl-row">
            <div class="inline" style="width:100%;">
                <div>
                    <div style="width:5%;text-align: center;" class="inline dl-legend-color" data-maicon="Marker"></div>
                    <div style="width:43%;" class="inline dl-legend-operator-wrap"></div>
                    <div style="width:43%;position:relative;" class="inline dl-filter-value-wrapper"><input class="dl-filter-value-start dl-filter-autocomplete" type="text"/></div>
                    <div style="width:5%;vertical-align: top;" class="inline"><button class="MA2-button-remove ion-close-circled remove-row"></button></div>
                </div>
            </div>
        </div>
        <!-- Click 2 Create Popup V2-->
        <div class="CreateRecordPopup">

            <!-- Step 1 -->
            <div class='createrecord2-step1 createrecord-step'>
                <div class="slds-text-title_caps">Step 1</div>
                <div class="overflow">
                    <!--<div class='createrecord-formitem'>-->
                    <!--    <label>What would you like to create?</label>-->
                    <!--    <select class="createrecord2-object" onchange="c2c.CreateRecord_Object_Change();"></select>-->
                    <!--</div>-->
                    <!--<div class='createrecord-formitem'>-->
                    <!--    <label>Select a record type:</label>-->
                    <!--    <select class='createrecord2-recordtype'></select>-->
                    <!--</div>-->

                    <div class="slds-form-element select2-form-element select2-form-element createrecord-formitem">
                      <label class="slds-form-element__label" for="select-01">What would you like to create?</label>
                      <div class="slds-form-element__control slds-input-has-icon slds-input-has-icon--right">
                        <span class="slds-input__icon slds-icon-text-default ma-icon ma-icon-down" aria-hidden="true"></span>
                        <div class="slds-select_container">
                          <select class="select2-fluid slds-select select2-input select2-input-hide-search createrecord2-object" id="select-01" onchange="c2c.CreateRecord_Object_Change();"></select>
                        </div>
                      </div>
                    </div>
                    <div class="slds-form-element select2-form-element select2-form-element createrecord-formitem">
                      <label class="slds-form-element__label" for="select-02">Select a record type</label>
                      <div class="slds-form-element__control slds-input-has-icon slds-input-has-icon--right">
                        <span class="slds-input__icon slds-icon-text-default ma-icon ma-icon-down" aria-hidden="true"></span>
                        <div class="slds-select_container">
                          <select class="select2-fluid slds-select select2-input select2-input-hide-search createrecord2-recordtype" id="select-02"></select>
                        </div>
                      </div>
                    </div>
                </div>
            </div>

            <!-- Step 2 -->
            <div class='createrecord2-step2 createrecord-step' style="display:none;">
                <div class="slds-text-title_caps">Step 2</div>

                <div>
                    <div class="slds-text-body_regular slds-m-bottom_medium">Fill in the fields below</div>
                    <div class='createrecord-fieldset'></div>
                    <ul class='createrecord2-fieldset-errors'></ul>
                </div>
            </div>

        </div>

        <!-- Create Folder PopUP v2 -->
        <div class="CreateFolderPopup">
            <!-- Instructions -->
            <div style="font-size:12px; padding-bottom:15px;">{!$Label.MAFavoriteLocation_Please_complete_all_information}:</div>

            <!-- Location Info Table -->
            <table>
                <tr>
                    <div class="slds-form-element">
                          <label class="slds-form-element__label" for="text-input-id-1">{!$Label.MA_Name}</label>
                          <div class="slds-form-element__control">
                            <input maxlength='80' class="folderName slds-input" type='text' tabindex="0" role="folderName" placeholder="Enter folder name..." />
                          </div>
                        </div>
                </tr>
            </table>
        </div>

        <!-- FavoriteCreateLocation -->
        <div class="FavoriteCreateLocation slds-scope">
            <div class="slds-form-element updatefield-value-wrapper">
                <label class="slds-form-element__label">{!$Label.MA_Name}</label>
                <div class="slds-form-element__control updatefield-value">
                    <input maxlength='80' class='fav-location-name slds-input' type='text' />
                </div>
            </div>
            <div class="slds-form-element updatefield-value-wrapper">
                <label class="slds-form-element__label">{!$Label.MA_Address}</label>
                <div class="slds-form-element__control updatefield-value">
                    <textarea class='fav-location-address slds-input'></textarea>
                </div>
            </div>
            <div class="slds-form-element updatefield-value-wrapper">
                <label class="slds-form-element__label">{!$Label.MA_Description}</label>
                <div class="slds-form-element__control updatefield-value">
                    <textarea class='fav-location-description slds-input'></textarea>
                </div>
            </div>
            <div class="slds-form-element updatefield-value-wrapper">
                <label class="slds-form-element__label">{!$Label.MA_Marker}</label>
                <div class='slds-form-element__control'>
                    <div class="location-markertype-wrapper">
                        <input type='text' class='value color location-markertype-color slds-input' value='#00FF00' />
                        <select class='location-markertype-image slds-input' style='display: none;' disabled='disabled'><option value=''>{!$Label.MA_Loading}...</option></select>

                        <div class='location-markertype-selector' style='display: inline-block;'>
                            <img class='location-markertype-selector-color' src="{!URLFOR($Resource.QueryEditor, 'images/icons/color-16.png')}" />
                            <img class='location-markertype-selector-image' src="{!URLFOR($Resource.QueryEditor, 'images/icons/iconfolder-16.png')}" />
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="UpdateFieldPopup slds-scope">
            <div class="slds-form slds-form_compound">
                <fieldset class="slds-form-element">
                    <div class="slds-form-element__group">
                        <div class="slds-form-element__row">
                            <div class="slds-form-element slds-size_1-of-2 select2-form-element updatefield-query-wrapper">
                              <label class="slds-form-element__label" for="select-query">{!$Label.MA_Query}</label>
                              <div class="slds-form-element__control slds-input-has-icon slds-input-has-icon--right">
                                <span class="slds-input__icon slds-icon-text-default ma-icon ma-icon-down" aria-hidden="true"></span>
                                <div class="slds-select_container">
                                  <select class="slds-select updatefield-query select2-fluid select2-input select2-input-hide-search" onchange='UpdateField_QueryChanged();' id="select-query"></select>
                                </div>
                              </div>
                            </div>
                            <div class="slds-form-element slds-size_1-of-2 select2-form-element updatefield-field-wrapper" style="display:none;">
                              <label class="slds-form-element__label" for="select-field">{!$Label.MA_Field}</label>
                              <div class="slds-form-element__control slds-input-has-icon slds-input-has-icon--right">
                                <span class="slds-input__icon slds-icon-text-default ma-icon ma-icon-down" aria-hidden="true"></span>
                                <div class="slds-select_container">
                                  <select class="slds-select updatefield-field select2-fluid select2-input select2-input-hide-search" id="select-field" onchange='UpdateField_FieldChanged();'></select>
                                </div>
                              </div>
                            </div>
                            <!--<div class="slds-form-element slds-size_1-of-3">-->
                            <!--    <label class="slds-form-element__label" for="input-601">Value</label>-->
                            <!--    <input type="text" id="input-601" class="slds-input"></input>-->
                            <!--</div>-->
                        </div>
                    </div>
                </fieldset>
            </div>
            <!--<button class="slds-button slds-button_brand">-->
            <!--  <span class="slds-button__icon slds-button__icon--left ma-icon ma-icon-add"></span>Add New-->
            <!--</button>-->
            <div class="slds-form-element updatefield-value-wrapper" style="display:none;">
              <label class="slds-form-element__label">{!$Label.MA_Value}</label>
              <div class="slds-form-element__control updatefield-value">

              </div>
            </div>

            <div class="slds-form-element autoRefreshWrapper" style="display:none;">
                <label class="slds-form-element__label">Automatically refresh this query after completion?</label>
                <input type="checkbox" class="autoRefreshQuery"/>
            </div>
        </div>

         <!-- Listview Tab Contents -->
        <div id="ListViewTabContents">

            <div class="listview-search" >
                <div class="listview-search-wrap">
                <span class="glyphicon glyphicon-search"></span>
                <input type="text" class="listview-search-text form-control input-sm" placeholder="type search terms here..." />
                <a style="height:14px;" onclick="MAListView.SearchAll(this)" role="search" class="btn btn-sm btn-dark" >Search</a>
                <a onclick="MAListView.ClearSearchFromDOM(this)" role="clear" class="lv-search-clear" ><span class="MAIcon glyphicon-remove-circle"></span></a>
                </div>
                <a class="lv-search-advanced" onclick="MAListView.ShowFilterPopupFromDOM(this)" >Advanced Search...</a>
            </div>

            <div id="listview-table-scrollwrap">
                <table class="listview-data-table"></table>
            </div>

            <div class="listview-footer-actions">
            <table>
                <tr>
                    <td>
                        <div class="listview-record-count"></div>
                    </td>
                    <td style="padding-right:0;">
                        <div> Records per page:</div>
                    </td>
                    <td>
                        <select class="lv-records-per-page" onchange="MAListView.ChangePageSizeFromUI('::layerId::', this.value);">
                            <option value="10">10</option>
                            <option value="20">20</option>
                            <option value="30">30</option>
                            <option value="40">40</option>
                            <option value="50">50</option>
                        </select>
                    </td>

                    <td>
                        <span class="listview-pagination-control-group button-bar">
                            <a class="MAbutton button-light icon ion-ios-skipbackward" onclick="MAListView.MoveToFirstPage('::layerId::');"></a>
                            <a class="MAbutton button-light icon ion-arrow-left-b" onclick="MAListView.PageBackward('::layerId::');"></a>



                            <a class="MAbutton button-light icon ion-arrow-right-b" onclick="MAListView.PageForward('::layerId::');"></a>
                            <a class="MAbutton button-light icon ion-ios-skipforward" onclick="MAListView.MoveToLastPage('::layerId::');"></a>
                        </span>
                    </td>
                    <td>
                        <!--<a class="MAbutton button-light" onclick="MAListView.SelectAll('::layerId::');" style="display: none;">Select All</a>-->
                        <a class="MAbutton button-light" onclick="MAListView.ClearSelected('::layerId::');">Clear Selected</a>
                        <a class="MAbutton button-light listAddToRouteBtn" onclick="MAListView.addSelectedRecordsToRoute('::layerId::');">Add to Route</a>
                        <a class="MAbutton button-light icon-left ion-android-document" role="ListView-Export-Button" onclick="MAListView.ExportTab.apply(this, ['::layerId::']);">Export</a>
                    </td>
                    <td>
                        <div id="listview-tab-status-container"></div>
                    </td>
                </tr>
            </table>

            </div><!--listview-footer-actions-->
        </div>

        <!-- DataLayer Editor-->
        <div class="popup_block maPopup noPadding" id="MADataLayerEditor">
            <div id="getLayerLoading" style="display:none;">
                <div class="MA2-loading-mask">
                     <div style="" class="loadingText">
                    <div class="MA2-loader loader-inline"></div>
                    Loading...
                    </div>
                </div>
                 </div>
            <div class="maPopupLoading2" style="z-index:10;left:0;top:0;background:transparent !important;opacity:1 !important;">
                <div class="MA2-loading-mask">
                     <div style="" class="loadingText">
                    <div class="MA2-loader loader-inline"></div>
                    Loading...
                    </div>
                </div>
            </div>
            <div class="popup_header">
                <div class="header-item">
                    <div class="item">{!$Label.MA_DATA_LAYER_EDITOR}</div>
                </div>
                <button class="ma-modal-close" onclick="MAData.wizard.closePopup();"><i class="ion-close"></i></button>
            </div>

            <div class="popup_body">
                <!-- wizard -->
                <div id="dl-leftPanel" class="sidebar">
                    <div class="verticalMenu">
                        <a class="item active" onclick="MAData.wizard.changeTab(this)" id="dl-details">{!$Label.MA_NAME_YOUR_LAYER}</a>
                        <a class="item" onclick="MAData.wizard.changeTab(this)" id="dl-dataSource">{!$Label.MA_CHOOSE_DATA_SOURCE}</a>
                        <a class="item" onclick="MAData.wizard.changeTab(this)" id="dl-filtersFix">{!$Label.MA_FILTER_YOUR_LAYER}</a>
                        <a class="item" onclick="MAData.wizard.changeTab(this)" id="dl-tooltip">{!$Label.MA_ADD_DATA_TO_TOOLTIP}</a>
                        <a class="item" onclick="MAData.wizard.changeTab(this)" id="dl-filters">{!$Label.MA_STYLE_YOUR_LAYER}</a>
                    </div>
                </div>
                <div id="dl-rightPanel" class="mainBody">
                    <div data-id="dl-details" class="dl-panel tab-body MA2hidden MA2active">
                        <table class="MA2-pad-15">
                            <tr><td class="fieldLabel">{!$Label.MA_Name}*</td></tr>
                            <tr><td><input class="dl-label" type="text"/></td></tr>
                            <tr><td class="fieldLabel">{!$Label.MA_Description}</td></tr>
                            <tr><td><textarea class="dl-desc" type="text"/></td></tr>
                        </table>
                        <div class="next-DataSource MA2hidden">
                            <div class="MA2-divider-compact"></div>
                            <div class="MA2-pad-15">
                                <button onclick="MAData.wizard.changeTab($('#dl-dataSource'))" class="MAbutton button-bold button-green icon-right iconfix ion-arrow-right-b">{!$Label.MA_NEXT_STEP}</button>
                            </div>
                        </div>
                    </div>
                    <!-- Data Source for Data Layer -->
                    <div data-id="dl-dataSource" class="dl-panel MA2hidden tab-body">
                        <div class="MA2-pad-15">
                            <form>
                                <div id="dl-source" class="dl-items">
                                    <div class="dl-item">
                                        <div class="dl-number">
                                            <span class="grey-circle">1</span>
                                        </div>
                                        <div class="dl-content">
                                            <div class="source-label">{!$Label.MA_WHAT_DATA_SOURCE_WOULD_YOU_LIKE_TO_SEE}</div>
                                            <div id="dl-source-wrapper">
                                                <select id="dl-source-select" class="dl-combobox">
                                                    <option value="--">{!$Label.MA_Loading}...</option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div id="dl-level" class="dl-items MA2hidden">
                                    <div class="dl-item" style="height: 70px;">
                                        <div class="dl-number">
                                            <span class="grey-circle">2</span>
                                        </div>
                                        <div class="dl-content">
                                            <div class="source-label">{!$Label.MA_AT_WHAT_LEVEL_OF_DETAIL}</div>
                                            <div id="dl-level-wrapper">
                                                <select id="dl-level-select" class="dl-combobox">
                                                    <option value="--">-- Select --</option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div id="dl-style" class="dl-items MA2hidden" style="overflow: hidden;min-height: 280px;">
                                    <div class="dl-item">
                                        <div class="dl-number">
                                            <span class="grey-circle">3</span>
                                        </div>
                                        <div class="dl-content">
                                            <div class="source-label">{!$Label.MA_WHAT_VISUAL_STYLE_WOULD_YOU_LIKE_TO_SEE}</div>
                                        </div>
                                    </div>
                                    <div class="dl-cards">
                                        <div id="cardShape" data-id="polygon" class="dl-card hidden" onclick="MAData.selectDataLayerStyle(this);">
                                            <div class="MAIcon ion-ios-checkmark"></div>
                                            <div class="image">
                                                <img src="{!URLFOR($Resource.MapAnything, '/dataLayerBuilder/img/datathumb_shape.jpg')}"/>
                                            </div>
                                            <div class="content">
                                                <div class="header">{!$Label.MA_SHAPE}</div>
                                                <div class="info">{!$Label.MA_A_DEFINED_ENCLOSED_AREA_EG_A_STATE_OR_COUNTRY}</div>
                                            </div>
                                        </div>
                                        <div id="cardMarker" data-id="point" class="dl-card hidden" onclick="MAData.selectDataLayerStyle(this);">
                                            <div class="MAIcon ion-ios-checkmark"></div>
                                            <div class="image">
                                                <img src="{!URLFOR($Resource.MapAnything, '/dataLayerBuilder/img/datathumb_marker.jpg')}"/>
                                            </div>
                                            <div class="content">
                                                <div class="header">{!$Label.MA_Marker}</div>
                                            </div>
                                        </div>
                                        <div id="cardShape" data-id="centroid" class="dl-card hidden" onclick="MAData.selectDataLayerStyle(this);">
                                            <div class="MAIcon ion-ios-checkmark"></div>
                                            <div class="image">
                                                <img src="{!URLFOR($Resource.MapAnything, '/dataLayerBuilder/img/datathumb_centroid.jpg')}"/>
                                            </div>
                                            <div class="content">
                                                <div class="header">Centroid</div>
                                                <div class="info">A single marker representing the center of an area. &#40;e.g. a marker at the center of a state&#41;</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </form>
                        </div>
                        <div class="next-Tooltip MA2hidden">
                            <div class="MA2-divider-compact"></div>
                            <div class="MA2-pad-15">
                                <div class="greyBox MA2-pad-15" style="width: 400px;background: #f8f8f9;border-radius: .28571429rem;box-shadow: 0 0 0 1px rgba(34,36,38,.22) inset,0 0 0 0 transparent;">
                                    <div class="inline">
                                        <div style="font-size:16px;font-weight: bold;">{!$Label.MA_Great}!</div>
                                        <div style="margin-top: .25em;opacity: 0.75;">{!$Label.MA_Move_Next_Step}.</div>
                                    </div>
                                    <button style="float: right;" onclick="MAData.wizard.changeTab($('#dl-filtersFix'))" class="MAbutton button-bold button-green icon-right iconfix ion-arrow-right-b">Next Step</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- filters for data layer -->
                    <div data-id="dl-filtersFix" class="dl-panel tab-body MA2hidden MA2active">
                        <div class="MA2-pad-15">
                            <div class="source-label">{!$Label.MA_FILTER_YOUR_LAYER}.</div>
                            <div>
                                <div class="dl-content" style="margin-top: 10px;">
                                    <div id="dl-filter-wrapper">
                                        <div id="dlFilters"></div>
                                        <div>
                                            <button onclick="MAData.wizard.createFilterRow();" id="addDLFilter" class="MAbutton icon-left iconfix ion-android-add-circle">{!$Label.MA_ADD_A_FILTER}</button>
                                            <span style="line-height: 30px;font-size: 12px;margin-left: 10px;">({!$Label.MA_OPTIONAL})</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- Tooltips for Data Layer -->
                    <div data-id="dl-tooltip" class="dl-panel tab-body MA2hidden">
                        <div class="MA2-pad-15">
                            <div class="source-label">{!$Label.MA_ADD_THE_INFORMATION_YOUD_LIKE_TO_SEE_WHEN_YOU_CLICK}.</div>
                            <div>({!$Label.MA_EXAMPLE_TO_THE_RIGHT})</div>
                            <div style="min-width: 900px;">
                                <div class="inline tooltipMapBG">
                                    <div class="tooltipWrap" id="dl-tooltip-setup">
                                        <div class="MA2-pad-15-10" style="position:relative;">
                                            <div class="hearers-wrap"></div>
                                            <div style="margin-top:10px;">
                                                <button style="color: rgba(0,0,0,.6);" class="dl-headerBtn MAbutton button-small button-bold iconfix icon-left ion-android-add-circle" onclick="MAData.wizard.createToolipRow({element:this,type:'header'});">{!$Label.MA_ADD_A_HEADER}</button>
                                                <div class="dl-tooltip-help-wrapper dl-header-help">{!$Label.MA_ADD_THE_PRIMARY_SET_OF_DATA_YOUD_LIKE_TO_SEE}</div>
                                            </div>
                                        </div>
                                        <div style="padding: 5px 10px;">
                                            <div class="tabs-wrap">
                                                <div class="dl-tab active" uid="sampleTab23423" tab-index="1">
                                                    <div class="transparent input">
                                                        <input class="tab-name" onclick="MAData.wizard.handleTooltipClick(this);" type="text" value="{!$Label.MA_Info}"/>
                                                    </div>
                                                    <button class="MAbutton button-clear remove-tab ion-android-cancel" onclick="MAData.wizard.removeTooltipTab(this);"></button>
                                                </div>
                                            </div>
                                            <button onclick="MAData.wizard.createTooltipTab();" id="add-dl-tab" class="addDLTab button-bold MAbutton button-clear button-small iconfix icon-left ion-android-add-circle">{!$Label.MA_ADD_A_TAB}</button>
                                            <div class="tab-baseline"></div>
                                        </div>
                                        <div class="MA2-pad-15-10" id="dl-details-wrapper" style="position:relative;">
                                            <div class="details-wrap"></div>
                                            <div style="margin-top:10px;">
                                                <button style="color: rgba(0,0,0,.6);" class="dl-headerBtn MAbutton button-bold iconfix button-small icon-left ion-android-add-circle" onclick="MAData.wizard.createToolipRow({element:this,type:'tab'});">Add a detail</button>
                                                <div class="dl-tooltip-help-wrapper dl-details-help">{!$Label.MA_ADD_ADDITIONAL_SETS_OF_DATA_YOU_D_LIKE_TO_SEE_ON_THE_TOOLTIP}</div>
                                            </div>
                                        </div>
                                        <div class="tooltip-arrow"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- Style the Data Layer -->
                    <div data-id="dl-filters" class="dl-panel tab-body MA2hidden">
                        <div class="MA2-pad-15" style="min-width: 750px;">
                            <div class="inline" style="width: 37.5%!important;vertical-align: top;">
                                <div>
                                    <div id="dl-useFilters" class="dl-items">
                                        <div class="dl-item">
                                            <div class="dl-number">
                                                <span class="grey-circle">1</span>
                                            </div>
                                            <div class="dl-content">
                                                <div class="source-label">{!$Label.MA_WOULD_YOU_LIKE_TO_COLOR_CODE_YOUR_SHAPES_BASED_ON}</div>
                                                <div style="margin-bottom: 15px;">({!$Label.MA_EXAMPLE_TO_THE_RIGHT})</div>
                                                <div id="styleSelectWrap">
                                                    <button onclick="MAData.wizard.styleSetup(true);" class="colorLegend styleDLbtn MAbutton iconfix icon-left ion-checkmark-circled">{!$Label.MA_Yes}</button>
                                                    <button onclick="MAData.wizard.styleSetup(false);" class="staticLegend styleDLbtn MAbutton iconfix icon-left iconfix ion-close-circled">{!$Label.MA_No}</button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div id="dl-addFilters" class="dl-items MA2hidden" style="overflow: hidden;">
                                        <div class="dl-item">
                                            <div class="dl-number">
                                                <span class="grey-circle">2</span>
                                            </div>
                                            <div class="dl-content">
                                                <div class="source-label">{!$Label.MA_Select_Set_of_Info}.</div>
                                                <div class="dl-content">
                                                    <div id="dl-legendSelect-wrap">
                                                        <select id="dl-legendSelect" class="dl-combobox">
                                                            <option value="--">Loading...</option>
                                                        </select>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div id="dl-setupLegend" class="dl-items MA2hidden" style="overflow: hidden;">
                                        <div class="dl-item">
                                            <div class="dl-number">
                                                <span class="grey-circle">3</span>
                                            </div>
                                            <div class="dl-content">
                                                <div class="source-label">{!$Label.MA_Divide_Information}</div>
                                                <div class="dl-content">
                                                    <div id="legendDistButtons" class="MA2hidden MA2active">
                                                        <div data-type="decimal" data-id="auto" onclick="MAData.wizard.createLegendCheck(false,'auto');" class="dl-legitem auto"><span class="MAIcon ion-checkmark-circled"></span>{!$Label.MA_Automatically}</div>
                                                        <div data-type="decimal" data-id="quantiles" onclick="MAData.wizard.createLegendCheck(true,'quantiles');" class="dl-legitem quantiles"><span class="MAIcon ion-checkmark-circled"></span>{!$Label.MA_Even_Quantiles}</div>
                                                        <div data-type="decimal" data-id="distribution" onclick="MAData.wizard.createLegendCheck(true,'distribution');" class="dl-legitem distribution"><span class="MAIcon ion-checkmark-circled"></span>{!$Label.MA_Even_Distribution}</div>
                                                        <div data-id="manual" onclick="MAData.wizard.createLegendCheck(false,'manual');" class="dl-legitem manual"><span class="MAIcon ion-checkmark-circled"></span>{!$Label.MA_Manually}</div>
                                                    </div>
                                                    <div class="MA2hidden" id="dl-legend-options">
                                                        <div>
                                                            <div class="dl-legend-step2" id="dl-legend-minVal">
                                                                <div style="padding-top:0;" class="fieldLabel">{!$Label.MA_Minimum_value}:</div>
                                                                <div><input class="dl-legend-minVal" type="text"/></div>
                                                            </div>
                                                            <div class="dl-legend-step2" id="dl-legend-maxVal">
                                                                <div class="fieldLabel">{!$Label.MA_Maximum_value}:</div>
                                                                <div><input class="dl-legend-maxVal" type="text"/></div>
                                                            </div>
                                                            <div class="dl-legend-step2" id="dl-legend-buckets">
                                                                <div class="fieldLabel">{!$Label.MA_Number_of_buckets}:</div>
                                                                <div><input class="dl-legend-buckets" type="text"/></div>
                                                            </div>
                                                            <div style="padding: 10px 0px 6px 6px;">
                                                                <button id="cancelLegCreate" class="MAbutton iconfix icon-left ion-close-circled">{!$Label.MA_Cancel}</button>
                                                                <button onclick="MAData.wizard.createLegend('getType');" class="MAbutton button-green iconfix icon-left ion-checkmark-circled">{!$Label.MA_Create_Legend}</button>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div id="legendImagePlaceholder" class="inline">
                                <div class="legImgWrapper hidden" data-type="polygon">
                                    <img class="legendImg legendColor" data-type="colorPoly" src="{!URLFOR($Resource.MapAnything, '/dataLayerBuilder/img/legend_example.jpg')}"/>
                                    <img class="legendImg hidden legendStatic" data-type="staticPoly" src="{!URLFOR($Resource.MapAnything, '/dataLayerBuilder/img/legend_example_ncc.jpg')}"/>
                                </div>
                                <div class="legImgWrapper hidden" data-type="point">
                                    <img class="legendImg legendColor" data-type="colorPoint" src="{!URLFOR($Resource.MapAnything, '/dataLayerBuilder/img/legend_marker_multiple.jpg')}"/>
                                    <img class="legendImg hidden legendStatic" data-type="staticPoint" src="{!URLFOR($Resource.MapAnything, '/dataLayerBuilder/img/legend_marker_single.jpg')}"/>
                                </div>
                                <div style="padding-top: 15px; text-align: center;">
                                    <button onclick="MAData.wizard.updateSampleImage(this,'legendColor');" onmouseover="MAData.wizard.updateSampleImage(this,'legendColor');" style="border-color: transparent;font-weight: bold!important;min-width: 120px;padding: 4px 8px 3px;" class="MAbutton active legendSampleBtn legendColor button-silver ">{!$Label.MA_COLOR_CODED}</button>
                                    <button onclick="MAData.wizard.updateSampleImage(this,'legendStatic');" onmouseover="MAData.wizard.updateSampleImage(this,'legendStatic');" style="border-color: transparent;font-weight: bold!important;min-width: 120px;padding: 4px 8px 3px;" class="MAbutton legendSampleBtn legendStatic button-silver">{!$Label.MA_NOT_COLOR_CODED}</button>
                                </div>
                            </div>
                            <div id="dl-legend-wrap" class="hidden inline">
                                <div id="dl-legend-grid">
                                    <div class="dl-legend-header">
                                        <table>
                                            <tr>
                                                <td style="padding-top:0px;" class="fieldLabel">Title:</td>
                                                <td style="padding-top:0px;" class="fieldLabel">Subtitle:</td>
                                            </tr>
                                            <tr>
                                                <td><input style="width:80%;" class="dl-legend-title" type="text"/></td>
                                                <td><input style="width:80%;" class="dl-legend-subtitle" type="text"/></td>
                                                <td id="dl-addLegendRow-btn" class="hidden"><button style="min-width: 110px;" class="MA2button button-small icon icon-left ion-android-add-circle"  onclick="MAData.wizard.createLegendRow()">Add a Row</button></td>
                                            </tr>
                                        </table>
                                    </div>
                                    <div class="dl-legend-body">
                                        <div id="dl-legend-info-wrapper"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div id="dl-Done" class="MA2hidden">
                            <div class="MA2-divider-compact"></div>
                            <div class="MA2-pad-15">
                                <div class="greyBox MA2-pad-15 slds-scope" style="width: 400px;background: #f8f8f9;border-radius: .28571429rem;box-shadow: 0 0 0 1px rgba(34,36,38,.22) inset,0 0 0 0 transparent;">
                                    <div class="inline" style="margin-right: 65px;">
                                        <div style="font-size:16px;font-weight: bold;">{!$Label.MA_YOU_RE_FINSIHED}!</div>
                                    </div>
                                    <button class="slds-button slds-button_brand savePlotDataLayer" onclick="MAData.wizard.saveDataLayer(true)">{!$Label.MA_SAVE_AND_PLOT}</button>
                                    <button class="slds-button slds-button_brand saveDataLayer" onclick="MAData.wizard.saveDataLayer()">{!$Label.MA_Save}</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Footer buttons -->
            <div class="popup_footer slds-scope">
                <div class="MA2-pad-10-15 MA2-clearfix">
                <div class="float-left">
                    <button style="display:none;" class="MA2button icon icon-left ion-help-circled">Help</button>
                </div>
                    <div class="notificationMsg float-left"></div>
                <div class="float-right">
                    <button class="slds-button slds-button_neutral" onclick="MAData.wizard.closePopup();">{!$Label.MA_Cancel}</button>
                    <button class="slds-button slds-button_brand savePlotDataLayer" onclick="MAData.wizard.saveDataLayer(true)">{!$Label.MA_SAVE_AND_PLOT}</button>
                    <button class="slds-button slds-button_brand saveDataLayer" onclick="MAData.wizard.saveDataLayer()">{!$Label.MA_Save}</button>
                </div>
                </div>
            </div>
        </div>

        <!-- ListView Filter Popup -->
        <div class="popup_block" id="listview-filter-popup">
            <h2>List View: Advanced Search</h2>
            <div class="hr"></div>
            <div class="lvas-scrollwrap">
            <table id="listview-filters-table" cellpadding="1">

            </table>
            </div>
            <div class="hr"></div>
            <div class="inline button-wrapper slds-scope">
                <a class="slds-button slds-button_neutral" onclick="MAListView.closeAndClearFilterPopup();">Clear</a>
                <a class="slds-button slds-button_neutral" onclick="ClosePopupWindow();">Cancel</a>
                <a class="slds-button slds-button_brand" onclick="MAListView.closeFilterPopup();">Save</a>
            </div>
        </div>

        <!-- Directions Row Template -->
        <div id="DirectionsTemplate">
            <table>
                <tr class='directions-waypoint-row'>
                    <td class='name'></td>
                </tr>
                <tr class='directions-row'>
                    <td class='index'></td>
                    <td><img class='directions-image'/></td>
                    <td class='directions'></td>
                </tr>
            </table>
        </div>


        <!-- Current Location Weather Template -->
        <div id="CurrentLocationWeatherTemplate">

            <b style="font-size:18px;">{!$Label.MA_Current_Forecast}</b>

            <table border="0" style="width:400px; margin-bottom:20px;">
                <tr>
                    <td style="font-weight:bold; font-size: 14px;" colspan="3">::weather::</td>
                </tr>
                <tr>
                    <td style="width:120px; vertical-align:middle;">
                        ::icon::
                    </td>
                    <td style="text-align:center; vertical-align:middle;">
                        <span style="font-weight:bold; font-size: 20px;">::avgTempF::&deg;F</span>
                        <br />{!$Label.MA_Feels_Like} ::feelslikeF::&deg;F
                    </td>
                    <td>
                        <table border="0" cellpadding="3" cellspacing="0">
                            <tr>
                                <td><b>{!$Label.MA_High}</b></td>
                                <td>::maxTempF::&deg;F (::maxTempC::&deg;C)</td>
                            </tr>
                            <tr>
                                <td><b>{!$Label.MA_Low}</b></td>
                                <td>::minTempF::&deg;F (::minTempC::&deg;C)</td>
                            </tr>
                            <tr>
                                <td><b>{!$Label.MA_Precipitation}</b></td>
                                <td>::pop::%</td>
                            </tr>
                            <tr>
                                <td><b>{!$Label.MAWeather_Humidity}</b></td>
                                <td>::humidity::%</td>
                            </tr>
                            <tr>
                                <td><b>{!$Label.MAWeather_Winds}</b></td>
                                <td>::windDir:: at ::windSpeedMPH:: mph</td>
                            </tr>

                        </table>
                    </td>


                </tr>

            </table>

            <b style="font-size:18px;">{!$Label.MA_Future_Forecast}</b>
        </div>

        <!-- Location Weather Template -->
        <div id="LocationWeatherTemplate">
            <table border="0" style="border-bottom: 1px solid black; width:400px;">
                <tr>
                    <td style="width:120px; vertical-align:middle;">::icon::</td>
                    <td>
                        <table border="0" cellpadding="3" cellspacing="0">
                            <tr>
                                <td colspan="4" style="font-weight:bold; font-size: 14px;">
                                    ::date::
                                </td>
                            </tr>
                            <tr>
                                <td colspan="4">
                                    ::weather::
                                </td>
                            </tr>
                            <tr>
                                <td><b>{!$Label.MA_High}</b></td>
                                <td>::maxTempF::&deg;F (::maxTempC::&deg;C)</td>
                                <td style="padding-left:10px;"><b>{!$Label.MA_Precipitation}</b></td>
                                <td>::pop::%</td>
                            </tr>
                            <tr>
                                <td><b>{!$Label.MA_Low}</b></td>
                                <td>::minTempF::&deg;F (::minTempC::&deg;C)</td>
                                <td style="padding-left:10px;"><b>{!$Label.MAWeather_Humidity}</b></td>
                                <td>::humidity::%</td>
                            </tr>
                            <tr>
                                <td><b>{!$Label.MAWeather_Winds}</b></td>
                                <td colspan="3">::windDir:: at ::windSpeedMPH:: mph</td>
                            </tr>

                        </table>

                    </td>


                </tr>

            </table>

        </div>

        <!-- Plotted Query Template -->
        <div class="PlottedRowUnit-DataLayer">

            <!-- Load Mask -->


            <!-- Header -->
            <div class='header'>
                <div class="loading-icon-positioning queryLoader" style="width: 21px;height: 20px;padding-left: 18px;padding-top: 8px;">
                    <div class="MA2-loader loader-inline"></div>
                </div>
                <div class="ftu-icon-left queryIcon">
                    <div class="ftu-icon-icon inline" type="marker"></div>
                </div>
                <div style="display:none;" class="ftu-icon-left queryError">
                    <div class="ftu-icon-icon inline"><span class="MAIcon ion-android-warning" style="font-size: 24px;color: #C71F1F;"></span></div>
                </div>

                <div class='icon'>
                    <div class='color-box'></div>
                    <div class="loading-icon"><span class="MAIcon glyphicon-refresh"></span></div>
                </div>

                <!-- Basic Info -->
                <div class='basicinfo'>
                    <div class='basicinfo-name'>&nbsp;</div>
                    <div class='basicinfo-baseobjectname'>&nbsp;</div>
                                <!--ftu-tooltip-->
            <div class="ftu-tooltip-arrow"></div>
            <div class="ftu-tooltip">
                <div class="ftu-tooltip-inner">
                    <div class="ftu-tooltip-pad">
                        <div class="ft-tooltip-title">::TOOLTIP-TITLE::</div>
                        <div class="ft-tooltip-desc">::TOOLTIP-DESC::</div>
                        <div class="ft-tooltip-baseob">
                                        <!--<b>Base object:</b> ::TOOLTIP-BASEOBJ::&nbsp;&bull;&nbsp;<span class="ft-tooltip-plotonload"><b>Plot On Load:</b> ::TOOLTIP-PLOTONLOAD::</span></div>-->
                                        <table>
                                            <tbody>
                                                <tr class="tooltip-row">
                                                    <td class="label">
                                                        <b>Base object</b>
                                                    </td>
                                                    <td class="value">
                                                        ::TOOLTIP-BASEOBJ::
                                                    </td>
                                                </tr>
                                                <tr class="tooltip-row ft-tooltip-plotonload">
                                                    <td class="label">
                                                        <b>Plot On Load</b>
                                                    </td>
                                                    <td class="value">
                                                        ::TOOLTIP-PLOTONLOAD::
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                    </div>
                      <div class="ftu-tooltip-pad-gray">
                          <table>
                            <tbody>
                                <tr class="tooltip-row">
                                    <td class="label">
                                        <b>Created</b>
                                    </td>
                                    <td class="value">
                                        ::TOOLTIP-CREATED::
                                    </td>
                                </tr>
                                <tr class="tooltip-row">
                                    <td class="label">
                                        <b>Last modified</b>
                                    </td>
                                    <td class="value">
                                        ::TOOLTIP-MODIFIED::
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div><!--end-ftu-tooltip-->
                </div>

                <!-- Menu -->
                <div class="inline visibility-wrapper">
                    <button style="float:right;" class='inline btn-remove btn-lg'><span class="MAIcon glyphicon-remove-circle" aria-hidden="true"></span></button>
                    <div style="float:right;" class="drop-menu-wrapper inline query-options">
                        <button class="inline plotted-menu-icon btn-lg"><span class="glyphicon glyphicon-option-vertical" aria-hidden="true"></span></button>
                        <ul class="drop-down-menu query-menu-options">
                            <li role="presentation" class="dropdown-header">{!$Label.MA_Options}</li>
                            <li role="presentation" class='drop-menu-item item-selectable edit-query'><a role="menuitem">{!$Label.MA_Edit}</a></li>
                            <li role="presentation" class='drop-menu-item item-selectable refresh-query'><a role="menuitem">{!$Label.MA_REFRESH}</a></li>
                            <li role="presentation" class='drop-menu-item item-selectable fit-query'><a role="menuitem">{!$Label.MA_Zoom_To_Fit}</a></li>
                        </ul>
                    </div>
                    <div style="float:right;" class="drop-menu-wrapper inline query-visibility" onmouseleave="MAPlotting.queryActions.showHideHoverOptions(this,'hide');" onmouseenter="MAPlotting.queryActions.showHideHoverOptions(this,'show');">
                        <button class="inline plotted-visibile-icon btn-lg">
                            <span class="MAIcon glyphicon-eye-close" aria-hidden="true"></span>
                            <span class="multi-select" aria-hidden="true"></span>
                            <span><div class="select-icon"></div></span>
                        </button>
                        <ul class="drop-down-menu renderButtons" role="menu" aria-labelledby="dropdownMenu2">
                            <li role="presentation" class="dropdown-header">Query display</li>
                            <li role="presentation" class="drop-menu-item hide-markers"><a role="menuitem" tabindex="-1"><input id="select-hide" class="item-selectable" type="checkbox" onchange="MADemographicLayer.showHideMarkers(this)" checked="true"/> &nbsp;Markers are visible</a></li>
                            <li role="presentation" class="list-divider"></li>
                            <li onclick="MADemographicLayer.renderSelection(this);" role="presentation" class="drop-menu-item item-selectable"><a data-renderAs='Markers' class="renderButtons-button markers" role="menuitem"><img src="{!URLFOR($Resource.MapAnything, '/images/ui-icons/icon_pin.png')}"/> &nbsp;{!$Label.MA_Render_Markers}</a></li>
                            <li onclick="MADemographicLayer.renderSelection(this);" role="presentation" class="drop-menu-item item-selectable"><a data-renderAs='Cluster' class="renderButtons-button cluster" role="menuitem"><img src="{!URLFOR($Resource.MapAnything, '/images/ui-icons/icon_cluster.png')}"/> &nbsp;{!$Label.MA_Render_Clusters}</a></li>
                        </ul>
                    </div>

                </div>

                <!-- Loading Indicator -->
                <div class='loader'></div>

            </div>

            <!-- Plotting Info -->
            <div class='plottinginfo-wrapper'>
                <div class="inline plotted-info-icon"><span class="glyphicon glyphicon-info-sign" aria-hidden="true"></span></div>
                <div style='margin-top:6px;' class='inline status'></div>
                <div class='info'></div>
            </div>

            <!-- Legend -->
            <!--<div class='legend-moreless' style='display: none; color: #949494; text-align: center; cursor: pointer; padding: 0 10px 5px 0;'>{!$Label.MA_Show_All}</div>-->
            <div class="legend-moreless-wrapper legend-moreless" style='display: none;'>
                <div class="inline legend-moreless-checkbox">
                    <div class="iconWrapper checked">
                    </div>
                </div>
                <div class="inline legend-moreless-text">
                    <span style='font-size: 12px;' class='moreless-text'>{!$Label.MA_Show_All}</span>
                    <span style='font-size: 16px;' class='MAIcon glyphicon-collapse-down'></span>
                </div>
            </div>
            <table class='legend' style='display: none;'></table>
            <div class='legend-showhide' style='display: none; text-align: center; cursor: pointer; padding: 5px 0;'><span class="glyphicon glyphicon-triangle-top" aria-hidden="true"></span> <span class="options-text">{!$Label.MA_Hide_Legend}</span></div>




        </div>

        <!-- Plotted Query Template -->
        <div class="PlottedRowUnit">

            <!-- Load Mask -->
            <div class='loadMask'></div>

            <!-- Header -->
            <div class='header'>
                <div class="loading-icon-positioning queryLoader" style="width: 21px;height: 20px;padding-left: 18px;padding-top: 8px;">
                    <div class="MA2-loader loader-inline"></div>
                </div>
                <div class="ftu-icon-left queryIcon">
                    <div class="ftu-icon-icon inline" type="marker"></div>
                </div>
                <div style="display:none;" class="ftu-icon-left queryError">
                    <div class="ftu-icon-icon inline"><span class="MAIcon ion-android-warning" style="font-size: 24px;color: #C71F1F;"></span></div>
                </div>

                <div class='icon'>
                    <div class='color-box'></div>
                    <div class="loading-icon"><span class="MAIcon glyphicon-refresh"></span></div>
                </div>

                <!-- Basic Info -->
                <div class='basicinfo'>
                    <div class='basicinfo-name'>&nbsp;</div>
                    <div class='basicinfo-baseobjectname'>&nbsp;</div>
                                <!--ftu-tooltip-->
            <div class="ftu-tooltip-arrow"></div>
            <div class="ftu-tooltip">
                <div class="ftu-tooltip-inner">
                    <div class="ftu-tooltip-pad">
                        <div class="ft-tooltip-title">::TOOLTIP-TITLE::</div>
                        <div class="ft-tooltip-desc">::TOOLTIP-DESC::</div>
                        <div class="ft-tooltip-baseob">
                                        <!--<b>Base object:</b> ::TOOLTIP-BASEOBJ::&nbsp;&bull;&nbsp;<span class="ft-tooltip-plotonload"><b>Plot On Load:</b> ::TOOLTIP-PLOTONLOAD::</span></div>-->
                                        <table>
                                            <tbody>
                                                <tr class="tooltip-row">
                                                    <td class="label">
                                                        <b>Base object</b>
                                                    </td>
                                                    <td class="value">
                                                        ::TOOLTIP-BASEOBJ::
                                                    </td>
                                                </tr>
                                                <tr class="tooltip-row ft-tooltip-plotonload">
                                                    <td class="label">
                                                        <b>Plot On Load</b>
                                                    </td>
                                                    <td class="value">
                                                        ::TOOLTIP-PLOTONLOAD::
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                    </div>
                      <div class="ftu-tooltip-pad-gray">
                          <table>
                            <tbody>
                                <tr class="tooltip-row">
                                    <td class="label">
                                        <b>Created</b>
                                    </td>
                                    <td class="value">
                                        ::TOOLTIP-CREATED::
                                    </td>
                                </tr>
                                <tr class="tooltip-row">
                                    <td class="label">
                                        <b>Last modified</b>
                                    </td>
                                    <td class="value">
                                        ::TOOLTIP-MODIFIED::
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div><!--end-ftu-tooltip-->
                </div>

                <!-- Menu -->
                <div class="inline visibility-wrapper">
                    <button style="float:right;" class='inline btn-remove btn-lg'><span class="MAIcon glyphicon-remove-circle" aria-hidden="true"></span></button>
					<div style="float:right;" class="drop-menu-wrapper inline query-options" onmouseleave="MAPlotting.queryActions.showHideHoverOptions(this,'hide');" onmouseenter="MAPlotting.queryActions.showHideHoverOptions(this,'show');">
            			<button class="inline plotted-menu-icon btn-lg"><span class="glyphicon glyphicon-option-vertical" aria-hidden="true"></span></button>
                		<ul class="drop-down-menu query-menu-options">
							<li role="presentation" class="dropdown-header">{!$Label.MA_Options}</li>
							<li role="presentation" class='drop-menu-item item-selectable edit-query' onclick="MAPlotting.queryActions.handleQueryOptions(this,'editQuery');"><a role="menuitem">{!$Label.MA_Edit}</a></li>
							<li role="presentation" class='drop-menu-item item-selectable refresh-query' onclick="MAPlotting.queryActions.handleQueryOptions(this,'refreshQuery');"><a role="menuitem">{!$Label.MA_REFRESH}</a></li>
							<li role="presentation" class='drop-menu-item item-selectable fit-query' onclick="MAPlotting.queryActions.handleQueryOptions(this,'zoomToFit');"><a role="menuitem">{!$Label.MA_Zoom_To_Fit}</a></li>
							<li role="presentation" class='drop-menu-item item-selectable live live-remove-all-tracking-histories' onclick="MAPlotting.queryActions.handleQueryOptions(this,'live-remove-all-tracking-histories');"><a role="menuitem">{!$Label.MA_REMOVE_ALL_TRACKING_HISTORIES}</a></li>
						</ul>
					</div>
					<div style="float:right;" class="drop-menu-wrapper inline query-visibility" onmouseleave="MAPlotting.queryActions.showHideHoverOptions(this,'hide');" onmouseenter="MAPlotting.queryActions.showHideHoverOptions(this,'show');">
	                	<button class="inline plotted-visibile-icon btn-lg">
	                		<span class="MAIcon glyphicon-eye-close" aria-hidden="true"></span>
	                		<span class="multi-select" aria-hidden="true"></span>
	                		<span><div class="select-icon"></div></span>
	                	</button>
	            		<ul class="drop-down-menu renderButtons" role="menu" aria-labelledby="dropdownMenu2">
							<li role="presentation" class="dropdown-header">Query display</li>
							<li role="presentation" class="drop-menu-item hide-markers"><a role="menuitem" tabindex="-1"><input id="select-hide" class="item-selectable" type="checkbox" onchange="MAPlotting.queryActions.showHideMarkers(this)" checked="true"/> &nbsp;Markers are visible</a></li>
							<li role="presentation" class="list-divider"></li>
							<li onclick="MAPlotting.queryActions.renderSelection(this);" role="presentation" class="drop-menu-item item-selectable"><a data-renderAs='Markers' class="renderButtons-button markers" role="menuitem"><img src="{!URLFOR($Resource.MapAnything, '/images/ui-icons/icon_pin.png')}"/> &nbsp;{!$Label.MA_Render_Markers}</a></li>
							<li onclick="MAPlotting.queryActions.renderSelection(this);" role="presentation" class="drop-menu-item item-selectable"><a data-renderAs='Cluster' class="renderButtons-button cluster" role="menuitem"><img src="{!URLFOR($Resource.MapAnything, '/images/ui-icons/icon_cluster.png')}"/> &nbsp;{!$Label.MA_Render_Clusters}</a></li>
							<li onclick="MAPlotting.queryActions.renderSelection(this);" role="presentation" class="drop-menu-item item-selectable"><a data-renderAs='Heatmap' class="renderButtons-button heatmap" role="menuitem"><img src="{!URLFOR($Resource.MapAnything, '/images/ui-icons/icon_heatmap.png')}"/> &nbsp;{!$Label.MA_Render_Heatmap}</a></li>
							<li onclick="MAPlotting.queryActions.renderSelection(this);" role="presentation" class="drop-menu-item item-selectable"><a data-renderAs='Scatter' class="renderButtons-button scatter" role="menuitem"><img src="{!URLFOR($Resource.MapAnything, '/images/ui-icons/icon_scatter.png')}"/> &nbsp;{!$Label.MA_Render_Scatter}</a></li>
						</ul>
					</div>
                </div>

                <!-- Loading Indicator -->
                <div class='loader'></div>

            </div>

            <!-- Plotting Info -->
            <div class='plottinginfo-wrapper'>
                <div class="inline plotted-info-icon"><span class="glyphicon glyphicon-info-sign" aria-hidden="true"></span></div>
                <div style='margin-top:6px;' class='inline status'></div>
                <div class='live_legend_info'></div>
                <div class='info'></div>
            </div>

            <!-- Heatmap Options -->
            <div class="heatmap-opitons" style="padding:10px; display:none;">
                <div style="text-align: center;border-bottom: 1px solid #E8E8E8;padding-bottom: 3px;">Heatmap Options</div>

                <table>
                    <tbody>
                        <tr>
                            <td>
                                <div class="inline">
                        <span style="color: #949494;">Dissipate with zoom:</span>
                        <input checked="checked" id="heatDissipate" type="checkbox"/>
                    </div>
                            </td>
                            <td>
                                <div class="inline">
                        <span style="color: #949494;">Opacity: </span>
                        <select style="background-color: rgb(248, 248, 248);border: 1px solid silver;text-align: center;" class="heatmapOpacity">
                             <option value="0.05">5%</option>
                             <option value="0.10">10%</option>
                             <option value="0.15">15%</option>
                             <option value="0.20">20%</option>
                             <option value="0.25">25%</option>
                             <option value="0.30">30%</option>
                             <option value="0.35">35%</option>
                             <option value="0.40">40%</option>
                             <option value="0.45">45%</option>
                             <option value="0.50">50%</option>
                             <option value="0.55">55%</option>
                             <option value="0.60">60%</option>
                             <option value="0.65">65%</option>
                             <option value="0.70">70%</option>
                             <option value="0.75">75%</option>
                             <option selected="selected" value="0.80">80%</option>
                             <option value="0.85">85%</option>
                             <option value="0.90">90%</option>
                             <option value="0.95">95%</option>
                             <option value="1">100%</option>
                         </select>
                    </div>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <div class="inline">
                        <span style="color: #949494;" class="inline">{!$Label.MA_MAX_INTENSITY}:</span>
                        <input value="5" style="width: 40px;background-color: rgb(248, 248, 248);border: 1px solid silver;text-align: center;" id="heatIntensity" type="text"/>
                    </div>
                            </td>
                            <td>
                                <div class="inline">
                        <span style="color: #949494;">Radius:</span>
                        <input value="15" style="width: 40px;background-color: rgb(248, 248, 248);border: 1px solid silver;text-align: center;" id="heatRadius" type="text"/>
                    </div>
                            </td>
                        </tr>
                        <tr>
                            <td colspan="2">
                                <a onclick="MAPlotting.updateHeatMapOptions(this);" class="btn updateHeatmap saveHeatmap">Save Changes</a>
                            </td>
                        </tr>
                    </tbody>
                </table>
                </div>











            <!-- Legend -->
            <!--<div class='legend-moreless' style='display: none; color: #949494; text-align: center; cursor: pointer; padding: 0 10px 5px 0;'>{!$Label.MA_Show_All}</div>-->
            <div class="legend-moreless-wrapper legend-moreless" style='display: none;'>
                <div class="inline legend-moreless-checkbox">
                    <div class="iconWrapper checked">
                    </div>
                </div>
                <div class="inline legend-moreless-text">
                    <span style='font-size: 12px;' class='moreless-text'>{!$Label.MA_Show_All}</span>
                    <span style='font-size: 16px;' class='MAIcon glyphicon-collapse-down'></span>
                </div>
            </div>
            <table class='legend' style='display: none;'></table>
            <div class='legend-showhide' style='display: none; text-align: center; cursor: pointer; padding: 5px 0;'><span class="glyphicon glyphicon-triangle-top" aria-hidden="true"></span> <span class="options-text">{!$Label.MA_Hide_Legend}</span></div>




        </div>
         <!-- ArcGIS Layer Template -->
        <div class="ArcGISLayerTemplate PlottedRowUnit-ArcGisOnline">
            <div class='header'>
                <table style="width: 100%;">
                    <tr>
                        <td style="width: 25px;">
                            <div class="loading-icon-positioning queryLoader" style="width: 21px;height: 20px;padding-left: 18px;padding-top: 8px;display: none;">
                                <div class="MA2-loader loader-inline"></div>
                            </div>
                            <img style="display:none;" class="arcGISQueryImage" width="25" height="25" src="{!URLFOR($Resource.MapAnything, 'malayersv2/img/maforarcgis-icon.svg')}"/>
                        </td>
                        <td class="layername">

                        </td>
                        <td style="text-align:right;">
                            <button class="inline btn-remove btn-lg"><span aria-hidden="true" class="MAIcon glyphicon-remove-circle"></span></button>
                        </td>
                    </tr>
                </table>
            </div>
        </div>
        <!--arcGIS click to create configure input template-->
        <div id="arc-config-input-template">
            <div class='arc-config-input'>
                <div class="slds-form-element select2-form-element select2-form-element slds-form-element--has-hover-tooltip form-column-width-1 slds-p-top--small">
          			<label class="slds-form-element__label" for="">
                  		<abbr class="slds-required" title="required">*</abbr>
          				Web Map Layer(s)
          			</label>
          			<div class="slds-form-element__control slds-input-has-icon slds-input-has-icon--right">
          			    <span class="slds-input__icon slds-icon-text-default ma-icon ma-icon-down" aria-hidden="true"></span>
                        <div class="slds-select_container">
            		        <select id="" class="select2-fluid slds-select web-map-layer-select field-mapping-select" filteredBy="" data-api="">
            				    <option value="" disabled="disabled" selected="selected">--Select--</option>

            				</select>
        				</div>
          			</div>
          			<div class="slds-popover slds-nubbin--left-top slds-popover--tooltip slds-popover--positioned-right-input-width-field" role="dialog">
          				<div class="slds-popover__body has-highlighted-text">
          					<p>Select the Web Map Layer you would like applied to this template</p>
          				</div>
          			</div>
          		</div>
          		<div class="slds-form-element select2-form-element form-column-width-1 slds-p-top--small">
          			<label class="slds-form-element__label" for="">
                  		<abbr class="slds-required" title="required">*</abbr>
          				Salesforce Object
          			</label>
          			<div class="slds-form-element__control slds-input-has-icon slds-input-has-icon--right">
          			    <span class="slds-input__icon slds-icon-text-default ma-icon ma-icon-down" aria-hidden="true"></span>
                        <div class="slds-select_container">
            		        <select id="" class="select2-fluid slds-select select2-input salesforce-object-select" filteredBy="" placeholder="--Select--" data-api="">
            				    <option value="" disabled="disabled" selected="selected">--Select--</option>
            				</select>
        				</div>
          			</div>
          		</div>
          		<div class="slds-form-element select2-form-element form-column-width-1 slds-p-top--small">
          			<label class="slds-form-element__label" for="">
                  		<abbr class="slds-required" title="required">*</abbr>
          				Record Type
          			</label>
          			<div class="slds-form-element__control slds-input-has-icon slds-input-has-icon--right">
          			    <span class="slds-input__icon slds-icon-text-default ma-icon ma-icon-down" aria-hidden="true"></span>
                        <div class="slds-select_container">
            		        <select id="" class="select2-fluid slds-select select2-input record-type-select" filteredBy="" data-api="">
            				    <option value="" disabled="disabled" selected="selected">--Select--</option>

            				</select>
        				</div>
          			</div>
          		</div>
          		<div class="slds-form-element select2-form-element form-column-width-1 slds-p-top--small">
          			<label class="slds-form-element__label" for="">
                  		<abbr class="slds-required" title="required">*</abbr>
          				Field Set
          			</label>
          			<div class="slds-form-element__control slds-input-has-icon slds-input-has-icon--right">
          			    <span class="slds-input__icon slds-icon-text-default ma-icon ma-icon-down" aria-hidden="true"></span>
                        <div class="slds-select_container">
            		        <select id="" class="select2-fluid slds-select select2-input field-set-select field-mapping-select" filteredBy="" data-api="">
            				    <option value="" disabled="disabled" selected="selected">--Select--</option>

            				</select>
        				</div>
          			</div>
          		</div>
          	</div>
  		</div>
  		<!--ArcGIS Click2Create Field Mappings Template-->
  		<div id="arc-field-mapping-template">
            <div class='arc-field-mapping-input'>
                <article class="slds-card slds-p-around--medium disabled">
            		<div id="fieldMappingsContainer">
            			<table class="slds-table slds-table--cell-buffer slds-no-row-hover slds-table--rounded field-values-logic-table" id="visitFieldValuesLogicTable">
            			    <thead>
            					<tr>
            						<th scope="col" class="th-table-header">
            						    <div class="slds-text-title_caps">Salesforce Fields</div>
            						</th>
            						<th scope="col" class="th-table-header">
            						    <div class="slds-text-title_caps">ArcGIS Fields</div>
            						</th>
            					</tr>
            				</thead>
            			    <tbody>
            			        <tr>
            			            <td>
                                	  	<div class="slds-m-top_x-small slds-form-element select2-form-element">
                			                <div class="slds-form-element__control slds-input-has-icon slds-input-has-icon--right">
                            	  			    <span class="slds-input__icon slds-icon-text-default ma-icon ma-icon-down" aria-hidden="true"></span>
                                                <div class="slds-select_container">
                            	    		        <!--<select id="uniqueIDSelect" class="slds-select select2-input" filteredBy="" data-api="">-->
                            	    		        <select class="select2-fluid slds-select select2-input uniqueIDSelect" filteredBy="" data-api="">
                            	    				    <option value="" disabled="disabled" selected="selected">--Select--</option>

                            	    				</select>
                            					</div>
                            	  			</div>
                            	  	    </div>
            			            </td>
            			            <td>
            			                <div class="static-field"><abbr class="slds-required" title="required">*</abbr>Unique ID</div>
            			            </td>
            			        </tr>
            			    </tbody>
                        </table>
            		</div>
            	</article>
            	<button id="createArcTemplate" class="slds-button slds-button_success slds-m-top_medium slds-m-bottom_medium" disabled="disabled">Create template</button>
            </div>
  		    <table>
            	<tr class='field-match-row template'>
    	            <td>
    	                <div class="static-field">::sObjectField::</div>
    	            </td>
    	            <td>
    	              <div class="slds-form-element select2-form-element">
    	                <div class="slds-form-element__control slds-input-has-icon slds-input-has-icon--right">
        	  			    <span class="slds-input__icon slds-icon-text-default ma-icon ma-icon-down" aria-hidden="true"></span>
                            <div class="slds-select_container">
        	    		        <select id="" class="select2-fluid slds-select select2-input-template webmap-field-select" filteredBy="" data-api="">
        	    				    <option value="" disabled="disabled" selected="selected">--Select--</option>

        	    				</select>
        					</div>
        	  			</div>
        	  		  </div>
    	            </td>
    	        </tr>
    	   </table>

  		<!--this is the template for arcGIS click2create template rows.-->
      		<table>
      		    <tr class="click-2-create-template-row">
                  <td role="gridcell" style="width:3.25rem;">
    		        <div class="slds-form-element">
                        <label class="slds-checkbox_toggle slds-grid">
                          <input type="checkbox" class="webmap-active" name="checkbox" aria-describedby="toggle-desc" checked=""></input>
                          <span id="toggle-desc" class="slds-checkbox_faux_container" aria-live="assertive">
                            <span class="slds-checkbox_faux"></span>
                          </span>
                        </label>
                      </div>
    	       	  </td>
                  <td scope="row" data-label="Web Map Layers">
                    <div class="slds-truncate web-map-layers" title="::webMapLayer::">
                      <a href="javascript:void(0);">::webMapLayer::</a>
                    </div>
                  </td>
                  <td data-label="Salesforce Object">
                    <div class="slds-truncate salesforce-object" title="::salesforceObject::">::salesForceObject::</div>
                  </td>
                  <td data-label="Record Type">
                    <div class="slds-truncate record-type" title="::recordType::">::recordType::</div>
                  </td>
                  <td data-label="Field Set">
                    <div class="slds-truncate field-set" title="::fieldSet::">::fieldSet::</div>
                  </td>
                  <td role="gridcell" style="width:3.25rem;">
    		        <button class="slds-button slds-button_icon slds-button_icon-x-small edit-template" title="Show More">
    		          <span class="slds-button__icon slds-button__icon_hint slds-button__icon_small icon ma-icon-edit"></span>
    		          <span class="slds-assistive-text">Edit</span>
    		        </button>
    		      </td>
    	      	  <td role="gridcell" style="width:3.25rem;">
    		        <button class="slds-button slds-button_icon slds-button_icon-x-small delete-template" title="Show More">
    		          <span class="slds-button__icon slds-button__icon_hint slds-button__icon_small icon ma-icon-close"></span>
    		          <span class="slds-assistive-text">Delete</span>
    		        </button>
    	       	  </td>
                </tr>
  		    </table>
  		</div>
        <!-- Shape Layer Template -->
        <div class="PlottedShapeLayer">

            <!-- Header -->
            <div class='header'>
                <div class='icon'>
                    <div class='color-box'></div>
                </div>
                <div class="loading-icon-positioning">
                    <div class="loading-icon"><span class="glyphicon glyphicon-refresh"></span></div>
                </div>
                 <div class="ftu-icon-left">
                            <div class="ftu-icon-icon inline" type="shape"></div>
                        </div>

                <!-- Basic Info -->
                <div class='basicinfo'>
                    <div class='basicinfo-name'>&nbsp;</div>
                    <div class='basicinfo-totalGeometry'>&nbsp;</div>
                                <!--ftu-tooltip-->
            <div class="ftu-tooltip-arrow"></div>
            <div class="ftu-tooltip">
                <div class="ftu-tooltip-inner">
                    <div class="ftu-tooltip-pad">
                        <div class="ft-tooltip-title">::TOOLTIP-TITLE::</div>
                        <div class="ft-tooltip-desc">::TOOLTIP-DESC::</div>
                        <div class="ft-tooltip-baseob">
                                        <!--<b>Base object:</b> ::TOOLTIP-BASEOBJ::&nbsp;&bull;&nbsp;<span class="ft-tooltip-plotonload"><b>Plot On Load:</b> ::TOOLTIP-PLOTONLOAD::</span></div>-->
                                        <table>
                                            <tbody>
                                                <tr class="tooltip-row">
                                                    <td class="label">
                                                        <b>Base object</b>
                                                    </td>
                                                    <td class="value">
                                                        ::TOOLTIP-BASEOBJ::
                                                    </td>
                                                </tr>
                                                <tr class="tooltip-row ft-tooltip-plotonload">
                                                    <td class="label">
                                                        <b>Plot On Load</b>
                                                    </td>
                                                    <td class="value">
                                                        ::TOOLTIP-PLOTONLOAD::
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                    </div>
                      <div class="ftu-tooltip-pad-gray">
                        <table>
                            <tbody>
                                <tr class="tooltip-row">
                                    <td class="label">
                                        <b>Created</b>
                                    </td>
                                    <td class="value">
                                        ::TOOLTIP-CREATED::
                                    </td>
                                </tr>
                                <tr class="tooltip-row">
                                    <td class="label">
                                        <b>Last modified</b>
                                    </td>
                                    <td class="value">
                                        ::TOOLTIP-MODIFIED::
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                      </div>

                </div>
            </div><!--end-ftu-tooltip-->
                </div>

                <!-- Menu -->
                <div class="inline visibility-wrapper">
                    <button style="float:right;" class='inline btn-remove btn-lg'><span class="glyphicon glyphicon-remove-circle" aria-hidden="true"></span></button>
                    <div style="float:right;" class="drop-menu-wrapper inline shape-options">
                        <button class="inline plotted-menu-icon btn-lg"><span class="glyphicon glyphicon-option-vertical" aria-hidden="true"></span></button>
                        <ul class="drop-down-menu shape-menu-options">
                            <li role="presentation" class="dropdown-header">{!$Label.MAContext_Shape_Options}</li>
                            <li role="presentation" class='drop-menu-item item-selectable edit-shape'><a role="menuitem">{!$Label.MA_Edit}</a></li>
                            <li role="presentation" class='drop-menu-item item-selectable refresh-shape'><a role="menuitem">{!$Label.MA_REFRESH}</a></li>
                            <li role="presentation" class='drop-menu-item item-selectable fit-shape'><a role="menuitem">{!$Label.MA_Zoom_To_Fit}</a></li>
                        </ul>
                    </div>
                    <div style="float:right;" class="drop-menu-wrapper inline shape-visibility">
                        <button class="inline plotted-visibile-icon btn-lg"><span class="glyphicon glyphicon-eye-open" aria-hidden="true"></span></button>
                        <ul class="drop-down-menu shape-menu-visibility">
                            <li role="presentation" class="dropdown-header">Shape display</li>
                            <li role="presentation" class='drop-menu-item'><a role="menuitem" tabindex="-1" href=""><input id="hide-shape" class="item-selectable" type="checkbox" checked="true"/>Shape is visible</a></li>
                            <li role="presentation" class='drop-menu-item'><a role="menuitem" tabindex="-1" href=""><input class="affectvisibility item-selectable" id="limit-within-shape" type="checkbox"/><span class="proximityText">Only show markers inside shape</span></a></li>
                            <li role="presentation" class='drop-menu-item'><a role="menuitem" tabindex="-1" href=""><input id="toggle-dissolve" class="item-selectable" type="checkbox" checked=""/>Merge boundaries</a></li>
                            <li role="presentation" class='drop-menu-item'><a role="menuitem" tabindex="-1" href=""><input id="toggle-labels" class="item-selectable" type="checkbox" checked=""/>Show shape label(s)</a></li>
                        </ul>
                    </div>

                    <div class='loader'></div>
                </div>

            </div>

            <!-- Plotting Info -->
            <div class='plottinginfo-wrapper'>
                <div class="inline plotted-info-icon"><span class="glyphicon glyphicon-info-sign" aria-hidden="true"></span></div>
                <div class="inline"><div style='margin-top:6px;' class='status'></div></div>
                <div class='adminlevels inline'></div>
            </div>





        </div>

        <div class='proximity layer slds-scope lds'>
            <!-- Header -->
            <div class='header' style="height: 36px;">
                    <div class='icon'>
                        <div class='color-box'>
                            <img class='prox-icon' src="{!URLFOR($Resource.MapAnything, 'images/ui-icons/proximity_icon.png')}"/>
                        </div>
                    </div>
                    <div class="ftu-icon-left">
                                <div class="ftu-icon-icon inline" type="proximity"></div>
                            </div>

                    <!-- Basic Info -->
                    <div class='basicinfo'>
                        <div style="margin-top: 1px;padding-left: 3px;" class='basicinfo-name'>Boundary</div>
                        <div style="display:none !important;" class="ftu-tooltip-arrow"></div>
                        <div class="ftu-tooltip" style="display:none !important;">
                            <div class="ftu-tooltip-inner">
                                <div class="ftu-tooltip-pad">
                                    <div class="ft-tooltip-title">::TOOLTIP-TITLE::</div>
                                    <div class="ft-tooltip-desc">::TOOLTIP-DESC::</div>
                                    <div class="ft-tooltip-baseob">
                                        <!--<b>Base object:</b> ::TOOLTIP-BASEOBJ::&nbsp;&bull;&nbsp;<span class="ft-tooltip-plotonload"><b>Plot On Load:</b> ::TOOLTIP-PLOTONLOAD::</span></div>-->
                                        <table>
                                            <tbody>
                                                <tr class="tooltip-row">
                                                    <td class="label">
                                                        <b>Base object</b>
                                                    </td>
                                                    <td class="value">
                                                        ::TOOLTIP-BASEOBJ::
                                                    </td>
                                                </tr>
                                                <tr class="tooltip-row ft-tooltip-plotonload">
                                                    <td class="label">
                                                        <b>Plot On Load</b>
                                                    </td>
                                                    <td class="value">
                                                        ::TOOLTIP-PLOTONLOAD::
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                                  <div class="ftu-tooltip-pad-gray">
                                      <table>
                                        <tbody>
                                            <tr class="tooltip-row">
                                                <td class="label">
                                                    <b>Created</b>
                                                </td>
                                                <td class="value">
                                                    ::TOOLTIP-CREATED::
                                                </td>
                                            </tr>
                                            <tr class="tooltip-row">
                                                <td class="label">
                                                    <b>Last modified</b>
                                                </td>
                                                <td class="value">
                                                    ::TOOLTIP-MODIFIED::
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div><!--end-ftu-tooltip-->
                    </div>

                    <div class="inline prox-visibility-wrapper">
                            <button style="float:right;" class='inline btn-remove btn-lg'><span class="MAIcon glyphicon-remove-circle" aria-hidden="true"></span></button>
                        <div class="drop-menu-wrapper inline prox-visibility" style="padding: 0px;float:right;">
                            <button class="inline plotted-visibile-icon btn-lg"><span class="MAIcon glyphicon-eye-open" aria-hidden="true"></span></button>
                            <ul class="drop-down-menu prox-menu-visibility">
                                <li role="presentation" class="dropdown-header">Shape display</li>
                                <li role="presentation" class='drop-menu-item'><a role="menuitem" tabindex="-1" href=""><input id="hide-prox" class="item-selectable" type="checkbox" checked="true"/>Shape is visible</a></li>
                                <li role="presentation" class='drop-menu-item'><a role="menuitem" tabindex="-1" href=""><input class="affectvisibility item-selectable" id="limit-within-prox" type="checkbox"/><span class="proximityText">Only show markers inside shape</span></a></li>
                            </ul>
                        </div>

                        <div class='loader'></div>
                    </div>
                </div>
            <div class="plotted-boundary-distance-wrap plotted-boundary-unit-pad">
                <!-- Options -->
                <div class='options-wrapper'>
                    <!-- Basic Info -->
                    <table class="plotted-boundary-unit-table">
                        <tbody>
                            <tr>
                                <td>
                                    <label class="slds-form-element__label">{!$Label.MA_Type}</label>
                                </td>
                                <td>
                                    <div class="slds-form-element">
                                        <div class="slds-form-element__control">
                                            <div class="slds-select_container">
                                                <select class="plotted-boundary-type-select slds-select proximitytype" onchange="toggleShapeLayers(this);">
                                                    <option value='Circle'>{!$Label.MA_Circle}</option>
                                                    <option style="display:none;" value='Polygon'>Polygon</option>
                                                    <option value='KML'>KML</option>
                                                    <option value='travelTime'>{!$Label.MA_TRAVEL_TIME}</option>
                                                    <option value='travelDistance'>{!$Label.MA_TRAVEL_DISTANCE}</option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                </td>
                                <td data-id="travelTime-notDone" class="plotted-radius-travel-type-wrap js-rowToggle">
                                    <div class="slds-button-group" role="group">
                                        <button data-id="drive" class="slds-button slds-button--icon-border slds-button--neutral ma-sibling-toggle js-travel-mode slds-is-selected" title="Drive">
                                            <i class="slds-button__icon ma-icon ma-icon-new-custom31"></i>
                                            <span class="slds-assistive-text">Drive</span>
                                        </button>
                                        <button data-id="bicycle" class="slds-button slds-button--icon-border slds-button--neutral js-travel-mode ma-sibling-toggle" title="Bicycle">
                                            <i class="slds-button__icon ma-icon ma-icon-bicycle"></i>
                                            <span class="slds-assistive-text">Bicycle</span>
                                        </button>
                                        <button data-id="walk" class="slds-button slds-button--icon-border slds-button--neutral js-travel-mode ma-sibling-toggle active" title="Walk">
                                            <i class="slds-button__icon ma-icon ma-icon-walk"></i>
                                            <span class="slds-assistive-text">Walk</span>
                                        </button>
                                    </div>
                                </td>
                            </tr>
                            <tr class="js-toggleKML js-address-wrapper">
                                <td>
                                    <label class="slds-form-element__label">Center</label>
                                </td>
                                <td colspan="2">
                                    <div class="slds-form-element">
                                        <div class="slds-form-element__control">
                                            <textarea class="slds-textarea js-address-input" placeholder="Address..."></textarea>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>

                    <!-- Main Options -->
                    <article class="plottedBoundaryRadiusUnit1 plotted-boundary-radius-unit slds-card slds-m-top--x-small js-hideOptions">
                        <div class="plotted-boundary-unit-pad">
                            <!-- Travel Time -->
                            <div class="proximity-travel-time">
                                <div class="js-toggleKML slds-form-element__label slds-text-title--caps">Radius</div>

                                <table class="plotted-boundary-unit-table">
                                    <tr data-id="travelTime" class="js-rowToggle hidden">
                                        <td>
                                            <label class="slds-form-element__label">Time</label>
                                        </td>
                                        <td>
                                            <div class="slds-form-element radius-time-field">
                                                <div class="slds-form-element__control slds-input-has-fixed-addon">
                                                    <input class="slds-input radius-hours" type="text" placeholder="00"/>
                                                    <span class="slds-form-element__addon">hrs</span>
                                                </div>
                                            </div>
                                        </td>
                                        <td>
                                            <div class="slds-form-element radius-time-field">
                                                <div class="slds-form-element__control slds-input-has-fixed-addon">
                                                    <input class="slds-input radius-minutes" type="text" placeholder="00"/>
                                                    <span class="slds-form-element__addon">mins</span>
                                                </div>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr data-id="travelDistance::Circle" class="js-rowToggle hidden">
                                        <td>
                                            <label class="slds-form-element__label">Distance</label>
                                        </td>
                                        <td>
                                            <div class="slds-form-element radius-time-field">
                                                <div class="slds-form-element__control slds-input-has-fixed-addon">
                                                    <input style="width:80px;" class="slds-input js-radiusDistance" type="text" placeholder="00"/>
                                                </div>
                                            </div>
                                        </td>
                                        <td>
                                            <div class="slds-form-element radius-time-field">
                                                <div class="slds-form-element__control slds-input-has-fixed-addon">
                                                    <span class="slds-form-element__addon">Units:</span>
                                                    <div class="slds-select_container">
                                                        <select class="plotted-boundary-type-select slds-select js-radiusUnit">
                                                            <option value='MILES'>{!$Label.MARoutes_Miles}</option>
                                                            <option value='KM'>{!$Label.MARoutes_Kilometers}</option>
                                                            <option value='METERS'>{!$Label.MA_Meters}</option>
                                                            <option value='YARDS'>{!$Label.MA_Yards}</option>
                                                            <option value='FEET'>{!$Label.MA_Feet}</option>
                                                        </select>
                                                    </div>
                                                </div>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr data-id="KML" class="js-rowToggle hidden">
                                        <td colspan="3">
                                            <div class="slds-form-element radius-time-field">
                                                <div class="slds-form-element__control slds-input-has-fixed-addon">
                                                    <select class='slds-select combobox options-kml-document' disabled='disabled'><option value=''>{!$Label.MA_Loading}...</option></select>
                                                </div>
                                                <div style='font-size: 11px; margin-top: 10px;'>**To add additional KMLs, upload them to the <a href='/{!documentsFolderId}' target='_blank'>MapAnything Documents</a> folder</div>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr class="js-colorOptions color-wrapper js-toggleKML">
                                        <td>
                                            <div class="slds-form-element radius-fill-color-input">
                                                <label class="slds-form-element__label">Fill</label>
                                                <div class="slds-form-element__control">
                                                    <input class="fillcolor color slds-input" type="text" placeholder="#3083d3" value="#3083d3"/>
                                                </div>
                                            </div>
                                        </td>
                                        <td>
                                            <div class="slds-form-element radius-border-color-input">
                                                <label class="slds-form-element__label">Border</label>
                                                <div class="slds-form-element__control">
                                                    <input class="bordercolor color slds-input" type="text" placeholder="#16325C" value="#16325C"/>
                                                </div>
                                            </div>
                                        </td>
                                        <td>
                                            <div class="slds-form-element boundary-radius-opacity-wrap">
                                                <label class="slds-form-element__label">Opacity:</label>
                                                  <div class="slds-form-element__control">
                                                    <div class="slds-select_container">
                                                      <select class="slds-select js-proxOpacity">
                                                        <option value="0.1">10%</option>
                                                        <option value="0.2">20%</option>
                                                        <option value="0.3">30%</option>
                                                        <option value="0.4">40%</option>
                                                        <option value="0.5">50%</option>
                                                        <option value="0.6">60%</option>
                                                        <option value="0.7">70%</option>
                                                        <option value="0.8">80%</option>
                                                        <option value="0.9">90%</option>
                                                        <option value="1">100%</option>
                                                      </select>
                                                    </div>
                                                </div>
                                            </div>
                                        </td>
                                    </tr>
                                </table>
                            </div>
                        </div>
                    </article>

                    <!-- advanced travel time options -->
                    <table data-id="travelTime" class="plotted-boundary-traffic-table plotted-boundary-unit-table js-travelTimeToggle js-rowToggle js-hideOptions">
                        <tbody>
                            <tr>
                                <td>
                                    <div class="slds-form-element">
                                        <label class="slds-checkbox--toggle slds-grid">
                                            <span class="slds-form-element__label slds-m-bottom--none plotted-radius-traffic-toggle-label">Traffic</span>
                                            <input class="radius-traffic-checkbox" id="drivetime-traffic-enable" name="checkbox" type="checkbox" aria-describedby="toggle-desc" checked="checked"/>
                                            <span id="toggle-desc" class="slds-checkbox--faux_container" aria-live="assertive">
                                                <span class="slds-checkbox--faux"></span>
                                            </span>
                                        </label>
                                    </div>
                                </td>
                                <td class="radius-traffic-day-wrap radius-traffic-content-toggle" id="drivetime-day">
                                    <div id="radius-traffic-sunday" data-day="Sunday" data-dayIndex="0" class="ma-sibling-toggle">S</div>
                                    <div id="radius-traffic-monday" data-day="Monday" data-dayIndex="1" class="ma-sibling-toggle">M</div>
                                    <div id="radius-traffic-tuesday" data-day="Tuesday" data-dayIndex="2" class="ma-sibling-toggle">T</div>
                                    <div id="radius-traffic-wednesday" data-day="Wednesday" data-dayIndex="3" class="ma-sibling-toggle">W</div>
                                    <div id="radius-traffic-thursday" data-day="Thursday" data-dayIndex="4" class="ma-sibling-toggle">T</div>
                                    <div id="radius-traffic-friday" data-day="Friday" data-dayIndex="5" class="ma-sibling-toggle">F</div>
                                    <div id="radius-traffic-saturday" data-day="Saturday" data-dayIndex="6" class="ma-sibling-toggle">S</div>
                                </td>
                            </tr>
                            <tr class="radius-traffic-content-toggle">
                                <td class="radius-traffic-value">
                                    Tuesday, 4:51 PM
                                </td>
                                <td class="radius-traffic-time-range">
                                    <div class="slds-form-element__control ma-form-control-wrap-range">
                                        <div class="radius-traffic-time" style="background: #4194e4;"></div>
                                    </div>
                                    <div class="radius-traffic-time-scale">
                                        <div>3 AM</div>
                                        <div>9 AM</div>
                                        <div>3 PM</div>
                                        <div>9 PM</div>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>


            </div>

            <div class="plotted-boundary-unit-pad clearfix js-hideOptions">
                <button class="slds-button slds-button--neutral js-updateShape">
                    <i class="slds-button__icon--left ma-icon ma-icon-check"></i>
                    Apply Changes
                </button>
                <button class="hidden slds-button slds-button--neutral js-saveKML">
                    <i class="slds-button__icon--left ma-icon ma-icon-check"></i>
                    {!$Label.MA_Save}
                </button>
            </div>

            <div class="ma-divider compact"></div>

            <div class='link showoptions'><span class="glyphicon glyphicon-triangle-top" aria-hidden="true"></span> <span class="options-text">{!$Label.MA_Hide_Options}</span></div>


                <!-- Color -->
                <div style='padding: 5px 10px; position:relative;' class='color-wrapper hidden'>
                    <div style="padding: 0px;" class="opac-wrapper">
                        <div class="opac-text" style="color: #949494;">Opacity: 60%</div>
                        <div class="prox-slider" style="width: 275px; padding: 0px; background: #DDD; margin-top: 5px;"></div>
                    </div>
                    <div class="inline color-select" style="width: 33%;">
                        <p style='margin: 0px;'>Fill:</p>
                        <input type='text' class='color fillcolor prox-style' style='width: 95%; font-size: 12px;' />
                    </div>
                    <div class="inline color-select" style="width: 33%;">
                        <p style='margin: 0px;'>Border:</p>
                        <input  type='text' class='color bordercolor prox-style' style='font-size: 12px; width: 95%;' />
                    </div>
                    <div class="inline" style="position: absolute;top: 15px; left: 15px;">
                        <a style="width: 100%;" class="btn hidden btn-default btn-sm button-save">
                            <span class="glyphicon glyphicon-save" aria-hidden="true"></span>
                            {!$Label.MA_Save}
                        </a>
                    </div>
                    <div class="inline" style="width: 30%;">
                        <a style="width: 100%;" class="btn btn-default btn-sm button-update">
                            <span class="glyphicon glyphicon-refresh" aria-hidden="true"></span>
                            Submit
                        </a>
                    </div>
                </div>
        </div>

        <!-- Proximity Layer Template -->
        <div class='proximity-old layer-old'>

            <!-- Header -->
            <div class='header' style="height: 36px;">
                <div class='icon'>
                    <div class='color-box'>
                        <img class='prox-icon' src="{!URLFOR($Resource.MapAnything, 'images/ui-icons/proximity_icon.png')}"/>
                    </div>
                </div>
                <div class="ftu-icon-left">
                            <div class="ftu-icon-icon inline" type="proximity"></div>
                        </div>

                <!-- Basic Info -->
                <div class='basicinfo'>
                    <div style="margin-top: 1px;padding-left: 3px;" class='basicinfo-name'>Boundary</div>
                    <div style="display:none !important;" class="ftu-tooltip-arrow"></div>
                    <div class="ftu-tooltip" style="display:none !important;">
                        <div class="ftu-tooltip-inner">
                            <div class="ftu-tooltip-pad">
                                <div class="ft-tooltip-title">::TOOLTIP-TITLE::</div>
                                <div class="ft-tooltip-desc">::TOOLTIP-DESC::</div>
                                <div class="ft-tooltip-baseob">
                                        <!--<b>Base object:</b> ::TOOLTIP-BASEOBJ::&nbsp;&bull;&nbsp;<span class="ft-tooltip-plotonload"><b>Plot On Load:</b> ::TOOLTIP-PLOTONLOAD::</span></div>-->
                                        <table>
                                            <tbody>
                                                <tr class="tooltip-row">
                                                    <td class="label">
                                                        <b>Base object</b>
                                                    </td>
                                                    <td class="value">
                                                        ::TOOLTIP-BASEOBJ::
                                                    </td>
                                                </tr>
                                                <tr class="tooltip-row ft-tooltip-plotonload">
                                                    <td class="label">
                                                        <b>Plot On Load</b>
                                                    </td>
                                                    <td class="value">
                                                        ::TOOLTIP-PLOTONLOAD::
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                            </div>
                              <div class="ftu-tooltip-pad-gray">
                                  <table>
                                    <tbody>
                                        <tr class="tooltip-row">
                                            <td class="label">
                                                <b>Created</b>
                                            </td>
                                            <td class="value">
                                                ::TOOLTIP-CREATED::
                                            </td>
                                        </tr>
                                        <tr class="tooltip-row">
                                            <td class="label">
                                                <b>Last modified</b>
                                            </td>
                                            <td class="value">
                                                ::TOOLTIP-MODIFIED::
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div><!--end-ftu-tooltip-->
                </div>

                <div class="inline prox-visibility-wrapper">
                        <button style="float:right;" class='inline btn-remove btn-lg'><span class="MAIcon glyphicon-remove-circle" aria-hidden="true"></span></button>
                    <div class="drop-menu-wrapper inline prox-visibility" style="padding: 0px;float:right;">
                        <button class="inline plotted-visibile-icon btn-lg"><span class="MAIcon glyphicon-eye-open" aria-hidden="true"></span></button>
                        <ul class="drop-down-menu prox-menu-visibility">
                            <li role="presentation" class="dropdown-header">Shape display</li>
                            <li role="presentation" class='drop-menu-item'><a role="menuitem" tabindex="-1" href=""><input id="hide-prox" class="item-selectable" type="checkbox" checked="true"/>Shape is visible</a></li>
                            <li role="presentation" class='drop-menu-item'><a role="menuitem" tabindex="-1" href=""><input class="affectvisibility item-selectable" id="limit-within-prox" type="checkbox"/><span class="proximityText">Only show markers inside shape</span></a></li>
                        </ul>
                    </div>

                    <div class='loader'></div>
                </div>
            </div>

            <!-- Options -->
            <div class='options-wrapper'>
                <!-- Basic Info -->
                <div class='select-info'> <span style="margin-right: 30px;">{!$Label.MA_Type}: </span>
                    <select class='proximitytype' onchange="toggleShapeLayers(this);">
                        <option value='Circle'>{!$Label.MA_Circle}</option>
                        <option style="display:none;" value='Polygon'>Polygon</option>
                        <option value='KML'>KML</option>
                        <option value='travelTime'>{!$Label.MA_TRAVEL_TIME}</option>
                        <option value='travelDistance'>{!$Label.MA_TRAVEL_DISTANCE}</option>
                    </select>
                </div>



                <div class="prox-option-select">

                    <!-- Circle -->
                    <div style='padding: 0px 10px;' class='options-circle prox-option prox-option'>

                        <div class="inline">
                            <span style="margin-right: 20px;">Radius:</span>
                            <input style="min-width: 67px;" type='text' class='options-circle-radius prox-style' size='5' />
                        </div>
                        <div class="inline" style="margin-left: 9px;">
                            <span style="margin-right: 5px;">Units:</span><select class='options-circle-unit'>
                                <option value='MILES'>{!$Label.MARoutes_Miles}</option>
                                <option value='KM'>{!$Label.MARoutes_Kilometers}</option>
                                <option value='METERS'>{!$Label.MA_Meters}</option>
                                <option value='YARDS'>{!$Label.MA_Yards}</option>
                                <option value='FEET'>{!$Label.MA_Feet}</option>
                            </select>
                        </div>

                        <div class="hidden">
                            <div style="vertical-align: top;margin-top: 15px;display: inline-block;">Address:</div>
                            <textarea style='border: 1px solid silver; font-size: 12px; border-radius:3px; margin-left: 12px; width:202px' class='js-proxAddress options-circle-address'></textarea>
                        </div>
                    </div>

                    <!-- Travel Distance -->
                    <div style='padding: 0px 10px; display:none;' id="proximity-travel-distance" class="prox-option">

                        <div class="inline">
                            <span style="margin-right: 20px;">Radius:</span>
                            <input style="min-width: 67px;" type='text' class='travel-distance-radius prox-style' size='5' />
                        </div>
                        <div class="inline" style="margin-left: 9px;">
                            <span style="margin-right: 5px;">Units:</span><select class='distance-unit-dropdown'>
                                <option value='MILES'>{!$Label.MARoutes_Miles}</option>
                                <option value='KM'>{!$Label.MARoutes_Kilometers}</option>
                                <option value='METERS'>{!$Label.MA_Meters}</option>
                                <option value='YARDS'>{!$Label.MA_Yards}</option>
                                <option value='FEET'>{!$Label.MA_Feet}</option>
                            </select>
                        </div>

                        <div class="hidden">
                            <div style="vertical-align: top;margin-top: 15px;display: inline-block;">Address:</div>
                            <textarea style='border: 1px solid silver; font-size: 12px; border-radius:3px; margin-left: 12px; width:202px' class='travel-distance-address'></textarea>
                        </div>

                        <div class="hidden">
                            <div style="vertical-align: top; margin-top: 15px; margin-right: 30px;" class="inline">Mode:</div>
                            <div class="inline proximity-mode hidden" style="font-size: 30px;">
                                <div class="MAIcon ion-android-car selected" style="border-top-left-radius: 3px; border-bottom-left-radius: 3px;;"></div>
                                <div class="MAIcon ion-android-bicycle" style="border-top-left-radius: 3px; border-bottom-left-radius: 3px;"></div>
                                <div class="MAIcon ion-android-walk" style="border-top-left-radius: 3px; border-bottom-left-radius: 3px"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Travel Time -->
                    <div style='padding: 0px 10px; display:none;' id="proximity-travel-time" class="prox-option">

                        <div class="inline">
                            <span style="margin-right: 20px;">Radius:</span>
                            <input style="min-width: 50px;" type='text' class='radius-hours prox-style' size='2' placeholder="0" />
                            <span style="margin-right: 15px;"><em>hrs</em></span>
                            <input style="min-width: 50px;" type='text' class='radius-minutes prox-style' size='2' placeholder="0" />
                            <span style="margin-right: 15px;"><em>mins</em></span>
                        </div>

                        <div class="hidden">
                            <div style="vertical-align: top;margin-top: 15px;display: inline-block;">Address:</div>
                            <textarea style='border: 1px solid silver; font-size: 12px; border-radius:3px; margin-left: 12px; width:202px' class='travel-time-address'></textarea>
                        </div>

                        <div class="hidden">
                            <div style="vertical-align: top; margin-top: 15px; margin-right: 30px;" class="inline">Mode:</div>
                            <div class="inline proximity-mode hidden" style="font-size: 30px;">
                                <div class="MAIcon ion-android-car selected" style="border-top-left-radius: 3px; border-bottom-left-radius: 3px;;"></div>
                                <div class="MAIcon ion-android-bicycle" style="border-top-left-radius: 3px; border-bottom-left-radius: 3px;"></div>
                                <div class="MAIcon ion-android-walk" style="border-top-left-radius: 3px; border-bottom-left-radius: 3px"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Isoline -->
                    <div class='options-isoline prox-option' style='display: none;'>

                        <p>{!$Label.MA_Unit}:</p>
                        <select class='options-isoline-unit-type'>
                            <option value='Distance'>{!$Label.MA_Distance}</option>
                            <option value='Time'>{!$Label.MA_Time}</option>
                        </select>
                        <select class='options-isoline-unit'>
                        </select>
                        <input type='text' class='options-isoline-unit-value' size='5' />

                        <p>Mode:</p>
                        <select class='options-isoline-mode'>
                            <option value='car'>{!$Label.MA_Car}</option>
                            <option value='pedestrian'>{!$Label.MA_Pedestrian}</option>
                        </select>


                        <p><input type='checkbox' class='options-isoline-traffic' /> {!$Label.MA_Enable_Traffic}</p>

                        <textarea class='options-isoline-address'></textarea>

                    </div>

                    <!-- Polygon -->
                    <div class='options-polygon prox-option' style='display: none; padding-top: 10px; color: #757575; font-style: italic;'>

                    </div>

                    <!-- Geography-State -->
                    <div class='options-geography-state prox-option' style='display: none; padding: 15px 0; margin-left: 30px;'>
                        <select class='options-geography-states geometry-select'></select>
                    </div>

                    <!-- Geography-County -->
                    <div class='options-geography-county prox-option' style='display: none; padding: 15px 0; margin-left: 30px;'>
                        <select class='options-geography-county-states geometry-select'></select>

                        <select class='options-geography-counties geometry-select'>
                        </select>
                    </div>

                    <!-- KML -->
                    <div class='options-kml' style='display: none; padding: 15px 0px; margin-left: 30px;'>
                        <select class='combobox options-kml-document' disabled='disabled'><option value=''>{!$Label.MA_Loading}...</option></select>
                        <div class='options-kml-info' style='font-size: 9px; color: #FF6E6E;'></div>
                        <div style='font-size: 8px; margin-top: 10px;'>**To add additional KMLs, upload them to the <a href='/{!documentsFolderId}' target='_blank'>MapAnything Documents</a> folder</div>
                    </div>

                    <!-- Universal address input - for use by circle, traveltime and traveldistance -->
                    <div style='padding: 0px 10px; margin-top:10px;' id="boundary-address">
                        <div style="vertical-align: top;margin-top: 15px;display: inline-block;">Address:</div>
                        <textarea style='border: 1px solid silver; font-size: 12px; border-radius:3px; margin-left: 12px; width:202px' class='address-input'></textarea>
                    </div>
                </div>

            </div>


            <!-- Color -->
            <div style='padding: 5px 10px; position:relative;' class='color-wrapper'>
                <div style="padding: 0px;" class="opac-wrapper">
                    <div class="opac-text" style="color: #949494;">Opacity: 60%</div>
                    <div class="prox-slider" style="width: 275px; padding: 0px; background: #DDD; margin-top: 5px;"></div>
                </div>
                <div class="inline color-select" style="width: 33%;">
                    <p style='margin: 0px;'>Fill:</p>
                    <input type='text' class='color fillcolor prox-style' style='width: 95%; font-size: 12px;' />
                </div>
                <div class="inline color-select" style="width: 33%;">
                    <p style='margin: 0px;'>Border:</p>
                    <input  type='text' class='color bordercolor prox-style' style='font-size: 12px; width: 95%;' />
                </div>
                <div class="inline" style="position: absolute;top: 15px; left: 15px;">
                    <a style="width: 100%;" class="btn hidden btn-default btn-sm button-save">
                        <span class="glyphicon glyphicon-save" aria-hidden="true"></span>
                        {!$Label.MA_Save}
                    </a>
                </div>
                <div class="inline" style="width: 30%;">
                    <a style="width: 100%;" class="btn btn-default btn-sm button-update">
                        <span class="glyphicon glyphicon-refresh" aria-hidden="true"></span>
                        Submit
                    </a>
                </div>
            </div>

            <div class='link showoptions'><span class="glyphicon glyphicon-triangle-top" aria-hidden="true"></span> <span class="options-text">{!$Label.MA_Hide_Options}</span></div>
        </div>

        <!-- Fav Loc Template -->
        <div class="FavoriteRowUnit">

            <!-- Header -->
            <div class='header'>
                <div class='icon inline' style="vertical-align: top; padding: 5px;">
                    <div class='color-box' style="padding: 0px;">
                        <span style="font-size: 20px; font-weight: bold;" class="glyphicon glyphicon-star-empty"></span>
                    </div>
                </div>


                <div class="ftu-icon-left">
                            <div class="ftu-icon-icon inline" type="favorite"></div>
                        </div>

                <!-- Basic Info -->
                <div style="  padding: 7px 0px 0px 0px;" class='basicinfo inline'>

                    <div class='basicinfo-name basicinfo-name-nosub'>&nbsp;



                    </div>

                 <div class="ftu-tooltip-arrow"></div>
                <div class="ftu-tooltip">
                <div class="ftu-tooltip-inner">
                    <div class="ftu-tooltip-pad">
                        <div class="ft-tooltip-title">::TOOLTIP-TITLE::</div>
                        <div class="ft-tooltip-desc">::TOOLTIP-DESC::</div>
                        <div class="ft-tooltip-baseob">
                                        <!--<b>Base object:</b> ::TOOLTIP-BASEOBJ::&nbsp;&bull;&nbsp;<span class="ft-tooltip-plotonload"><b>Plot On Load:</b> ::TOOLTIP-PLOTONLOAD::</span></div>-->
                                        <table>
                                            <tbody>
                                                <tr class="tooltip-row">
                                                    <td class="label">
                                                        <b>Base object</b>
                                                    </td>
                                                    <td class="value">
                                                        ::TOOLTIP-BASEOBJ::
                                                    </td>
                                                </tr>
                                                <tr class="tooltip-row ft-tooltip-plotonload">
                                                    <td class="label">
                                                        <b>Plot On Load</b>
                                                    </td>
                                                    <td class="value">
                                                        ::TOOLTIP-PLOTONLOAD::
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                    </div>
                      <div class="ftu-tooltip-pad-gray">
                          <table>
                            <tbody>
                                <tr class="tooltip-row">
                                    <td class="label">
                                        <b>Created</b>
                                    </td>
                                    <td class="value">
                                        ::TOOLTIP-CREATED::
                                    </td>
                                </tr>
                                <tr class="tooltip-row">
                                    <td class="label">
                                        <b>Last modified</b>
                                    </td>
                                    <td class="value">
                                        ::TOOLTIP-MODIFIED::
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div><!--end-ftu-tooltip-->

                </div>

                <div class="inline prox-visibility-wrapper">
                    <button style="float:right;" class='inline btn-remove btn-lg'><span class="glyphicon glyphicon-remove-circle" aria-hidden="true"></span></button>
                    <button style="float:right;" class="inline plotted-visibile-icon btn-lg"><span class="glyphicon glyphicon-eye-open" aria-hidden="true"></span></button>

                    <div class='loader'></div>
                </div>

            </div>

            <div style="display:none;" class='extrainfo-wrapper'>
                <p style="margin: 0px 0px 5px 12px;">Description:</p>
                <textarea disabled="disabled" style='max-width: 85%; height: 50px; border: 1px solid silver; font-size: 12px; border-radius:3px; margin-left: 12px; width:85%' class='fav-description'></textarea>
            </div>

            <div class='link showoptions'><span class="glyphicon glyphicon-triangle-bottom" aria-hidden="true"></span> <span class="options-text">{!$Label.MA_Show_Options}</span></div>

        </div>

        <!-- Ruler Template -->
        <div class="RulerRowUnit">

            <!-- Header -->
            <div class='header'>
                <div class='icon inline' style="vertical-align: top; padding: 5px;">
                    <div class='color-box' style="padding: 0px;">
                        <!--<span style="font-size: 20px; font-weight: bold;" class="glyphicon glyphicon-grain"></span>-->
                        <img src="{!URLFOR($Resource.MapAnything,'/images/ruler/header_icon_ruler.png')}" />
                    </div>
                </div>

                <!-- Basic Info -->
                <div style="  padding: 7px 0px 0px 0px;" class='basicinfo inline'>
                    <div class='basicinfo-name basicinfo-name-nosub'>&nbsp;</div>
                </div>

                <div class="inline prox-visibility-wrapper">
                    <button style="float:right;" class='inline btn-remove btn-lg'><span class="glyphicon glyphicon-remove-circle" aria-hidden="true"></span></button>
                    <button style="float:right;" class="inline plotted-visibile-icon btn-lg"><span class="glyphicon glyphicon-eye-open" aria-hidden="true"></span></button>
                    <div class='loader'></div>
                </div>

            </div>

            <div class='extrainfo-wrapper'>

                <div class="info-success" style="display:none;">

                    <div class="ruler-drive-wrap">
                        <!--<p style="margin: 0px 0px 5px 12px; font-weight: bold;">Drive Distance/Time:</p>-->
                        <img class="ruler-drive-icon" src="{!URLFOR($Resource.MapAnything,'/images/ruler/icon_drive.svg')}" />
                        <p class="info-drive"></p>
                    </div>

                    <div class="ruler-straight-wrap">
                     <img class="ruler-straightline-icon" src="{!URLFOR($Resource.MapAnything,'/images/ruler/icon_straightline.svg')}" /> <p><span class="info-distance"></span></p>
                    </div>



                    <div class="info-waypoints">

                    </div>

                    <div class="info-options">
                        <div style='padding: 5px 10px;' class='color-wrapper'>
                            <div class="inline color-select" style="width: 80px;">
                                <p style='margin: 0px;'>Transit Line:</p>
                                <input type='text' class='color transit-line-color' style='width: 95%; font-size: 12px;' />
                            </div>
                            <div class="inline color-select" style="width: 80px;">
                                <p style='margin: 0px;'>Straight Line:</p>
                                <input type='text' class='color straight-line-color' style='font-size: 12px; width: 95%;' />
                            </div>
                            <div class="inline" style="width: 100px; vertical-align:top;">
                                <button style="font-size:12px; width: 100%;margin-top:11px;" class="MAbutton button-light icon-left  glyphicon-refresh button-update">Submit</button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="ruler-warning info-warning-start" >
                    No Information yet. Please click and drag the red or green Marker to begin.
                </div>

                <div class="ruler-warning info-warning-dragging" style="display:none;">
                    Drop to see distance information.
                </div>

                <div class="ruler-warning info-warning-invalid-points" style="display:none;">
                    Opps!! It looks like we're not able to route between each of your points, please move or delete your points to try again.
                </div>

                <div class="ruler-warning info-warning-calculating" style="display:none;">
                    Calculating...Please Wait...
                </div>

            </div>




        </div>

        <!-- Ruler Start Waypoint Template -->
        <div class="ruler-start-waypoint-row">
            <div><p><span class="ruler-waypoint-row-address"></span></p></div>
        </div>

        <!-- Ruler Waypoint Template -->
        <div class="ruler-waypoint-row">
            <div><p><span class="ruler-waypoint-row-address"></span></p></div>
            <div class="ruler-waypoint-row-icon ruler-waypoint-row-icon-drive"><img class="ruler-drive-icon" src="{!URLFOR($Resource.MapAnything,'/images/ruler/icon_drive.svg')}" /><p><span class="ruler-waypoint-row-drive-info"></span></p></div>
            <div class="ruler-waypoint-row-icon"><img class="ruler-straightline-icon" src="{!URLFOR($Resource.MapAnything,'/images/ruler/icon_straightline.svg')}" /><p><span class="ruler-waypoint-row-straight-info"></span></p></div>
        </div>

        <!-- Missing Addresses Template -->
        <div class='missingaddresses template'>
            <div id="::SavedQueryId::_MissingAddresses_Header" class='missingaddresses-wrapper' data-id='::SavedQueryId::'>

                <!-- Saved Query Header -->
                <div class='missingaddresses-header'>

                    <!-- Name -->
                    ::SavedQueryName::
                    <span class="count">(0)</span>

                    <!-- Toggle -->
                    <a class='toggle' onclick="ToggleMissingAddressContent(this);">{!$Label.MA_Hide}</a>

                </div>

                <!-- Addresses -->
                <div id="::SavedQueryId::_MissingAddresses_Content" class='missingaddresses-content' style="display: block;">
                    <table cellpadding="3" id="::SavedQueryId::_MissingAddresses_Table" class='missingaddresses-table' style="width:100%;">
                        <tr class='missingaddress' data-id='::RecordId::'>
                            <td><input type='checkbox' class='missingaddress-checkbox' /> <a target="_blank" href="/::RecordId::">::Tooltip1::</a></td>
                            <td>::MarkerAddress::</td>
                            <td style="width: 75px; text-align: right;"><button class='missingaddress-button drop-pin' onclick='MissingAddress_DropPin.call($(this).closest(".missingaddress").get(0));'>Drop Pin</button></td>
                        </tr>
                    </table>
                </div>

            </div>
        </div>

        <!-- Grid Templates -->
        <table>
            <tr class='permissions-row'>
                <td class="permission-type" style="text-align:left;"></td>
                <td class="permission-for" style="text-align:left"></td>
                <td class="permission-read"><input type="checkbox" class="autosave" data-field="Read__c" /></td>
                <td class="permission-create"><input type="checkbox" class="autosave" data-field="Create__c" /></td>
                <td class="permission-modify"><input type="checkbox" class="autosave" data-field="Modify__c" /></td>
                <td class="permission-delete"><input type="checkbox" class="autosave" data-field="Delete__c" /></td>
                <td class="permission-setperm"><input type="checkbox" class="autosave" data-field="SetPermissions__c" /></td>
                <td class="permission-delete"><a href="#">{!$Label.MA_Delete}</a></td>
            </tr>
            <tr class='campaign-row'>
                <td><input type='checkbox' class='campaign-checkbox' /></td>
                <td class='campaign-name'></td>
                <td class='campaign-type'></td>
                <td class='campaign-status'></td>
                <td class='campaign-startdate'></td>
                <td class='campaign-enddate'></td>
                <td class='campaign-leads'></td>
                <td class='campaign-contacts'></td>
                <td class='campaign-responses'></td>
            </tr>
            <tr class='campaign-options-row'>
                <td class='campaign-name'></td>
                <td class='campaign-status'>
                    <div class="ma-form-control icon-right">
                        <i class="MAIcon ion-arrow-down-b inset-icon--right" style="font-size: 20px;top: 5px;"></i>
                        <select class="ma-input"></select>
                    </div>
                </td>
                <td class='campaign-override'><input type='checkbox' /></td>
            </tr>
            <tr class='changeowner-row'>
                <td class='user-name'></td>
            </tr>
        </table>

        <!-- Loader Template -->
        <img class='loader' src="{!URLFOR($Resource.MapAnything, 'images/chatterstatus-loader.gif')}" style="display: none;"/>

        <!-- LinkedIn Cluter Template -->
        <div class='linkedin-cluster-tooltip'>
            <div class='linkedin-cluster-header'></div>

            <div class='linkedin-cluster-table-wrapper'>
                <table class='linkedin-cluster-table'></table>
            </div>
        </div>

        <!-- Address Favorite Row Template -->
        <table>
            <tr style='display: block; border-bottom: 1px solid silver;' class='fav-row-folder template'>
                <td><input type='checkbox' class='fav-check'/></td>
                <td style='padding-right: 20px;' class='fav-title favrow'></td>
                <td class='fav-modified favrow'></td>
            </tr>
        </table>

        <!-- LinkedIn Row Template -->
        <table>
            <tr class='linkedin-row'>
                <td class='linkedin-picture'></td>
                <td class='linkedin-info'>
                    <div class='linkedin-name'></div>
                    <div class='linkedin-headline'></div>
                    <div class='linkedin-industry'></div>
                </td>
                <td class='linkedin-actions'>
                    <button class='linkedin-actions-createlead' onclick='linkedIn_CreateLead($(this).closest(".linkedin-row"));'>{!$Label.MA_Create_Lead}</button>
                    <button class='linkedin-actions-connect' onclick='linkedIn_Connect($(this).closest(".linkedin-row"));'>{!$Label.MA_Connect}</button>
                    <button class='linkedin-actions-getintroduced' onclick='linkedIn_GetIntroduced($(this).closest(".linkedin-row"));'>{!$Label.MA_Get_Introduced}</button>
                    <button class='linkedin-actions-inmail' onclick='linkedIn_SendInMail($(this).closest(".linkedin-row"));'>{!$Label.MA_Send_InMail}</button>
                    <button class='linkedin-actions-message' onclick='linkedIn_SendMessage($(this).closest(".linkedin-row"));'>{!$Label.MA_Send_Message}</button>
                    <button class='linkedin-actions-addtotrip' onclick='linkedIn_AddToTrip($(this).closest(".linkedin-row"));'>{!$Label.MAActionFramework_Add_to_Trip}</button>
                </td>
                <td class='linkedin-companyactions' style='display: none;'>
                    <button class='linkedin-actions-createaccount' onclick='linkedIn_CreateAccount($(this).closest(".linkedin-row"));'>{!$Label.MA_Create_Account}</button>
                    <button class='linkedin-actions-addtotrip' onclick='linkedIn_AddToTrip($(this).closest(".linkedin-row"));'>{!$Label.MAActionFramework_Add_to_Trip}</button>
                </td>
            </tr>
        </table>

        <!-- LinkedIn Filter Template -->
        <div class='linkedin-filter'>
            <select>
                <option value='keywords'>{!$Label.MA_Keywords}</option>
                <option value='first-name'>{!$Label.MA_First_Name}</option>
                <option value='last-name'>{!$Label.MA_Last_Name}</option>
                <option value='company-name'>{!$Label.MA_Company_Name}</option>
                <option value='title'>{!$Label.MA_Title}</option>
                <option value='school-name'>{!$Label.MA_School_Name}</option>
            </select>
            <input type='text' />
        </div>

        <!-- Waypoint Tooltip -->
        <div id='waypoint-content-template'>
            <h2 class='name'></h2>
            <div class='address' style="margin-bottom: 20px"></div>
            <div class='notes'></div>
            <div class='footer'>
                ***{!$Label.MA_MANUALLY_ENTER_WAYPOINT_MESSAGE}.
                <div class="layout-tooltip">
                    <div class="buttonset-section-columns">
                        <div class="buttoncolumn">
                            <div class="actionbutton" data-action="Take Me There" data-type="Standard Action">{!$Label.MAActionFramework_Take_Me_There}</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Standard Cluster Template -->
        <div class='standard-cluster-tooltip'>

            <!-- Header -->
            <b><div class='standard-cluster-header' style='border-bottom: 1px solid rgb(141, 141, 141); font-size: 105%;'></div></b>
            <div class='cluster-listview-button'></div>

            <!-- Buttons -->
            <div class='standard-cluster-buttons-wrapper'>
                <table class='standard-cluster-buttons-table'>
                    <tr>
                        <td><button>{!$Label.MA_Zoom_To_Markers}</button></td>
                        <td class="drawpolygon"><button>{!$Label.MA_Draw_Polygon}</button></td>
                    </tr>
                </table>
            </div>

            <!-- Content -->
            <div class='standard-cluster-content-wrapper' style='min-height: 10px; overflow-y: auto; min-width: 400px; max-width: 700px; padding: 10px 0px 10px 5px;'>

            </div>

        </div>





        <!-- Cluster Row Template -->
        <table>
            <tr class='cluster-row'>
                <td class='cluster-info'>
                    <div class='cluster-id'>::Id::</div>
                </td>
            </tr>
        </table>

        <!-- Marker Search Results Row Template -->
        <div class='search-row results template'>
            <div class='image-replace'></div>
            <div class='search-text'>::result::</div>
        </div>

        <!-- Button Set Section Template -->
        <div class='buttonset-section'>
            <div class='buttonset-section-header'></div>
            <div class='buttonset-section-columns'>
                <div class='buttoncolumn'></div>
                <div class='buttoncolumn'></div>
                <div class='buttoncolumn'></div>
            </div>
        </div>

        <!-- Routes Sidebar Template -->
        <div class="routes-row template" style='position: relative; cursor:pointer; padding: 5px; border-bottom: 1px solid silver;'>
        	<div class="routes-day" style="font-size:11px; padding: 8px 0 0 0; float: left; height: 25px; width: 25px; font-weight: bold; margin-left: 8px; position: relative; top: 7px; background:url('{!URLFOR($Resource.MapAnything, '/images/ui-icons/calenderb.png')}') no-repeat; background-size: 25px; text-align: center;"></div>
	    	<div class="routes-name" style="font-size:12px; padding: 0 30px 0 45px; font-weight: bold; color: #2265bb;"></div>
	    	<div class="deleteDiv" onclick="dontDisplay = true; deleteRouteConfirm(this); return false;">X</div>
	    	<div class="routes-start" style="font-size:11px; padding: 0 30px 0 45px;"></div>
	    	<div class="routes-end" style="font-size:11px; padding: 0 30px 0 45px;"></div>
	    	<div class="routes-total" style="font-size:11px; padding: 0 30px 0 45px;"></div>
    	</div>

        <!--ArcGIS TooltipTemplates-->
        <div class="tooltipTemplate">
            <div class="slds-scope slds-info-window-wrapper" id="tooltip-content">
            	<div class="tooltip-wrap">
            		<div class="tooltip-header">
            			<!--<h5 class="infowindow-header-layer-name">::ArcLayer::</h5>-->
            			<!--<h3 class="infowindow-header-record-name slds-truncate slds-text-heading--small"><a href="javascript:void(0);">::LayerName::</a></h3>-->
            			<h3 class="infowindow-header-record-name slds-truncate slds-text-heading--small">::LayerName::</h3>
            			<!--<p class="infowindow-header-record-address">
            				<span class="ma-icon ma-icon-checkin slds-icon slds-icon--x-small"></span> 5000 Westpark Drive #320, Charlotte, NC 28202
            			</p>-->
            		</div>
            		<div class="tooltip-tabs-nav-wrap">
            			<div class="slds-tabs--default">
            				<ul class="slds-tabs--default__nav slds-tabs--default__nav--small infowindow-master-tabs" role="tablist">
            					<li class="slds-tabs--default__item slds-active" onclick="toggleSLDSTab(this);ArcGISOnline.runInfoWindowAdjust();" title="Details" role="presentation" data-tab="infowindowMasterTabContentDetails">
            						<a class="slds-tabs--default__link" href="javascript:void(0);" role="tab" tabindex="0" aria-selected="true" aria-controls="tab-scoped-1" id="maForArcGISInfoWindowDetail_Item">Details</a>
            					</li>
            					<li class="slds-tabs--default__item" onclick="toggleSLDSTab(this);ArcGISOnline.runInfoWindowAdjust();" title="Actions" role="presentation" data-tab="infowindowMasterTabContentActions">
            						<a class="slds-tabs--default__link" href="javascript:void(0);" role="tab" tabindex="-1" aria-selected="true" aria-controls="tab-scoped-2" id="maForArcGISInfoWindowAction_Item">Actions</a>
            					</li>
            				</ul>
            				<div id="infowindowMasterTabContentDetails" class="slds-tabs--default__content slds-show" role="tabpanel">
            					<div class="tooltip-body padded">
            						<table class="tooltip-table">
            							<tbody class="tooltip-bodyrows">
            								<!--<tr class="tooltip-row template">
            									<td><span class="tooltip-label">/::fieldInfoLabel::/</span></td>
            									<td>::fieldInfoFieldName::</td>
            								</tr>-->
            							</tbody>
            						</table>
            					</div>
            				</div>
            				<div id="infowindowMasterTabContentActions" class="slds-tabs--default__content slds-hide old-infowindow-actions-wrap" role="tabpanel"></div>
                    	</div>
                    </div>
                </div>
            </div>
        </div>
        <!--ArcGISOnline tooltip row template-->
        <table >
        <tr class="tooltip-rowTemplate">
			<td><span class="tooltip-label">::fieldInfoLabel::</span></td>
			<td class="tooltip-fieldName">::fieldInfoFieldName::</td>
		</tr>
        </table>


    	<!-- SVG Mag Glass -->
    	<svg style='display:none;' class='svg-mag-glass queryIcon' width="20" height="20" xmlns="http://www.w3.org/2000/svg">
			<g>
				<circle fill="__FILL_COLOR__" stroke="#f15a24" stroke-width="2.5" cx="11.17271" cy="8.81356" r="7.5" id="svg_mag1"/>
				<line fill="none" stroke="#f15a24" x1="-0.07837" y1="16.56372" x2="7.05023" y2="16.56372" id="svg_mag2" stroke-width="2.5" transform="rotate(135 3.485933780670165,16.563722610473633) "/>
			</g>
		</svg>

		<svg class='svg-circle-num' width="20" height="20" xmlns="http://www.w3.org/2000/svg">
			<g>
				<circle fill="#28a2ff" stroke="#f9f9f9" stroke-width="2" cx="10" cy="10" r="8.83163" id="svg_1"/>
				<text fill="#f9f9f9" stroke="#f9f9f9" stroke-width="0" x="8.3" y="10" id="svg_2" font-size="18" font-family="Monospace" text-anchor="middle" xml:space="preserve" transform="matrix(0.7992677323256553,0,0,0.6748139102469572,3.3995968056728256,7.2131973728906305) ">__TEXT__</text>
			</g>
		</svg>

		<!-- SVG Scatter - Circle -->
		<svg width="15" height="15" viewBox="0 0 15 15" class='svg-scatter-circle' xmlns="http://www.w3.org/2000/svg">
            <g>
                <ellipse stroke="__CIRCLE_FILL__" ry="6.97256" rx="6.972671" id="svg_1" cy="7.497071" cx="7.512866" fill="__GRADIENT_ONE__"/>
            </g>
        </svg>

        <!-- SVG Marker -->
        <svg class='svg-marker' width="28" height="42" viewBox="0 0 28 42" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid meet">
            <metadata>Created by potrace 1.11, written by Peter Selinger 2001-2013</metadata>
            <g>
                <path transform="rotate(180 13.5708 20.8542)" fill="__GRADIENT_ONE__" d="m6.300003,37.5c-4.300003,-3.399994 -5.900002,-8.5 -4.300003,-13.699997c1.700005,-5.800003 11.100006,-23.100006 12,-22.100006c1.400009,1.5 10.800003,20.800003 11.5,23.5c1,3.800003 -1.099991,9.300003 -4.599991,12.300003c-4.100006,3.400009 -10.200012,3.400009 -14.600006,0z" stroke="__CIRCLE_STROKE__"/>
                <circle stroke="__CIRCLE_STROKE__" r="4.5" cy="14" cx="13.5" stroke-width="2" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" fill="__CIRCLE_FILL__"/>
            </g>
        </svg>

        <!-- SVG Marker - Circle -->
        <svg class='svg-marker-circle' width="28" height="28" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid meet">
            <g>
                <circle r="13" cy="14" cx="14" fill="__GRADIENT_ONE__" stroke="__CIRCLE_FILL__" stroke-width="1"/>
                <circle r="4.5" cy="14" cx="14" stroke-width="2" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" fill="__CIRCLE_FILL__" stroke="__CIRCLE_STROKE__"/>
            </g>
        </svg>

        <!-- SVG Marker - Triangle -->
        <svg class='svg-marker-triangle' width="28" height="28" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid meet">
            <g>
                <path d="M0 28 L14 0 L28 28 Z" fill="__GRADIENT_ONE__" stroke="__CIRCLE_FILL__" stroke-width="1"/>
                <circle r="4.5" cy="18" cx="14" stroke-width="2" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" fill="__CIRCLE_FILL__" stroke="__CIRCLE_STROKE__"/>
            </g>
        </svg>

        <!-- SVG Marker - Square -->
        <svg class='svg-marker-square' width="28" height="28" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid meet">
            <g>
                <path d="M0 0 L28 0 L28 28 L0 28 Z" fill="__GRADIENT_ONE__" stroke="__CIRCLE_FILL__" stroke-width="1"/>
                <circle r="4.5" cy="14" cx="14" stroke-width="2" stroke-linecap="null" stroke-linejoin="null" stroke-dasharray="null" fill="__CIRCLE_FILL__" stroke="__CIRCLE_STROKE__"/>
            </g>
        </svg>

        <!-- SVG Marker - Waypoint -->
        <svg class='svg-marker-waypoint' width="28" height="42" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid meet">
            <g>
                <title></title>
                <path stroke="#1d649b" d="m6.300003,37.5c-4.300003,-3.399994 -5.900002,-8.5 -4.300003,-13.699997c1.700005,-5.800003 11.100006,-23.100006 12,-22.100006c1.400009,1.5 10.800003,20.800003 11.5,23.5c1,3.800003 -1.099991,9.300003 -4.599991,12.300003c-4.100006,3.400009 -10.200012,3.400009 -14.600006,0z" fill="#4597d0" transform="rotate(180 13.5708 20.8542)"/>
                <text fill="#ffffff" stroke="#1d649b" stroke-width="0.2" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" x="13" y="19" id="svg_1" font-size="16" font-family="Monospace" text-anchor="middle" xml:space="preserve" font-weight="normal">__TEXT__</text>
            </g>
        </svg>

        <!-- SVG Marker - Favorite -->
        <svg class='svg-marker-favorite' width="28" height="42" xmlns="http://www.w3.org/2000/svg">
            <g>
                <path transform="rotate(180 13.5708 20.8542)" fill="__GRADIENT_ONE__" d="m6.300003,37.5c-4.300003,-3.399994 -5.900002,-8.5 -4.300003,-13.699997c1.700005,-5.800003 11.100006,-23.100006 12,-22.100006c1.400009,1.5 10.800003,20.800003 11.5,23.5c1,3.800003 -1.099991,9.300003 -4.599991,12.300003c-4.100006,3.400009 -10.200012,3.400009 -14.600006,0z" stroke="__CIRCLE_STROKE__"/>
                <path stroke="__CIRCLE_FILL__" fill="__CIRCLE_FILL__" stroke-width="5" d="m13.47797,15.01411l-0.28443,0.20129l0.10872,-0.32559l-0.28433,-0.20126l0.35149,0.00003l0.09341,-0.27995l0.01524,-0.04546l0.10853,0.32538l0.35161,0l-0.28449,0.20127l0.10874,0.32569l-0.28449,-0.20136l0,0l0,-0.00003l0,0l0,0.00001z"/>
            </g>
        </svg>

        <svg class="svg-data-layer" xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" viewBox="0 0 19 19" style="enable-background:new 0 0 19 19;" xml:space="preserve" width="19" height="19">
            <g>
                <ellipse fill="#72889E" class="st0" cx="9.5" cy="4.6" rx="6.5" ry="2.2"/>
                <path class="st0" d="M9.5,8.2C5.9,8.2,3,7.1,3,6.2v1.6c0,1.2,2.9,2.2,6.5,2.2s6.5-1,6.5-2.2V6.2C16,7.2,13.1,8.2,9.5,8.2z"/>
                <path class="st0" d="M9.5,11.5c-3.6,0-6.5-1.1-6.5-2v1.6c0,1.2,2.9,2.2,6.5,2.2s6.5-1,6.5-2.2V9.5C16,10.4,13.1,11.5,9.5,11.5z"/>
                <path class="st0" d="M9.5,14.8c-3.6,0-6.5-1.1-6.5-2v1.6c0,1.2,2.9,2.2,6.5,2.2s6.5-1,6.5-2.2v-1.6C16,13.7,13.1,14.8,9.5,14.8z"/>
            </g>
        </svg>

    </div>

    <!-- Dynamic Component Overrides -->
    <apex:repeat value="{!overrideComponentStrings}" var="c">
        <apex:outputText escape="false" value="{!c}" />
    </apex:repeat>

    <apex:outputPanel layout="none" rendered="{!TotangoEnabled == 'true'}">

          <script type='text/javascript'>
             $(window).load(function() {
                // executes when page  fully loads
                //try {  totango.track("Load Map Page", "MapAnything"); } catch(err) { }
                if('{!oldFolders}' == 'true') {
                    try {  totango.track("Load Map Page - New Folder", "MapAnything"); } catch(err) { }
                }
                else {
                    try {  totango.track("Load Map Page - Old Folder", "MapAnything"); } catch(err) { }
                }
            });

    $("#mapcontainer").scroll(function() {
            if ($(this).scrollTop()) {
                $('.listview-scrolltotop-button').stop(true, true).fadeIn();
            } else {
                $('.listview-scrolltotop-button').stop(true, true).fadeOut();
            }
        });
        $("#mapcontainer").scroll(function() {
            // subtract 192 because of the max-height set on #mapdiv when the listview is activated
            if($("#mapcontainer").scrollTop() + 192 == $("#mapcontainer").height()) {
                $('.listview-fullscreen-button').stop(true, true).fadeOut();
            }
            else {
                $('.listview-fullscreen-button').stop(true, true).fadeIn();
            }
        });




        </script>

    </apex:outputPanel>

    <script>

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-41062202-6']);
      _gaq.push(['_setDomainName', 'none']);
      _gaq.push(['_setAllowLinker', true]);
      _gaq.push(['_trackPageview']);

      _gaq.push(['_setCustomVar',1,'OrgId','{!$Organization.Id}',3]);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();



    </script>

</apex:page>