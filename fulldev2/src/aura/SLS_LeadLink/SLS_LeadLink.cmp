<!--2016-03-16- anirudh.singh@cdk.com- Created this lightning component for Request RQ-06471 NADA Leads Process - Work My Leads.-->
<aura:component implements="force:appHostable" controller="SLS_LeadLink_Controller">
    <ltng:require styles="/resource/slds100/assets/styles/salesforce-lightning-design-system.css"/>
    <ltng:require styles="/resource/FontAwesome/4.3.0/css/font-awesome.min.css"/>
    <ltng:require scripts="/resource/jQuery/js/jquery-1.10.2.min.js"/>
    
    <aura:attribute name="leadId" type="Id" default="00Q40000014fw4zEAA"/>
    <aura:attribute name="leadAndLeadMatchesRecord" type="SLS_LeadLink_Controller.LeadAndLeadMatchesWrapper"/>
    <aura:attribute name="errorMessageValue" type="String"/>
    <aura:attribute name="hardware" type="String" default="{!$Browser.formFactor}"/>
    
    <aura:handler name="init" value="{!this}" action="{!c.initialize}"/>
    
    <aura:registerEvent name="showLeads" type="c:SLS_showLeads"/>
    
    <!--Spinner-->
    <div>
        <div aura:id="spinnerLeadLink" class="slds-spinner_container noDisplay">
            <div class="slds-spinner--brand slds-spinner slds-spinner--large">
                <div class="slds-spinner__dot-a"></div>
                <div class="slds-spinner__dot-b"></div>
            </div>
        </div>
    </div>
    
    <!--Header-->
    <div class="slds-page-header" role="banner">
        <div class="slds-media">
            <div class="slds-media__figure">
                <img class="logoStyle" src="/resource/slds100/assets/icons/standard/lead_60.png"/>
            </div>
            <div class="slds-media__body">
                <p class="slds-page-header__title  slds-align-middle" title="{!v.leadAndLeadMatchesRecord.leadRecord.Name}">
                    <b><ui:outputText value="{!v.leadAndLeadMatchesRecord.leadRecord.Name}"/></b></p>
                <p class="slds-text-body--small slds-page-header__info">
                    <b><ui:outputText value="Lead"/></b>
                </p>
            </div>
        </div>
    </div>
    
    <!--Error Message Block-->
    <div>
        <div aura:id="errorOuterDiv" class="noDisplay">
            <div aura:id="errorDiv" role="dialog" class="errorPosition slds-modal slds-modal--prompt slds-fade-in-open">
                <div class="slds-modal__container slds-modal--prompt">
                    <div class="slds-modal__header slds-theme--error slds-theme--alert-texture">
                        <h2 class="slds-text-heading--medium">Error</h2>
                    </div>
                    <div class="slds-modal__content slds-p-around--medium">
                        <p><div class="errorMessageAlignment" aura:id="errorMessage"></div></p>
                    </div>
                    <div class="slds-modal__footer slds-theme--default">
                        <button class="slds-button slds-button--brand" onclick="{!c.hideError}">Ok</button>
                    </div>
                </div>
            </div>
            <div aura:id="backgroundDiv" class="slds-backdrop slds-backdrop--open"></div>
        </div>
    </div>
    
    <!--Lead Details-->
    <table class="{!'slds-table slds-table--bordered slds-max-medium-table--stacked-horizontal slds-no-row-hover'+' '+(v.hardware == 'DESKTOP' ? '' : 'slds-table--fixed-layout slds-scrollable--x')}">
        <tr class="slds-hint-parent tableRow">
            <th class="{!v.hardware != 'DESKTOP' ? 'noDisplay' : 'slds-text-heading--label'}">Lead Record Type</th>
            <td class="slds-truncate" title="{!v.leadAndLeadMatchesRecord.leadRecord.RecordType.Name}" data-label="Lead Record Type">
                <ui:outputText value="{!v.leadAndLeadMatchesRecord.leadRecord.RecordType.Name}"/>
            </td>
            <th class="{!v.hardware != 'DESKTOP' ? 'noDisplay' : 'slds-text-heading--label'}">Lead Status</th>
            <td class="slds-truncate" title="{!v.leadAndLeadMatchesRecord.leadRecord.Status}" data-label="Lead Status">
                <ui:outputText value="{!v.leadAndLeadMatchesRecord.leadRecord.Status}"/>
            </td>
        </tr>
        
        <tr class="slds-hint-parent tableRow">
            <th class="{!v.hardware != 'DESKTOP' ? 'noDisplay' : 'slds-text-heading--label'}">Lead Owner</th>
            <td class="slds-truncate" title="{!v.leadAndLeadMatchesRecord.leadRecord.Owner.Name}" data-label="Lead Owner">
                <ui:outputURL class="{!v.hardware != 'DESKTOP' ? 'noDisplay' : ''}" label="{!v.leadAndLeadMatchesRecord.leadRecord.Owner.Name}" value="{!'/' + v.leadAndLeadMatchesRecord.leadRecord.Owner.Id}"/>
                <a id="{!v.leadAndLeadMatchesRecord.leadRecord.Owner.Id}" onclick="{!c.openRecordDetail}" class="{!v.hardware == 'DESKTOP' ? 'noDisplay' : ''}">{!v.leadAndLeadMatchesRecord.leadRecord.Owner.Name}</a>
            </td>
            <th class="{!v.hardware != 'DESKTOP' ? 'noDisplay' : 'slds-text-heading--label'}">Reason</th>
            <td class="slds-truncate" title="{!v.leadAndLeadMatchesRecord.leadRecord.Reason__c}" data-label="Reason">
                <ui:outputText value="{!v.leadAndLeadMatchesRecord.leadRecord.Reason__c}"/>
            </td>
        </tr>
        
        <tr class="slds-hint-parent tableRow">
            <th class="{!v.hardware != 'DESKTOP' ? 'noDisplay' : 'slds-text-heading--label'}">Name</th>
            <td class="slds-truncate" title="{!v.leadAndLeadMatchesRecord.leadRecord.Name}" data-label="Name">
                <ui:outputURL class="{!v.hardware != 'DESKTOP' ? 'noDisplay' : ''}" label="{!v.leadAndLeadMatchesRecord.leadRecord.Name}" value="{!'/' + v.leadAndLeadMatchesRecord.leadRecord.Id}"/>
                <a id="{!v.leadAndLeadMatchesRecord.leadRecord.Id}" onclick="{!c.openRecordDetail}" href="{!'/' + v.leadAndLeadMatchesRecord.leadRecord.Id}" class="{!v.hardware == 'DESKTOP' ? 'noDisplay' : ''}">{!v.leadAndLeadMatchesRecord.leadRecord.Name}</a>
            </td>
            <th class="{!v.hardware != 'DESKTOP' ? 'noDisplay' : 'slds-text-heading--label'}">Lead Type</th>
            <td class="slds-truncate" title="{!v.leadAndLeadMatchesRecord.leadRecord.Lead_Type__c}" data-label="Lead Type">
                <ui:outputText value="{!v.leadAndLeadMatchesRecord.leadRecord.Lead_Type__c}"/>
            </td>
        </tr>
        
        <tr class="slds-hint-parent tableRow">
            <th class="{!v.hardware != 'DESKTOP' ? 'noDisplay' : 'slds-text-heading--label'}">Role</th>
            <td class="slds-truncate" title="{!v.leadAndLeadMatchesRecord.leadRecord.Title}" data-label="Role">
                <ui:outputText value="{!v.leadAndLeadMatchesRecord.leadRecord.Title}"/>
            </td>
            <th class="{!v.hardware != 'DESKTOP' ? 'noDisplay' : 'slds-text-heading--label'}">Campaign</th>
            <td class="slds-truncate" title="{!v.leadAndLeadMatchesRecord.leadRecord.ADP_Campaign__c}" data-label="Campaign">
                <ui:outputURL class="{!v.hardware != 'DESKTOP' ? 'noDisplay' : ''}" label="{!v.leadAndLeadMatchesRecord.leadRecord.ADP_Campaign__r.Name}" value="{!'/' + v.leadAndLeadMatchesRecord.leadRecord.ADP_Campaign__c}"/>
                <a id="{!v.leadAndLeadMatchesRecord.leadRecord.ADP_Campaign__c}" onclick="{!c.openRecordDetail}" class="{!v.hardware == 'DESKTOP' ? 'noDisplay' : ''}">{!v.leadAndLeadMatchesRecord.leadRecord.ADP_Campaign__r.Name}</a>
            </td>
        </tr>
        
        <tr class="slds-hint-parent tableRow">
            <th class="{!v.hardware != 'DESKTOP' ? 'noDisplay' : 'slds-text-heading--label'}">Company</th>
            <td class="slds-truncate" title="{!v.leadAndLeadMatchesRecord.leadRecord.Company}" data-label="Company">
                <ui:outputText value="{!v.leadAndLeadMatchesRecord.leadRecord.Company}"/>
            </td>
            <th class="{!v.hardware != 'DESKTOP' ? 'noDisplay' : 'slds-text-heading--label'}">Lead Source</th>
            <td class="slds-truncate" title="{!v.leadAndLeadMatchesRecord.leadRecord.LeadSource}" data-label="Lead Source">
                <ui:outputText value="{!v.leadAndLeadMatchesRecord.leadRecord.LeadSource}"/>
            </td>
        </tr>
        
        <tr class="slds-hint-parent tableRow">
            <th class="{!v.hardware != 'DESKTOP' ? 'noDisplay' : 'slds-text-heading--label'}">Email</th>
            <td class="slds-truncate" title="{!v.leadAndLeadMatchesRecord.leadRecord.Email}" data-label="Email">
                <ui:outputEmail value="{!v.leadAndLeadMatchesRecord.leadRecord.Email}"/>
            </td>
            <th class="{!v.hardware != 'DESKTOP' ? 'noDisplay' : 'slds-text-heading--label'}">Phone</th>
            <td class="slds-truncate" title="{!v.leadAndLeadMatchesRecord.leadRecord.Phone}" data-label="Phone">
                <ui:outputPhone value="{!v.leadAndLeadMatchesRecord.leadRecord.Phone}"/>
            </td>
        </tr>
        
        <tr class="slds-hint-parent tableRow">
            <td colspan="4">
                <center>
                    <button class="slds-button slds-button--brand slds-not-selected" type="button" onclick="{!c.redirectToLeadList}">Back to Work my Leads</button>
                </center>
            </td>
        </tr>
    </table>
    
    <!--Custom Match-->
    <div>
        <div class="slds-card">
            <div class="slds-card__header slds-grid">
                <div class="slds-media slds-media--center slds-has-flexi-truncate">
                    <div class="slds-media__body">
                        <div class="slds-truncate">
                            <span class="slds-form-element__static slds-section__title">
                                <b><ui:outputText value="Custom Match"/></b>
                            </span>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="slds-grid slds-wrap slds-grid--pull-padded slds-col--bump-right slds-col--bump-left customMatchGridFields">
                <div class="slds-col slds-size--1-of-1 slds-medium-size--1-of-4 slds-large-size--1-of-4">
                    <div class="slds-text-heading--label customMatchColPadding customMatchHeading">Lookup Account</div>
                </div>
                <div class="slds-col slds-size--1-of-1 slds-medium-size--1-of-4 slds-large-size--1-of-4">
                    <div class="customMatchColPadding">
                        <c:ALL_LookUp objectAPIName="Account" selectedId="{!v.leadAndLeadMatchesRecord.leadRecord.Current_Account__c}" label=""/>
                    </div>
                    <div class="customMatchButtonPadding">
                        <button class="slds-button slds-button--brand slds-not-selected" type="button" onclick="{!c.matchSelectedAccount}">Match Selected Account</button>
                    </div>
                </div>
                
                <div class="slds-col slds-size--1-of-1 slds-medium-size--1-of-4 slds-large-size--1-of-4">
                    <div class="slds-text-heading--label customMatchColPadding customMatchHeading">Lookup Contact</div>
                </div>
                <div class="slds-col slds-size--1-of-1 slds-medium-size--1-of-4 slds-large-size--1-of-4">
                    <div class="customMatchColPadding">
                        <c:ALL_LookUp objectAPIName="Contact" selectedId="{!v.leadAndLeadMatchesRecord.leadRecord.Contact__c}" label=""/>
                    </div>
                    <div class="customMatchButtonPadding">
                        <button class="slds-button slds-button--brand slds-not-selected" type="button" onclick="{!c.matchSelectedContact}">Match Selected Contact</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!--Matching Contacts-->
    <div>
        <div class="slds-card">
            <div class="slds-card__header slds-grid">
                <div class="slds-media slds-media--center slds-has-flexi-truncate">
                    <div class="slds-media__body">
                        <div class="slds-truncate">
                            <span class="slds-form-element__static slds-section__title">
                                <b><ui:outputText value="{!'Matching Contacts ('+v.leadAndLeadMatchesRecord.leadMatchesList.length+')'}"/></b>
                            </span>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="slds-card__body">
                <table class="{!'slds-table slds-table--bordered slds-max-medium-table--stacked-horizontal slds-no-row-hover'+' '+(v.hardware == 'DESKTOP' ? '' : 'slds-table--fixed-layout slds-scrollable--x')}">
                    <thead>
                        <tr>
                            <th class="slds-text-heading--label"><ui:outputText value="Action"/></th>
                            <th class="slds-text-heading--label"><ui:outputText value="First Name"/></th>
                            <th class="slds-text-heading--label"><ui:outputText value="Last Name"/></th>
                            <th class="slds-text-heading--label"><ui:outputText value="Account Name"/></th>
                            <th class="slds-text-heading--label"><ui:outputText value="Account Address"/></th>
                            <th class="slds-text-heading--label"><ui:outputText value="Account City"/></th>
                            <th class="slds-text-heading--label"><ui:outputText value="Account State"/></th>
                            <th class="slds-text-heading--label"><ui:outputText value="Phone"/></th>
                            <th class="slds-text-heading--label"><ui:outputText value="Email"/></th>
                            <th class="slds-text-heading--label"><ui:outputText value="Site Type"/></th>
                        </tr>
                    </thead>
                    <tbody>
                        <aura:iteration items="{!v.leadAndLeadMatchesRecord.leadMatchesList}" var="leadMatch">
                            <tr>
                                <td class="" data-label="Action">
                                    <label>
                                        <a id="{!leadMatch.Id}" onclick="{!c.linkAndRedirect}">Select</a>
                                        <span class="slds-assistive-text">Action</span>
                                    </label>
                                </td>
                                <td class="slds-truncate" data-label="First Name" title="{!leadMatch.Contact__r.FirstName}">
                                    <ui:outputText value="{!leadMatch.Contact__r.FirstName}"/>
                                </td>
                                <td class="slds-truncate" data-label="Last Name" title="{!leadMatch.Contact__r.LastName}">
                                    <ui:outputText value="{!leadMatch.Contact__r.LastName}"/>
                                </td>
                                <td class="slds-truncate" data-label="Account Name" title="{!leadMatch.Contact__r.Account.Name}">
                                    <ui:outputURL class="{!v.hardware != 'DESKTOP' ? 'noDisplay' : ''}" label="{!leadMatch.Contact__r.Account.Name}" value="{!'/' + leadMatch.Contact__r.AccountId}"/>
                                    <a id="{!leadMatch.Contact__r.AccountId}" onclick="{!c.openRecordDetail}" class="{!v.hardware == 'DESKTOP' ? 'noDisplay' : ''}">{!leadMatch.Contact__r.Account.Name}</a>
                                </td>
                                <td class="slds-truncate" data-label="Account Address" title="{!leadMatch.Contact__r.BillingStreet}">
                                    <ui:outputText value="{!leadMatch.Contact__r.BillingStreet}"/>
                                </td>
                                <td class="slds-truncate" data-label="Account City" title="{!leadMatch.Contact__r.BillingCity}">
                                    <ui:outputText value="{!leadMatch.Contact__r.BillingCity}"/>
                                </td>
                                <td class="slds-truncate" data-label="Account State" title="{!leadMatch.Contact__r.BillingState}">
                                    <ui:outputText value="{!leadMatch.Contact__r.BillingState}"/>
                                </td>
                                <td class="slds-truncate" data-label="Phone" title="{!leadMatch.Contact__r.Phone}">
                                    <ui:outputPhone value="{!leadMatch.Contact__r.Phone}"/>
                                </td>
                                <td class="slds-truncate" data-label="Email" title="{!leadMatch.Contact__r.Email}">
                                    <ui:outputEmail value="{!leadMatch.Contact__r.Email}"/>
                                </td>
                                <td class="slds-truncate" data-label="Site Type" title="{!leadMatch.Contact__r.Account.Site_Type__r.Name}">{!leadMatch.Contact__r.Account.Site_Type__r.Name}</td>
                            </tr>
                        </aura:iteration>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</aura:component>